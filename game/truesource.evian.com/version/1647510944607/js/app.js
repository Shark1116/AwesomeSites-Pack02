!function(t){function e(e){for(var r,o,s=e[0],l=e[1],u=e[2],f=0,h=[];f<s.length;f++)o=s[f],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&h.push(i[o][0]),i[o]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(t[r]=l[r]);for(c&&c(e);h.length;)h.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],r=!0,s=1;s<n.length;s++){var l=n[s];0!==i[l]&&(r=!1)}r&&(a.splice(e--,1),t=o(o.s=n[0]))}return t}var r={},i={app:0},a=[];function o(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.e=function(t){var e=[],n=i[t];if(0!==n)if(n)e.push(n[2]);else{var r=new Promise((function(e,r){n=i[t]=[e,r]}));e.push(n[2]=r);var a,s=document.createElement("script");s.charset="utf-8",s.timeout=120,o.nc&&s.setAttribute("nonce",o.nc),s.src=function(t){return o.p+"version/1647510944607/js/"+t+".js"}(t);var l=new Error;a=function(e){s.onerror=s.onload=null,clearTimeout(u);var n=i[t];if(0!==n){if(n){var r=e&&("load"===e.type?"missing":e.type),a=e&&e.target&&e.target.src;l.message="Loading chunk "+t+" failed.\n("+r+": "+a+")",l.name="ChunkLoadError",l.type=r,l.request=a,n[1](l)}i[t]=void 0}};var u=setTimeout((function(){a({type:"timeout",target:s})}),12e4);s.onerror=s.onload=a,document.head.appendChild(s)}return Promise.all(e)},o.m=t,o.c=r,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/",o.oe=function(t){throw console.error(t),t};var s=this.webpackJsonp=this.webpackJsonp||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var u=0;u<s.length;u++)e(s[u]);var c=l;a.push([414,"vendors"]),n()}({151:function(t,e,n){t.exports={icon:"icon-1RPHevu"}},153:function(t,e,n){t.exports={"image-element":"image-element-2sXxYEf",imageElement:"image-element-2sXxYEf",contain:"contain-3QQXz31"}},154:function(t,e,n){t.exports={"start-screen-logo":"start-screen-logo-3CfsFwC",startScreenLogo:"start-screen-logo-3CfsFwC","image-wrapper":"image-wrapper-2iDRxLz",imageWrapper:"image-wrapper-2iDRxLz"}},155:function(t,e,n){t.exports={"start-screen-title":"start-screen-title-3CimvcX",startScreenTitle:"start-screen-title-3CimvcX"}},156:function(t,e,n){t.exports={"primary-button":"primary-button-27aaHVh",primaryButton:"primary-button-27aaHVh",background:"background-99C2jWc",label:"label-3tDTER8",secondary:"secondary-2sp7rFO"}},157:function(t,e,n){t.exports={"start-screen":"start-screen-3z8M7qN",startScreen:"start-screen-3z8M7qN",logo:"logo-2MgqIHr",title:"title-uXxfWlz","sub-title":"sub-title-1zVCv7r",subTitle:"sub-title-1zVCv7r","cta-wrapper":"cta-wrapper-1d7KLSF",ctaWrapper:"cta-wrapper-1d7KLSF",cta:"cta-2qRLjAX","overlay-background":"overlay-background-3awJVm9",overlayBackground:"overlay-background-3awJVm9","overlay-gradient":"overlay-gradient-919ShHh",overlayGradient:"overlay-gradient-919ShHh"}},158:function(t,e,n){t.exports={"onboarding-carousel-card":"onboarding-carousel-card-Cob0z-m",onboardingCarouselCard:"onboarding-carousel-card-Cob0z-m",title:"title-2A6KoNE",copy:"copy-1dLmmOb","images-wrapper":"images-wrapper-1ffl8xU",imagesWrapper:"images-wrapper-1ffl8xU","image-background-wrapper":"image-background-wrapper-2YlPBGm",imageBackgroundWrapper:"image-background-wrapper-2YlPBGm","blue-glow":"blue-glow-2To9VDf",blueGlow:"blue-glow-2To9VDf","red-glow":"red-glow-30QqdBm",redGlow:"red-glow-30QqdBm",image:"image-Ld9RX5N","width-01":"width-01-1nnCvJm",width01:"width-01-1nnCvJm","width-02":"width-02-umUJT3h",width02:"width-02-umUJT3h","width-03":"width-03-nv2qY4h",width03:"width-03-nv2qY4h","width-04":"width-04-yMjm2cC",width04:"width-04-yMjm2cC","width-05":"width-05-3ScLxwD",width05:"width-05-3ScLxwD","width-06":"width-06-3Er2RBI",width06:"width-06-3Er2RBI","width-07":"width-07-2CoOG4W",width07:"width-07-2CoOG4W","width-08":"width-08-2mF1vpn",width08:"width-08-2mF1vpn","has-smaller-margin":"has-smaller-margin-3jCPUel",hasSmallerMargin:"has-smaller-margin-3jCPUel","is-svg":"is-svg-3tDS-h2",isSvg:"is-svg-3tDS-h2","is-rotated":"is-rotated-2SMayoa",isRotated:"is-rotated-2SMayoa",svg:"svg-2DUsk6b",eyebrow:"eyebrow-3SiJp0a"}},159:function(t,e,n){t.exports={"onboarding-carousel":"onboarding-carousel-dC6sePS",onboardingCarousel:"onboarding-carousel-dC6sePS"}},160:function(t,e,n){t.exports={"onboarding-carousel-pagination":"onboarding-carousel-pagination-3EWdDVE",onboardingCarouselPagination:"onboarding-carousel-pagination-3EWdDVE","pagination-button":"pagination-button-1wQEDtY",paginationButton:"pagination-button-1wQEDtY","pagination-dot":"pagination-dot-1H7CHUu",paginationDot:"pagination-dot-1H7CHUu","is-active":"is-active-1tUBzWY",isActive:"is-active-1tUBzWY"}},161:function(t,e,n){t.exports={"onboarding-screen":"onboarding-screen-3MtSdzV",onboardingScreen:"onboarding-screen-3MtSdzV",logo:"logo-2bBNtZu",spacer:"spacer-osUJnEb","carousel-container":"carousel-container-2_2IrQI",carouselContainer:"carousel-container-2_2IrQI","carousel-wrapper-two":"carousel-wrapper-two-_YDsvXz",carouselWrapperTwo:"carousel-wrapper-two-_YDsvXz","carousel-wrapper-one":"carousel-wrapper-one-184pgzw",carouselWrapperOne:"carousel-wrapper-one-184pgzw",background:"background-2n4fVUm","cta-wrapper":"cta-wrapper-2Pz19Yn",ctaWrapper:"cta-wrapper-2Pz19Yn",cta:"cta-2oidPH4","spacer-two":"spacer-two-1gEpfy2",spacerTwo:"spacer-two-1gEpfy2"}},162:function(t,e,n){t.exports={"end-run-button-wrapper":"end-run-button-wrapper-S0ep5pa",endRunButtonWrapper:"end-run-button-wrapper-S0ep5pa","end-run-button":"end-run-button-ti--GGF",endRunButton:"end-run-button-ti--GGF",background:"background-1Qo_zJX","center-point":"center-point-1VS42_R",centerPoint:"center-point-1VS42_R",label:"label-3_tZEt2"}},163:function(t,e,n){t.exports={"message-overlay":"message-overlay-2lpxDq1",messageOverlay:"message-overlay-2lpxDq1"}},164:function(t,e,n){t.exports={"scoreboard-overlay":"scoreboard-overlay-1ZtxHo3",scoreboardOverlay:"scoreboard-overlay-1ZtxHo3",label:"label-N68Ym_z","score-to-beat-wrapper":"score-to-beat-wrapper-3YpOZGM",scoreToBeatWrapper:"score-to-beat-wrapper-3YpOZGM","message-wrapper":"message-wrapper-2mQhMjM",messageWrapper:"message-wrapper-2mQhMjM",message:"message-2B1MiV5","score-to-beat":"score-to-beat-4eyL5AO",scoreToBeat:"score-to-beat-4eyL5AO"}},165:function(t,e,n){t.exports={"score-alert":"score-alert-JhMCDpy",scoreAlert:"score-alert-JhMCDpy"}},166:function(t,e,n){t.exports={"game-screen":"game-screen-TAUCuNs",gameScreen:"game-screen-TAUCuNs","overlays-wrapper":"overlays-wrapper-2_6rp95",overlaysWrapper:"overlays-wrapper-2_6rp95","end-run-cta":"end-run-cta-PhZqctC",endRunCta:"end-run-cta-PhZqctC","message-overlay-wrapper":"message-overlay-wrapper-2dGn1zy",messageOverlayWrapper:"message-overlay-wrapper-2dGn1zy","scoreboard-overlay":"scoreboard-overlay-22M19eC",scoreboardOverlay:"scoreboard-overlay-22M19eC","score-alert":"score-alert-3wRjw0p",scoreAlert:"score-alert-3wRjw0p","overlay-gradient":"overlay-gradient-1pjtXTQ",overlayGradient:"overlay-gradient-1pjtXTQ","overlay-radial-gradient":"overlay-radial-gradient-3WRNywp",overlayRadialGradient:"overlay-radial-gradient-3WRNywp"}},167:function(t,e,n){t.exports={"play-again-button":"play-again-button-3eOjUmc",playAgainButton:"play-again-button-3eOjUmc",icon:"icon-22WLqyP",label:"label-5-x4vxP"}},168:function(t,e,n){t.exports={"copy-to-clipboard-button":"copy-to-clipboard-button-34wjtHA",copyToClipboardButton:"copy-to-clipboard-button-34wjtHA",background:"background-2jUnXAd","primary-label-wrapper":"primary-label-wrapper-P4njQdd",primaryLabelWrapper:"primary-label-wrapper-P4njQdd",label:"label-GzqylgU",spacer:"spacer-2WmgjVr",icon:"icon-1Mu1uWQ","confirmation-label":"confirmation-label-1e0nrau",confirmationLabel:"confirmation-label-1e0nrau"}},169:function(t,e,n){t.exports={"results-screen":"results-screen-1r89Aeb",resultsScreen:"results-screen-1r89Aeb",logo:"logo-2N7RVK-",spacer:"spacer-22MeTAE","result-board-container":"result-board-container-3p5QrRG",resultBoardContainer:"result-board-container-3p5QrRG","result-board-wrapper":"result-board-wrapper-T8JcF1v",resultBoardWrapper:"result-board-wrapper-T8JcF1v","result-board":"result-board-3e6BDEh",resultBoard:"result-board-3e6BDEh",background:"background-3JDgonj","background-cover":"background-cover-5Q0AvY3",backgroundCover:"background-cover-5Q0AvY3",content:"content-3vDk2pe",title:"title-1KuPfJV","score-title":"score-title-3n1xJMp",scoreTitle:"score-title-3n1xJMp",copy:"copy-25O3x_t","cta-one":"cta-one-2DuaDL3",ctaOne:"cta-one-2DuaDL3","cta-two":"cta-two-TcfB4gs",ctaTwo:"cta-two-TcfB4gs","share-cta":"share-cta-Kp_iH22",shareCta:"share-cta-Kp_iH22","cta-wrapper":"cta-wrapper-3hITgRr",ctaWrapper:"cta-wrapper-3hITgRr",cta:"cta-1XbCmUM"}},170:function(t,e,n){t.exports={"milestone-screen":"milestone-screen-3v-LcB-",milestoneScreen:"milestone-screen-3v-LcB-","milestone-board-container":"milestone-board-container-vFr8UPs",milestoneBoardContainer:"milestone-board-container-vFr8UPs",spacer:"spacer-3vxN2mB","milestone-board":"milestone-board-1RsZe12",milestoneBoard:"milestone-board-1RsZe12","has-no-image":"has-no-image-1uMlcKw",hasNoImage:"has-no-image-1uMlcKw","background-wrapper":"background-wrapper-2YAzZvA",backgroundWrapper:"background-wrapper-2YAzZvA",content:"content-1K1sjCF","counter-wrapper":"counter-wrapper-2cC8bqo",counterWrapper:"counter-wrapper-2cC8bqo",icon:"icon-2S6cJV1","count-number":"count-number-3-FolXE",countNumber:"count-number-3-FolXE",title:"title-moFyEbb","sub-title":"sub-title-3KbubI3",subTitle:"sub-title-3KbubI3",copy:"copy-2p66moe","has-extra-top-margin":"has-extra-top-margin-1oqFayo",hasExtraTopMargin:"has-extra-top-margin-1oqFayo"}},171:function(t,e,n){t.exports={"sound-cta":"sound-cta-2ZpfLvm",soundCta:"sound-cta-2ZpfLvm","icon-wrapper":"icon-wrapper-3UyaMbk",iconWrapper:"icon-wrapper-3UyaMbk",label:"label-1ZrLCnA"}},172:function(t,e,n){t.exports={"intro-screen":"intro-screen-3BTFAez",introScreen:"intro-screen-3BTFAez",logo:"logo-3YVhFic",title:"title-2JT2EPT","sub-title":"sub-title-3Jhs3to",subTitle:"sub-title-3Jhs3to","cta-wrapper":"cta-wrapper-28bN_2y",ctaWrapper:"cta-wrapper-28bN_2y",cta:"cta-2NzvHZD","sound-cta-wrapper":"sound-cta-wrapper-2pty1gD",soundCtaWrapper:"sound-cta-wrapper-2pty1gD"}},173:function(t,e,n){t.exports={"home-page":"home-page-7_P_AJC",homePage:"home-page-7_P_AJC"}},174:function(t,e,n){},175:function(t,e,n){t.exports={"back-button":"back-button-220Iyct",backButton:"back-button-220Iyct",icon:"icon-UbJx2kd",label:"label-2AtZhZh"}},176:function(t,e,n){t.exports={"main-intro":"main-intro-2LARbmN",mainIntro:"main-intro-2LARbmN",navigation:"navigation-JKrLBC5","cta-back":"cta-back-eT5CuRO",ctaBack:"cta-back-eT5CuRO",logo:"logo-1L-hN4l"}},177:function(t,e,n){t.exports={"contest-form":"contest-form-2oR7UDi",contestForm:"contest-form-2oR7UDi",label:"label-2-BCZqG","label-text":"label-text-35ZVEWr",labelText:"label-text-35ZVEWr","sub-label-text":"sub-label-text-XU9-CGl",subLabelText:"sub-label-text-XU9-CGl","input-field":"input-field-H4DLoE5",inputField:"input-field-H4DLoE5","label-checkbox":"label-checkbox-1meJGLq",labelCheckbox:"label-checkbox-1meJGLq","label-checkbox-text":"label-checkbox-text-15zQabc",labelCheckboxText:"label-checkbox-text-15zQabc","label-wrapper":"label-wrapper-2tdHhea",labelWrapper:"label-wrapper-2tdHhea","has-error":"has-error-9HAcaMB",hasError:"has-error-9HAcaMB","input-error":"input-error-2Z_cYTw",inputError:"input-error-2Z_cYTw",submit:"submit-104cq1T"}},178:function(t,e,n){t.exports={"footer-cta-button":"footer-cta-button-PQrgFP8",footerCtaButton:"footer-cta-button-PQrgFP8",label:"label-dY5gX1o"}},179:function(t,e,n){t.exports={footer:"footer-2zH06ot","footer-wrapper":"footer-wrapper-ZN5hv-T",footerWrapper:"footer-wrapper-ZN5hv-T","logo-wrapper":"logo-wrapper-2oBFMPd",logoWrapper:"logo-wrapper-2oBFMPd","footer-navigation":"footer-navigation-2G6uFGJ",footerNavigation:"footer-navigation-2G6uFGJ",cta:"cta-1L6watg"}},180:function(t,e,n){t.exports={"contest-page":"contest-page-KzMRiJq",contestPage:"contest-page-KzMRiJq","win-prizes-wrapper":"win-prizes-wrapper-6Gt4o-8",winPrizesWrapper:"win-prizes-wrapper-6Gt4o-8","win-prizes":"win-prizes-2Y_8O2r",winPrizes:"win-prizes-2Y_8O2r","prize-content":"prize-content-3m4hvTX",prizeContent:"prize-content-3m4hvTX",title:"title-1gLS9Z8","terms-and-conditions":"terms-and-conditions-3jaYgDN",termsAndConditions:"terms-and-conditions-3jaYgDN","prize-content-wrapper":"prize-content-wrapper-2tAWeK5",prizeContentWrapper:"prize-content-wrapper-2tAWeK5","prize-title-wrapper":"prize-title-wrapper-Qx_XIF5",prizeTitleWrapper:"prize-title-wrapper-Qx_XIF5","prize-image-item":"prize-image-item-3SoHYp7",prizeImageItem:"prize-image-item-3SoHYp7","prize-details-wrapper":"prize-details-wrapper-ErxLWIB",prizeDetailsWrapper:"prize-details-wrapper-ErxLWIB","details-item-wrapper":"details-item-wrapper-3_tDwqA",detailsItemWrapper:"details-item-wrapper-3_tDwqA","details-item":"details-item-1SyQHQB",detailsItem:"details-item-1SyQHQB","details-item-inner":"details-item-inner-FUv9GID",detailsItemInner:"details-item-inner-FUv9GID","sub-title":"sub-title-1deIcWi",subTitle:"sub-title-1deIcWi","detail-text":"detail-text-1FxDF28",detailText:"detail-text-1FxDF28","prize-image-wrapper":"prize-image-wrapper-33WYIQn",prizeImageWrapper:"prize-image-wrapper-33WYIQn"}},181:function(t,e,n){t.exports={"contest-thanks-page":"contest-thanks-page-3aRqY03",contestThanksPage:"contest-thanks-page-3aRqY03","win-prizes-wrapper":"win-prizes-wrapper-veNev6j",winPrizesWrapper:"win-prizes-wrapper-veNev6j","win-prizes":"win-prizes-3thrdzx",winPrizes:"win-prizes-3thrdzx","thanks-content":"thanks-content-22vZYj8",thanksContent:"thanks-content-22vZYj8",title:"title-1GTQ7zr",copy:"copy-2kwqRUd",cta:"cta-27tGIot","copy-small":"copy-small-3p33yMk",copySmall:"copy-small-3p33yMk","cta-wrapper":"cta-wrapper-aMU-7Y1",ctaWrapper:"cta-wrapper-aMU-7Y1"}},182:function(t,e,n){t.exports={"site-preloader":"site-preloader-2mpvgv5",sitePreloader:"site-preloader-2mpvgv5",logo:"logo-2JK8dqI","drop-wrapper":"drop-wrapper-eaSDAuJ",dropWrapper:"drop-wrapper-eaSDAuJ","drop-border":"drop-border-1BaUH4Z",dropBorder:"drop-border-1BaUH4Z",drop:"drop-2S2Qn-t",water:"water-uk3Rjbb","label-wrapper":"label-wrapper-2dF9h2b",labelWrapper:"label-wrapper-2dF9h2b",label:"label-1wuTKXt","label-dot":"label-dot-1xi9mQR",labelDot:"label-dot-1xi9mQR","label-overlay":"label-overlay-3uiS5WI",labelOverlay:"label-overlay-3uiS5WI"}},183:function(t,e,n){t.exports={"canvas-container":"canvas-container-2cN-QhJ",canvasContainer:"canvas-container-2cN-QhJ"}},184:function(t,e,n){},255:function(t,e,n){"use strict";var r=n(151),i=n.n(r);e.default=i.a},256:function(t,e,n){"use strict";var r=n(153),i=n.n(r);e.default=i.a},257:function(t,e,n){"use strict";var r=n(154),i=n.n(r);e.default=i.a},258:function(t,e,n){"use strict";var r=n(155),i=n.n(r);e.default=i.a},259:function(t,e,n){"use strict";var r=n(156),i=n.n(r);e.default=i.a},260:function(t,e,n){"use strict";var r=n(157),i=n.n(r);e.default=i.a},261:function(t,e,n){"use strict";var r=n(158),i=n.n(r);e.default=i.a},262:function(t,e,n){"use strict";var r=n(159),i=n.n(r);e.default=i.a},263:function(t,e,n){"use strict";var r=n(160),i=n.n(r);e.default=i.a},264:function(t,e,n){"use strict";var r=n(161),i=n.n(r);e.default=i.a},265:function(t,e,n){"use strict";var r=n(162),i=n.n(r);e.default=i.a},266:function(t,e,n){"use strict";var r=n(163),i=n.n(r);e.default=i.a},267:function(t,e,n){"use strict";var r=n(164),i=n.n(r);e.default=i.a},268:function(t,e,n){"use strict";var r=n(165),i=n.n(r);e.default=i.a},269:function(t,e,n){"use strict";var r=n(166),i=n.n(r);e.default=i.a},270:function(t,e,n){"use strict";var r=n(167),i=n.n(r);e.default=i.a},271:function(t,e,n){"use strict";var r=n(168),i=n.n(r);e.default=i.a},272:function(t,e,n){"use strict";var r=n(169),i=n.n(r);e.default=i.a},273:function(t,e,n){"use strict";var r=n(170),i=n.n(r);e.default=i.a},274:function(t,e,n){"use strict";var r=n(171),i=n.n(r);e.default=i.a},275:function(t,e,n){"use strict";var r=n(172),i=n.n(r);e.default=i.a},276:function(t,e,n){"use strict";var r=n(173),i=n.n(r);e.default=i.a},277:function(t,e,n){"use strict";var r=n(174),i=n.n(r);e.default=i.a},278:function(t,e,n){"use strict";var r=n(175),i=n.n(r);e.default=i.a},279:function(t,e,n){"use strict";var r=n(176),i=n.n(r);e.default=i.a},280:function(t,e,n){"use strict";var r=n(177),i=n.n(r);e.default=i.a},281:function(t,e,n){"use strict";var r=n(178),i=n.n(r);e.default=i.a},282:function(t,e,n){"use strict";var r=n(179),i=n.n(r);e.default=i.a},283:function(t,e,n){"use strict";var r=n(180),i=n.n(r);e.default=i.a},284:function(t,e,n){"use strict";var r=n(181),i=n.n(r);e.default=i.a},287:function(t,e,n){"use strict";var r=n(182),i=n.n(r);e.default=i.a},288:function(t,e,n){"use strict";var r=n(183),i=n.n(r);e.default=i.a},289:function(t,e,n){"use strict";var r=n(184),i=n.n(r);e.default=i.a},414:function(t,e,n){n(415),t.exports=n(879)},415:function(t,e,n){"use strict";n.r(e);n(416),n(417),n(418),n(419),n(420),n(421),n(422),n(423),n(424),n(425),n(426),n(427),n(428),n(429),n(430),n(431),n(432),n(433),n(434),n(435),n(436),n(437),n(438),n(439),n(440),n(441),n(442),n(123),n(443),n(444),n(445),n(446),n(447),n(448),n(449),n(450),n(451),n(452),n(453),n(454),n(455),n(457),n(458),n(459),n(461),n(462),n(463),n(464),n(465),n(466),n(467),n(468),n(469),n(470),n(471),n(472),n(474),n(475),n(476),n(477),n(478),n(479),n(480),n(481),n(482),n(483),n(484),n(485),n(486),n(488),n(489),n(490),n(491),n(492),n(493),n(495),n(497),n(499),n(500),n(501),n(502),n(503),n(504),n(505),n(506),n(507),n(508),n(509),n(510),n(511),n(512),n(513),n(514),n(515),n(516),n(517),n(518),n(519),n(521),n(522),n(524),n(525),n(526),n(528),n(529),n(530),n(531),n(532),n(533),n(534),n(535),n(536),n(537),n(538),n(539),n(321),n(540),n(541),n(542),n(543),n(544),n(545),n(546),n(322),n(547),n(548),n(549),n(550),n(551),n(552),n(553),n(554),n(555),n(556),n(557),n(558),n(559),n(560),n(561),n(562),n(563),n(564),n(565),n(566),n(567),n(568),n(569),n(570),n(571),n(572),n(574),n(575),n(576),n(577),n(578),n(579),n(580),n(581),n(582),n(583),n(584),n(585),n(586),n(587),n(588),n(589),n(590),n(591),n(592),n(593),n(594),n(595),n(596),n(597),n(598),n(599),n(600),n(601),n(602),n(603),n(604),n(605),n(606),n(607),n(608),n(609),n(610),n(612),n(614),n(615),n(617),n(618),n(619),n(620),n(621),n(622),n(625),n(330);e.default={}},626:function(t,e){!function(e){var n="Modernizr"in e,r=e.Modernizr;!function(t,e,n,r){function i(t,e){return typeof t===e}var a=[],o={_version:"3.11.3",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(t,e){var n=this;setTimeout((function(){e(n[t])}),0)},addTest:function(t,e,n){a.push({name:t,fn:e,options:n})},addAsyncTest:function(t){a.push({name:null,fn:t})}},s=function(){};s.prototype=o,s=new s;var l=[],u=n.documentElement,c="svg"===u.nodeName.toLowerCase();!function(){var t,e,n,r,o,u;for(var c in a)if(a.hasOwnProperty(c)){if(t=[],(e=a[c]).name&&(t.push(e.name.toLowerCase()),e.options&&e.options.aliases&&e.options.aliases.length))for(n=0;n<e.options.aliases.length;n++)t.push(e.options.aliases[n].toLowerCase());for(r=i(e.fn,"function")?e.fn():e.fn,o=0;o<t.length;o++)1===(u=t[o].split(".")).length?s[u[0]]=r:(s[u[0]]&&(!s[u[0]]||s[u[0]]instanceof Boolean)||(s[u[0]]=new Boolean(s[u[0]])),s[u[0]][u[1]]=r),l.push((r?"":"no-")+u.join("-"))}}(),function(t){var e=u.className,n=s._config.classPrefix||"";if(c&&(e=e.baseVal),s._config.enableJSClass){var r=new RegExp("(^|\\s)"+n+"no-js(\\s|$)");e=e.replace(r,"$1"+n+"js$2")}s._config.enableClasses&&(t.length>0&&(e+=" "+n+t.join(" "+n)),c?u.className.baseVal=e:u.className=e)}(l),delete o.addTest,delete o.addAsyncTest;for(var f=0;f<s._q.length;f++)s._q[f]();t.Modernizr=s}(e,0,document),t.exports=e.Modernizr,n?e.Modernizr=r:delete e.Modernizr}(window)},627:function(t,e,n){},628:function(t,e,n){var r={"./arrow-left.svg":629,"./counter-circle.svg":630,"./evian-logo.svg":631,"./keyboard-arrow.svg":632,"./link.svg":633,"./pointing-arrows.svg":634,"./pointing-hand.svg":635,"./round-arrow.svg":636};function i(t){var e=a(t);return n(e)}function a(t){if(!n.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}i.keys=function(){return Object.keys(r)},i.resolve=a,t.exports=i,i.id=628},629:function(t,e){t.exports='<svg viewBox="0 0 25 25" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M18.063 11.09H7.193L9.82 8.558a.891.891 0 000-1.29.963.963 0 00-1.332 0l-4.22 4.088a.906.906 0 00-.197.3.878.878 0 000 .69.906.906 0 00.196.299l4.22 4.087a.955.955 0 001.332 0 .893.893 0 00.277-.645c0-.241-.099-.474-.276-.644l-2.627-2.534h10.87c.518 0 .937-.407.937-.909 0-.501-.42-.908-.937-.908z" fill="#E35A74"></path></svg>'},630:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 34.06 34.06"><circle cx="17.03" cy="17.03" r="16.03" style="isolation:isolate" fill="none" stroke="#d46375" opacity=".6" stroke-miterlimit="10" stroke-width="2"></circle></svg>'},631:function(t,e){t.exports='<svg viewBox="0 0 49 28" fill="none" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path fill="url(#pattern0)" d="M0 0h49v28H0z"></path><defs><pattern id="pattern0" patternContentUnits="objectBoundingBox" width="1" height="1"><use xlink:href="#image0_360_50" transform="matrix(.00468 0 0 .0082 -.001 0)"></use></pattern><image id="image0_360_50" width="214" height="122" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANYAAAB6CAYAAADDPa27AAAABHNCSVQICAgIfAhkiAAAHNJJREFUeJztnX90HFd1x7/3zUqyibFX0v6ynaQyTaAhNMhJIQ0U2ASa2tJKO5KsUn5apiW0PS12oIX+olGANqelByuFFhKn2IG2QGxLK0tyUkOwAzSUn3ZiIDROY4UGW6udlWSHkEjaebd/7Nq1Ze3M7OzM7qw0n3PyRzxv3rvamTvvvvvuvQ/w8SSqqgZVVQ1WWw4fewSqLYDPxaiqGszNie25eewAiS4AR6otk0/p+IrlIdrbe7bOz3M/EVqqLYtPefiK5QESiS1xZrmbwL5CLRF8xaoiqqoGc/M0BJZxWuQ6sUzCNwVrElFtAZYzuZzYAVC82HUGdrS3d++upEw+zrDYh9KnAuRnK3ESgKnnj4E9Y2OD2yoglo9D+DNWlcjPVuZKBQAE9PkzV23hz1hVQN2ktuQUcRQWFesc/sxVO/gzVhXQFepHiUoF+DNXLeHPWBWmMFudLKcPf+byPv6MtYBEW/cdicSWop66cinMVmVBQF9bm9rqhDw+7uDvYxXIzyTKEMCtAG4uu798aNJuEJ83+Qh0jIGt5fYNAALUB2CHE335OI+vWAASiZ7tOeZ+gB0Les0rFdQLrW0GnJsJSbzJsb58HGdZm4KqqgYTbd1DYB6ADWdCMRKJ7v68UrkJt6qbVD8EyqMsW8VKJLbEc/PipNMK0NHRo4Jxh5N9FmNeES4rr49dlp1iqaoa7Gjv3gmWh1FkliIpbc0EbW1qK0uupDt8u5+z5U2WlWK1tamtuXnlMJss+lmUnrahqmpQkLIbDpqUZhDQkpsr38vo4zzLRrESiZ7tgsTRgtfPUfJxf8phN/o2hWi7m9sDPvZYFoqVX/fwgFv95+bE7qooVQFmubsWTcJEYks80d51uBZlN2PJu9tVVQ3Oz/POUkJMiOiY1baFEKOqOhHyJqHYDaCrmnJYRd2ktuSE2AmWKkDQ50gFsKfacjnJkp+xcnPUT7C+ZiLgzMjI/pSVtu3t3bsJ6LMvnYMQ1I6OHk97Cc85jnLKxd5YJtpeTbncYEkrViKxJY6SHxrXnlIVYMmeNQkTiZ7tuXlxcnHHEbcutRCtJa1YYN5Z8j1CmCpWe3v3Dq8pVYF8qr/HaG/v3m22CV8I0VoyLFnFSiS6++04FKQ0LujS0dbdR0DpClsxKN7e3u2ZGELLMzuRIzGUXmFJKpa6SW0Bw5bdTij+gDs6elQmeD4fioA7vGBalWguBzvaupfMrLWk8rHa2tRWIZQ3gdFXjvs7oMsNqYdS4xf+m92s3+pBx0bH9m+s1uh21qAMjNfVyY2pVGrGLbkqRc2729vbe7YCHKe8yzsI5rL7LMTgXbTvlVPISlTFY2DMgBAE8OqyBSkLbk0kuvtHRwcrHplh17FzQSSJZ0xZu9SsYi3In3IUYlykWIlEdz8YjWA8QsTjTDTOjBkicQwARkf3XVL7T92ktswrQi28YNVRMulgmkoRVFUN6jq9WkrRQswtII6jnPSYfCRJarHftJaoSVMwkdgSB8shuGSWEWPbyMFBxzYsq6ZkjEdGDw46olyqqgZzOWUrJAfzyiOCbkWbLAWTsOYUK5Ho2e5meBKAZ0bHBl3Lc6qkkjEwPjY2uKGcPs4d0gCC5XJtTlDrdT1qRrHyoUlip9v7RwzcPjY26KbinqcSSjY6NmjrGVdLoS6EBHVZjYLxGjWhWG1tams+JcP9QFcC3z8yNlRxt29HW3efG678UhWroOx3eGQDfCZQJzfUokno+X2sjo4eVZCoWEoGg7ZWYw9o5ODgHjAecbrfUkOcckLs8YhSAUCwEFxcc3hasRKJLXGW7JqTohiCqDqRFUI47hrPzSslpWUEpOwj4IzTctiGoNbixrFnFSsfPSGrFPdG8WokD46O7jvi/KzFraXED6YeSo1DeCtujwk7vRpcXAxPKpaqqsH8HlUVoxxYr0hBmIVISBc2RyleSmnqkZH9KTDf7bwctgnqulJTWdKeVKz5ebGzmhm5eShejfymgwdTxwh8v9P9EtCXD0y2xujBoR0M3O4Vs5C52u9DaXhOsbyUkiGljbQTB1B0dicMiXFHKeuVsbHBAaVOtoBwpyvylEIFokicxFOKlUhsiXspJYOAlmosnFMPpcbdMsW4xI9WKpWaGR0d7A/ocoMbM6llqNqxl6XhGcWqrrOiOJIqU3xzIYF67gfwTDXGXozUQ6nxkbGhPpC42Y1tAQsEa6nyrycUyxPOiiIQ0FKNxMFUKjUTqJOtjpthRGvKuX10dN+R0YODcRLUhQorvi5EzZiDnlAsbzgrimOU/Ogm58wwyXIjgMec6ZVbnXDKjIzsT42ODbZU0sHBHn5HFlJ1xfKSs6I41X2gBw+mjo2ODbY69RKz5KFEe9dhJ0yrcw6Oyqy/yFcsK3jNWeF1xsYGBxRdtjqzxqF4ThFHE4meskuPpVKpmZGxoT7XlYtQM0cXVS0ItxB0uhM211UMGibiY8TYwUBZ6wYrSJYbDx5MWS7k6TYdbd19IAw487fTMcn6Nif+voIF4t7HksTNtZAEWfEZS1XVYHt79+5CJLeNA675/oAuN4yN7VdHRwf7K2WGCBHwlGNl5ODgHqVOtjBouPzeuFWQONrR3l126NDY2OAAMVzLo2KWNWEOVnTGspv+QcAZJgwEAnKgWApBW5vaKiAG3DIXvJwblC+iY03xpczNnJuZ8vGQMg6J+LnfjYFxIej2cv7Wb37nO9f+6OjxD/70p/+7jZnPv2SPPXbcbpfnqVZaT6lUTLFsmn7PEKNfqZcpqzk5hXH6AfySLUGLQbizGoVZKklHR4/KuoyDKA7GyYCUty+sVlVSf46aq3kYGBfMO0YODjkwU7uH64plK/OX8QgBe+zWncjXZxA7zMJgmGiGiC9eV0gOElHfYi8DA3vqdHlnOS9brZD/DQOtgUDuWDmJhm1taqtC4ojT62AGxomxJyDl/V58Hq4rVkdHj7owgJKZWokvPUg7/6LTQLUXp+cUc6FjhMD3Kzr3e/FBepnzZjoAV0rDMVIQ4u5qvzcXUhOp+dWiMNv2ESFotL7zsce5tSGx3scObMITMDAyNni7E7KVi69YPp7AOecTHwnUcVe1P4K+Yvl4ikLNyAGUYS4yMM4su6q57+grlo8nccC7O0OM250svFoKvmL5eJr29u4dAui361Ws1rrLV6wqkY6ov2zWJjqZ+p9KyOJ1inlprVP5dZevWFUiG1UfYHCvQZP/CaWHr6qYQDXAub01O/cGcrnxSm6T1OxpI7UOMwujz1r5hxEtPQozjmf2qoyoej7W8oUNrQXydaum8RWrapBvhi9hfMWqHr5iLWF8xaoSwlerJY2vWFXDeI0FkL/GqmF8xaoS0nSNJSsjiI8r+O72KqEw7QOwr3gL31b08fHx8fHxcRvf3ljmTERvvSxAL7mWmSLEsomIG8FiNYh/DvAZEJ1lllPztOL42om9mWrLa4XpmNqSA10UFR+eGKpovXlfsZYZmVD3WgrkesCkArgWQKyE238I4GtMfCg0ETtEuHfeHSlLQ4t2JMFCBUGFcbGicTCOgGQqlB5xtRhNWYo1Ge5dJcSLryVWXs8kXwvQ6wA0LWimA/gZgKcBfJuYH26abPgaYa9e6nhaNPkWAF8xb8mZ5nTDWjtjlCxTTN0P5m6DJj8MpYd/deE/ZqOdDzCoy+C+Z5wMwp0Mq61C8D8AuAXOfFCzAP5NAPc1pYfLrmumRZOG2wtMdGd4InW+StZ0UA3KermdiXbAXtHXGWIeEHPi7sYZ56PeS3a3M+KBbDT5Vi3aOSLE3DQgHmbijwKUwKVKBQAKgCsBxAF8mIkOZaNzp7So+rGZK9sbSxm7OT38MCydcEHh6dj8raX0bYez6zpCYO4wFoXvWfyCAPJe2WL/OYLWnFivRTu/IAT/AMCb4ZyV0gzg/RJ4XIuqD0xEuyIO9WuKFuvcqjfwSSbqh/0TaoJM1K838Ektojp+cmdJipWJdL5Di655koEvFRTJ7gsQAfivcrOBcS2mfohxW52VmwqBqfdaacss32VTNsvM5pStAIxknxWzDV9wW47FYIAykeT7EFCeAOidcNXs594A5JOZaPLt7o2RR4skd4NpD5w78ikI4iEtkrR8RrMVLClWJtS5TosmDxPRvxKwwcHxV4P576aiEz/JRpKvs3ID68puWNg9ZVDXZLh3VdkSGkCCbzNugC83Te9d9HQQZrPIC/vwtb31Wix5kAifBfBSt8ZZwBoC/k2LJv/Sjc6JEcxGk0dBLp1MQ+jToknHDj40VazM2s5fI4WOA+6dAcuglzHhq9mIamq+hbXB0wCNWOh2hVBmexwQb1Gyka6bwHi5URuhi11ujV8MRjwwpc0NEWNTpccu8HEtqv6t893ydgbcrtuuOjVzGSrWVEzdTJK+gcXXTk6zkonHMtHOTrOGTNLaC8vkmjkoSf9d4xZ0oikz9E23xi9GNrbmUwy0VXrci+E/z6zruL66MtiE0JeNqmWf4FlUsbRoR1IyHwCwotxBSiBAoP3ZcKfh1zY0cf2DAE5b6O8WNxbVE9FbLyPQ7xi1IeCfTa4bYicCN7NWvQGM37dxK5A3r48D/AgD/wngKQA/t9kXSBeftntvtWHwHdOx8g7lW9T5oMXU14J5b7Hri/A8g8cE0V4J0gBASNSzwDoGbyBJCRBb/YIFWNAXp9d2tzaeHlzUA0jolxlK7iLGX5v0RQrpWwF8wuLYlqjDircycJlBkxzN1Tm6GDaD0S+y8mipY36VQF9i0h+fXpV7/OqnHpxd2GAy3LtKBHJXQOdXgPBmgHsArLXQ903ZcOem5syBh0qUyRYMfgwkUliQui8YrQzEAY7DeiGaoM68G8DNduW5RHEmw20xsBwFyIqnbgrAJ6WsvzuS2Wv0dbtDW9fxK9DpLwF6B8w/2EFdyr0M3Fg0RT2nfBaK/hGzvohpGxxWLAaZmIF4oJjTwi2ykR+oAF2yX7YYxPg6mO+y8tIXnusThf9SJ67a/CeNz9V9AKCPw2QpwUL0AnBZsWhYIexonBguVijmCICB6aAazK3ADmLeAWsKFp8Mq62RjL2in5f8MArVfRmgsIV7v1+vyFeE0sN/Y6JUAIDQqZGfhNIH3iUl3wBg0rx7fo0WSRb1uoW1wdNM+A8Lcl6TjnQ5VoQ/E+p6OQBDDyYTma4B2Wn3N9EHLTUDdjVNDsftziRXP/XgbCh94C4w9cDEYmVwp+N/5/9zBkxdoXRKbZwwr77UOJOaCU+k+qWkOCzthQKCYHutdZFiabHkHzLhjea30VeeW3nmN1afGtFKHTCSOXA0APnrsPDHEeGu/728d2XR65ItOTECQr6zBBENEQH5XuMWdCI8kapoJaFsrONamCh7HtrblB5+nxOFakKTqRQTGR6JSkBIW6u64cQ4IyXFQ5Opkg/Hi2RSx5RZaoUV5SJOTgftnXB53hSciN56GRgfM7+FTkhZ171h/MiLdgYEgGB65GQ2lmxjxvdh7BxpfMn87G0A7l7sYvNkbESLpjUCQkbjMfNWBj5U7gvFuK1O43Sf0SfYssfSQZonRn6EasR95ugeKPwBoyak85UAvu/ksEyk2jXRgPzslYmpfcR82KRpUF8BFUDJZarPz1gBrNwOc7f6POuUsGL6mdE8MfxjMBk+FABg0AeLmROEe+cJ+Bfz0Sg8Fel8S+lSXkw2kk6YKHGuQbAlB4KZFtRC+bOwNvQkgJxhI2HJ0WGZQsxg2RZBeCJ1BEzmZ1ebHF5YDAGct/f/2KwxA58u/JiO0DzZeg+BnzZpdkUmltxc7KIilM9YGYsFlW0OEsFs72rIjnlc4xgGOjMQdXCsM4EXMeBUZyzMZyIitrU+FwAwFe78LZinD8wHZumjdgYpBqFfMsG0T8H4vWLXCi55sykdYHSfbInb3pPLhLrXMlBUwQuDWIpjXCpk1qo3AGgwakOMeudGpD1ORqIXZj7DtRYDrXbWWfkZS9BvmzUk4CuuhNfPNqRgbva0nbhqc9EHyDD3wgFYteqFNUbpHYaQom+DsXv5mUL0vSXYtEqTtznZEl9BEpasBcdgF8pLM5n2mVtReiiVKJiBpmFEIKPCJ/Yp7Pd826RZQ+Nz9W8odjGUjuwDYL5vRCgnxMnEG8j31MK6yAkyazt/7aUvrPkawK+p5Lh2vIBmEMGVw+nEZKTrOuRzawzJSfq6GwIAAAPfstCs6CKScO88w9xpQIzftBPilImpcQBGIS6yXrHm+q9Vsuu7L9dial82knyEJH0XwE0VFsHS3lOpSAuKRcbPflECAZKvsfCZ/YWbZzUR0wnz+pT0KsPLuvIZKNJsQ0+pA78dKG0BTCx/18SPN1zrTotMqPOlop6ClONGSRxiFlcT0TUAXwPgBs7pzYB5mVH34IodwXPJyHYUixkbLeyAPJeJqf2mrWxCzK8wV242VKywNvSkFk0+CrOoCMa7UIJiTTX2rpGY22LUhmTpTgtC5e3G7LrkFazL64mplUEtILoS4CuRP460jnWAiQBQoZzosrBsXSHAAi+zUMw4Ssx3uCWExcf3Mka/IPQXT3Ik2gVm4wgE4uu1tV3XhE4PPWFlUFk3/3YYb2KfbsocsBJaVXEY8YAWXd1GoD4Ab2QdzYC4YNbxFcctBHHp01yVoKmmbxtmBE+vmv0igOdNe5Js3YlBbLh3RUyfseO0YBeP8Tm7vqtZi3T+nRZdc5pAwwC6YGEd7eMcgk3CgbwEk2KYZn71Uw/OgmChxgS/20pw6FSk8zoANxg0kVKK+8zHqwyn1nW8RIsm/2IuJ0+C6ENmoV4+7iHIOK/IUwQCZLrZKNg4wbDAei2mvsmskSQqujFdYCxfKqD6TDX2rqnXxX8B+BtUqs5FPrug7PC2pYgAUDR63GvMyXrTxMum9PBxMP3AtDM2jngvVI56t3EbeMLFPhnuXSUb5g4DsJSP5QA/ZoiO0MTwJgDPVWjMmkIAuCRr1KuIgLSU0cwwjzAn0FuNyq5p0YkeGCfEnQ6lN45ZkWfx8Z1DiPlhMDY62OVCdADfY2AnQ3Q0p+uvC6eHRl0cr+YJIK9YhvFeAB5moooXRlnICg5Y2ivS6cUvBLByAMZ/16qp2ISKCexd7CLB2Axkwi5DD2WFyETV2wC+pcxuzgL4MYAMGFkWNEVAGpJPkJBPNjWvOEE/2jvngLjLhgAYZ0FYbdLuuxeW9/U6sfSh57Vo8t8BbDNqx/kqTpco1nRMbdHZ8GVl5JTPliOjE5m1E9GuCEF+ssTbniDgm0w4JnTx+KwS+G/Tww4m7Mu4XAmA6DTAlxs1YrCVVH1PQSx2MUlDxQLQNh1UgwuDi3OQ7yEDdzgzP+QFp4XC/C6QRecTYw8H5KfCp0bM158+ZSMAnDJrRBA157Ztnhz6FghmuWOKvoLfceE/MEDExmYgWYumdx0i7rXQ7CxJ3hyaHN7mK1XlEER8wrQV8TUVkMVxiNnc9c4XR7wXctOMsl6zzZMbyz8CpkxDMBPqXgvgRpNmOivyZpdLkNXcR7cSCOQXrcYwXj4ZbivlHCVPQHMNe2Du9bwxHe152bn/YTIrbUb3esFpQYp8pWkb4D43Z6kzl/c2wfhQiGWLyElh6YcnUW+7eGG1KOR67TdrJyi3FchvsoKQNGjKihBFjuUpjZLPT7pEEgu1JJgGyx3GiLncbKVTR2oGEZl89XHk3a2GEDhRAXkcx0qNP+J8LQuun3sPjL/ADxerzus0ZsGHLKSpYtUFdFfXVIItJMguU0Sh7sSjFtr+djrS6WRhkIpgpa4BgPVTkc7XMxnXPSdyrqaFLDOziViYbZHAzRyx6bXdv8QgM6/rsiVvkTBbMRkCAdguuF8WWqzzjwpZvPYgMnViSKJPmhzLk22aiDmeGm4bYtPdJTfXxbqUn4C/viqKAID6uob9MCljBQBM9P5MqHOd61IVOLu+q1mLJofB9CmhS9sVluqF/jkAZgdRv9boIjE+55XDrAEALJ81ayKUelfOyMpGO7cDllz9yxYBAGue3TtF4AcstG8iIUasHm1aDtlw56a5nP4ErBS6MWH1qRENhAPl9CEU5Z/KlaMUyKRWAQvFVLEA/nOnT7XUoh1JBpUa7bHsOO+cIijWTuEjvj4bS9/H6FXcEGgm2rEhE+38Mgt60OLhDJYgWVYk+pFKOS2sostf/ARmszDj5UKZ28foL9sJeeKqzQ2ZWOdHAbEPDjg1lzrnf6Cm9NAPCfiSpbsY756KzB0+u77LsazUbNPm1VpUHchB/DfBvM5hqTRNDh+CzUo/DHK8EGe5b2Ysfeh5gA6aNmT8VjZ69NFCcc2S4Wt76zNR9W2NzzUcJ6aPwP6B7suKi34kqfMHSaEumEe7gwlvmJuXx7IRdUfzZMp0r6gY2abNq7mu/g8Z+DDATp2EfgkEcJbpX5i41Gq+Zwp1Cx1FOpCaT+AvMgz33c5xI0n+rhbtHAPRg1LnQ5HMgaeKNZ5q7F2j18++iZhuzWpz7yTrB7ZdKiPDFcvG61ykWGHtwKlsVP0zBhsez3IewuUM3peJJv9TkeLPGjOBbxH2mjtB0C+mw4+9TpJ8GxO2oULJllKK+0jR+1HChMHwmNPiAn5RV39g5fzcBMzLgwMAAZQAIyEEQYsmXwCggaCB+ez/N6I1EnPXEUg4kTQmCY3l91J7XDKtN6dTA1o0eQuADqudEPB6KeQ3stG5s1kkvwGmb0vIjBDIMnOWSZGAJAJdA+DXs3z0LbB23KajhLXB01q08yBAlje7WeqVLaNcAlc8u/eFbETdysR2qkStBHAFGFdcGLjodN0mAtdcKFwpZGPJVzLTmwnyec7J/whlR38GFLGXc3jhbQpWPkrAdSWOs5qBdhC3EwjMQN6/xajG8U2LwcAuAiwpFhN/M5IZNQ9SriLNk6lDWjT5jwDeXyUR5mG4n0VXVUySCpOJdr6XmTuJ+PMSIkN14h+zEfWe5snUoUVNolj60PMioLQjf3J6tXmOiT/UlIlZPnDAiFD6+lEAlnKpSIoqnh5iPc63OV3/ARA+76Iwi0LALgabjXtVJbZnKo3WnFhPEL0M5R7JdBMxd8+RvIuJPzkRvfWyomuN5p8NPltXV38jgO9VUN4LYQC7dearwxMHPuHUOqcQmf45C03PTK+etbK3Zwsn/dWEvXpoYngrwH/hYLdGMDP+tDk9fBsRHTVpG8jGJt2sx1EVKKBsZmA3wOuI+GkCPd0gxasBjNah4VcNn++aZ/dOPbfyzBvA/Pco5RNaPo/qLDaG0sPviU4eSDvduSKUXTBfTnz+6qcedK3QjnTBNg6lD9wlBd4IkJvm6wQTd4Qnh/8BAHQpTGuhkJS/4aI8VUEyn19GEVMdA21NobovADQvhTJv+uHcMH7kxdDkgQ+zIl8DYMRVaYEnGPy2UHr49dHJocfcGiS/2UtfNWojPFLarFQip4e/0RyqexVAHwcw7WDXk0z8MSnrrw5PHDhfnarwnH5qfCupDsrhCYSgrxP4vQBAzN8B8cPa1Ox1AF8bOj3zmOXNvkLCXOdUtOtVEvIdAH4HNk5hWAgDj4NoSGHe35QePl5uf1YhkruY6TeLXP6vCsniSk2+QkWljzDid05FVt8Mol4GbgHwyyV2JZlwSIA/1zQRSxUzxyXhDwhUNNaSmCUDtJTOD2ueGP6xFlWHCHjlrGgYCohZDTq9D5CfJhzJlWWOFJSsE8BbQFgPRgwwrPj0PDF+wIRjIP5+gPnrwfTIyXJk8LHO6VhvOMCzN4HE9SQ5RMRNDGoGuAEACPRzSfQ9IflbOutPhyMrn/HLnhmjre26Bqy/mVi8IHX5YFg7cApwwc5n9Atc+6NAWjtTF5VrCAAyAM6s+fm8m2sWHx8fH58lzv8BGljsyodAD7MAAAAASUVORK5CYII="></image></defs></svg>'},632:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52"><rect x="1" y="1" width="50" height="50" rx="5" fill="none" stroke="#505157" stroke-width="2"></rect><path d="M21.87 26.15l8.26-4.33v8.66z" fill="#505157"></path></svg>'},633:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16.17 16.17"><path d="M8.79 3.94l2.52-2.51a2.31 2.31 0 013.36.09 2.55 2.55 0 01.1 3.5l-4.08 4.27a2.39 2.39 0 01-3.76 0m.44 2.94l-2.52 2.51a2.31 2.31 0 01-3.36-.1 2.56 2.56 0 01-.09-3.5l4.09-4.26a2.39 2.39 0 013.76 0" fill="none" stroke="#d46375" stroke-linecap="round" stroke-width="1.5"></path></svg>'},634:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 35 17"><defs><linearGradient id="a" x1="1.44" y1="9.3" x2="37.44" y2="9.3" gradientTransform="matrix(1 0 0 -1 0 18)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#dd7e96"></stop><stop offset="1" stop-color="#dd7e96" stop-opacity="0"></stop></linearGradient></defs><path d="M1.44 1.19l8 7.5-8 7.5m12-15l8 7.5-8 7.5m12-15l8 7.5-8 7.5" fill="none" stroke-width="2" stroke="url(#a)"></path></svg>'},635:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22.85 25.86"><path d="M17.52 5.64l-.19-.73zm-1.06 1.83l.73-.19zm.67 2.5l-.72.19zm-.35.61l-.19-.73zm-.61-.35l-.73.19zm-1.26-4.7l.72-.19zm-1.84-1.06l.2.73zM12 6.31l.72-.2zM13 10l.72-.2zm-.36.6l-.19-.72zm-.61-.34l-.72.19zM10.62 5l-.73.19zM8.78 3.89l-.19-.72zm-1 1.83l-.78.2zm1.43 5.35l.72-.19zm-.36.61L8.61 11zm-.61-.35l.73-.2zM5.1 1.86l-.72.19zM3.27.8L3.08.08zM2.21 2.63l-.72.2zm4.38 14.3l-.47.58L8 19l-.72-2.33zm-2.67-2.16l-.5.56zm-2.72 0l-.54-.52zm.23 2.67l-.5.56zm6.32 5.6l.5-.56zm8.56 1.61l.19.72zm5.53-8.72l.72-.19zm-2.48-9.24l.72-.19zm-2-1.78a2.25 2.25 0 00-1.59 2.76l1.45-.39a.75.75 0 01.52-.92zm-1.62 2.75l.67 2.5 1.45-.38-.67-2.5zm.67 2.5a.25.25 0 01.18-.31L17 11.3a1.26 1.26 0 00.89-1.52zm.18-.31a.25.25 0 01.3.18l-1.45.39a1.25 1.25 0 001.56.88zm.3.18l-1.26-4.69-1.45.39 1.26 4.69zm-1.26-4.69a2.24 2.24 0 00-2.75-1.59l.39 1.45a.73.73 0 01.91.53zm-2.75-1.59a2.25 2.25 0 00-1.59 2.75l1.45-.39a.74.74 0 01.53-.91zM11.29 6.5l1 3.73 1.45-.39-1-3.73zm1 3.73a.25.25 0 01.18-.31l.39 1.45a1.25 1.25 0 00.88-1.53zm.18-.31a.25.25 0 01.3.18l-1.44.39a1.25 1.25 0 001.53.88zm.3.18l-1.43-5.35-1.45.39 1.44 5.35zm-1.43-5.34a2.24 2.24 0 00-2.75-1.59L9 4.62a.74.74 0 01.91.52zM8.59 3.17A2.24 2.24 0 007 5.92l1.45-.39A.74.74 0 019 4.62zM7 5.92l1.43 5.34 1.45-.38-1.43-5.35zm1.43 5.34a.27.27 0 01.18-.26L9 12.4a1.24 1.24 0 00.88-1.52zm.18-.26a.27.27 0 01.31.18l-1.45.39A1.25 1.25 0 009 12.4zm.3.15L5.82 1.63l-1.43.46 3.09 9.47zM5.83 1.67A2.25 2.25 0 003.08.08l.38 1.45a.75.75 0 01.92.52zM3.08.08a2.24 2.24 0 00-1.59 2.75l1.45-.39a.73.73 0 01.52-.91zM1.49 2.85l4.39 14.3 1.43-.44-4.38-14.3zm5.58 13.49l-2.68-2.15-.94 1.17 2.67 2.15zm-2.65-2.12a2.69 2.69 0 00-3.76 0l1.09 1a1.2 1.2 0 011.67 0zm-3.77 0A2.65 2.65 0 00.93 18l1-1.11a1.13 1.13 0 01-.18-1.61zm.78 3.18l-.5.6H1l.15.12c.12.12.3.27.53.47l1.72 1.53 3.87 3.43 1-1.12-3.89-3.37-1.73-1.53-.53-.47-.12-.13zm5.82 6.16a8.55 8.55 0 003.79 2 11 11 0 005.46-.25l-.38-1.44a9.82 9.82 0 01-4.74.23 7.09 7.09 0 01-3.13-1.68zm9.25 1.77c3.59-1 5.29-2.91 6-4.93a8.4 8.4 0 00.1-4.7l-1.45.38A6.92 6.92 0 0121 20c-.5 1.5-1.78 3.12-4.92 4zm6.06-9.63l-2.48-9.2-1.45.39 2.48 9.25zm-2.48-9.2a2.25 2.25 0 00-2.75-1.59l.38 1.45a.75.75 0 01.92.53z" fill="#505157"></path></svg>'},636:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 21"><path d="M9.75.75l-3 3 3 3" fill="none" stroke="#505157" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></path><path d="M2.93 6.38A8.27 8.27 0 109 3.75h-.75" fill="none" stroke="#505157" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></path></svg>'},772:function(t,e,n){var r={"./default/default.fs.glsl":773,"./default/default.vs.glsl":774};function i(t){var e=a(t);return n(e)}function a(t){if(!n.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}i.keys=function(){return Object.keys(r)},i.resolve=a,t.exports=i,i.id=772},773:function(t,e,n){"use strict";n.r(e),e.default="precision mediump float;\n\nvarying vec2 vUV;\n\nuniform sampler2D uTexture;\n\nvoid main(void) {\n\tgl_FragColor = texture2D(uTexture, vUV);\n}\n"},774:function(t,e,n){"use strict";n.r(e),e.default="attribute vec3 aPos;\nattribute vec2 aUV0;\n\nvarying vec2 vUV;\n\nvoid main(void) {\n\tvUV = aUV0;\n\tgl_Position = vec4(aPos, 1.0);\n}"},776:function(t,e,n){var r={"./boxBlur/boxBlur.fs.glsl":777,"./boxBlur/boxBlur.vs.glsl":778,"./bubbles/bubbles.fs.glsl":779,"./bubbles/bubbles.vs.glsl":780,"./flockingBirds/flockingBirds.fs.glsl":781,"./flockingBirds/flockingBirds.vs.glsl":782,"./glow/glow.fs.glsl":783,"./glow/glow.vs.glsl":784,"./icingTransition/icingTransition.fs.glsl":785,"./icingTransition/icingTransition.vs.glsl":786,"./includes/alphaToCoverage.glsl":787,"./keyPoints/keyPoints.fs.glsl":788,"./keyPoints/keyPoints.vs.glsl":789,"./lanes/lanes.fs.glsl":790,"./lanes/lanes.vs.glsl":791,"./lines/lines.fs.glsl":792,"./lines/lines.vs.glsl":793,"./rain/rain.fs.glsl":794,"./rain/rain.vs.glsl":795,"./snow/snow.fs.glsl":796,"./snow/snow.vs.glsl":797,"./unlit/unlit.fs.glsl":798,"./unlit/unlit.vs.glsl":799,"./waterTransition/waterTransition.fs.glsl":800,"./waterTransition/waterTransition.vs.glsl":801,"./whiteTransition/whiteTransition.fs.glsl":802,"./whiteTransition/whiteTransition.vs.glsl":803,"./wind/wind.fs.glsl":804,"./wind/wind.vs.glsl":805,"./zoomBlur/zoomBlur.fs.glsl":806,"./zoomBlur/zoomBlur.vs.glsl":807};function i(t){var e=a(t);return n(e)}function a(t){if(!n.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}i.keys=function(){return Object.keys(r)},i.resolve=a,t.exports=i,i.id=776},777:function(t,e,n){"use strict";n.r(e),e.default="precision mediump float;\n\nvarying vec2 vUV;\n\nuniform sampler2D uTexture;\nuniform vec2 uSourceTexelSize;\n\nuniform sampler2D uSource;\nuniform float uSharp;\n\nvec3 ts(vec2 uv)\n{\n  vec3 c = texture2D(uTexture, uv).xyz;\n  if(uSharp > 0.){\n    return mix(c, texture2D(uSource, uv).xyz, uSharp * uSharp);\n  }else{\n   return c;\n  }\n}\n\nvoid main(void) {\n\tvec4 o = uSourceTexelSize.xyxy * vec2(-1, 1).xxyy;\n\tvec3 s = ts(vUV + o.xy) + ts(vUV + o.zy) + ts(vUV + o.xw) + ts(vUV + o.zw) ;\n\tgl_FragColor.xyz = s * 0.25;\n\tgl_FragColor.w = 1.;\n}\n"},778:function(t,e,n){"use strict";n.r(e),e.default="attribute vec3 aPos;\nattribute vec2 aUV0;\n\nvarying vec2 vUV;\n\nvoid main(void) {\n\tvUV = aUV0;\n\tgl_Position = vec4(aPos, 1.0);\n}\n"},779:function(t,e,n){"use strict";n.r(e),e.default="precision mediump float;\n\nvarying float vOpacity;\nvarying vec2 vUvOffset;\nvarying float vRotation;\n\nuniform sampler2D _Texture;\nuniform float _Additive;\nuniform float _Grid;\n\nmat2 rotate (float a){\n  float s = sin(a);\n  float c = cos(a);\n  return mat2(c, -s, s, c);\n}\n\nvoid main(void) {\n  vec2 centered = (gl_PointCoord.xy - 0.5);\n  if(length(centered) > 0.5)discard;\n  vec2 localUv = (rotate(vRotation) * centered) + 0.5;\n\tvec2 uv = localUv / _Grid + vUvOffset;\n\tfloat a = texture2D(_Texture, uv).x * vOpacity;\n\tgl_FragColor = vec4(1,1,1, 1.  - _Additive) * a;\n}\n"},780:function(t,e,n){"use strict";n.r(e),e.default="attribute vec4 aData0;\nattribute vec4 aData1;\n\n#define aPos aData0.xyz\n#define aRandom aData0.w\n#define aRandom1 aData1.x\n#define aRandom2 aData1.y\n#define aSprite aData1.zw\n\nuniform mat4 _ViewProjection;\n\nuniform float _Opacity;\nuniform highp float _Time;\nuniform float _Gravity;\n\nuniform float _Spread;\nuniform float _PointSize;\nuniform float _ScreenHeight;\n\nuniform vec3 _CameraPos;\nuniform vec3 _CameraDir;\nuniform float _Amp;\nuniform float _Amount;\n\nvarying vec2 vUvOffset;\nvarying float vRotation;\nvarying float vOpacity;\n\nvec3 getPos(vec3 p)\n{\n\tp.xz += sin(p.yz * 50. + (_Time * 3.)) * _Amp;\n\tp.xz += cos(p.zx * 37. + (_Time * 5.)) * _Amp * 0.5;\n\tp.y -= _Gravity * _Time;\n\treturn p;\n}\n\nvoid main(void) {\n\n\tvec3 p = getPos(aPos);\n\n\tvec3 center = _CameraPos - _CameraDir * _Spread;\n\tp = mod (p * _Spread - center, vec3(2.* _Spread)) - _Spread + center;\n\n\tgl_Position = _ViewProjection * vec4(p, 1.);\n\n\tfloat size = _ScreenHeight * _PointSize / gl_Position.w;\n\tsize *= aRandom1 + 0.5;\n\t//prevent performance drop because of fillrate\n\tgl_PointSize = min(size, 100.);\n\tgl_PointSize *= smoothstep(_Amount + 0.1, _Amount, aRandom1 * 1.1);\n\n\tfloat alpha = _Opacity * (aRandom2 + 0.5);\n\tvOpacity = alpha * min(gl_PointSize, 1.);\n\n\tvOpacity *= smoothstep(_Spread * 2., _Spread, distance(_CameraPos, p));\n\n\tvUvOffset = aSprite;\n\n\tvRotation = _Time * (aRandom1 - 0.5) * 5.;\n }\n"},781:function(t,e,n){"use strict";n.r(e),e.default="\n#ifdef GL_ES\n\tprecision mediump float;\n#endif\n\nvarying vec2 vUV;\n\nuniform sampler2D uTexture;\n\nvoid main(void) {\n  float a =  texture2D(uTexture, vUV).x;\n\tgl_FragColor = vec4(0.1, 0.2, 0.3, a);\n }\n"},782:function(t,e,n){"use strict";n.r(e),e.default="\nattribute vec4 aPos;\n\nuniform mat4 uViewProjection;\n//uniform float uPointSize;\nuniform float uLength;\nuniform float uWidth;\nuniform float uAspectRatio;\nuniform vec3 uPositions[COUNT];\nuniform vec3 uVelocities[COUNT];\nuniform vec3 uPredator;\nuniform vec3 uPredatorVelocity;\nuniform vec3 uCameraPos;\n\nvarying vec2 vUV;\n\nvoid main(void) {\n\tbool isPredator = (aPos.w + 0.5) > float(COUNT);\n\n\tvec3 p = uPredator;\n\tif(!isPredator){\n\t\tp = uPositions[int(aPos.w)];\n\t}\n\n\tvec3 v = uPredatorVelocity;\n\tif(!isPredator){\n\t\tv = uVelocities[int(aPos.w)];\n\t}\n\n\tv = normalize(v);\n\tp += v * (aPos.x * uLength);\n\n  vec3 e = normalize(p- uCameraPos);\n\n\tvec3 side = normalize(cross (v, e));\n\n\tp += side * ((aPos.y * 2. - 1.) * uWidth);\n\n\tgl_Position = uViewProjection * vec4(p,1);\n\n\tvUV = aPos.xy;\n}\n\n"},783:function(t,e,n){"use strict";n.r(e),e.default="precision mediump float;\n\nvarying vec2 vUV;\n\nuniform vec4 _Color;\n\nvoid main(void) {\n\tfloat a = smoothstep(1., 0., dot(vUV, vUV));\n\tgl_FragColor = _Color * a;\n\tgl_FragColor.xyz *= gl_FragColor.w;\n\t//sightly additive\n\tgl_FragColor.w *= 0.5;\n}\n"},784:function(t,e,n){"use strict";n.r(e),e.default="attribute vec3 aPos;\nattribute vec2 aUV0;\n\nuniform mat4 _ViewProjection;\n//uniform mat4 _Model;\nuniform vec3 _Position;\n\nvarying vec2 vUV;\n\nvoid main(void) {\n  vec3 p = aPos * .75;\n//  vec4 world = _Model * vec4(p, 1.);\n  vec4 world = vec4(p + _Position, 1.);\n  world.z += 0.25;\n\tgl_Position = _ViewProjection * world;\n\n  vUV = aUV0 * 2. - 1.;\n }\n"},785:function(t,e,n){"use strict";n.r(e),e.default="precision mediump float;\n\nvarying vec2 vUV;\n\nuniform sampler2D _Texture;\nuniform sampler2D _Mask;\nuniform float _Progress;\n#define _Feather 0.05\n\nvoid main(void) {\n  float mask = texture2D(_Mask, vUV).x;\n\tgl_FragColor.xyz = texture2D(_Texture, vUV).xyz;\n\tgl_FragColor.w = smoothstep(0., _Feather, _Progress * (1. + _Feather) - mask);\n}\n"},786:function(t,e,n){"use strict";n.r(e),e.default="attribute vec3 aPos;\nattribute vec2 aUV0;\n\nuniform float _AspectRatio;\nuniform float _TextureAspectRatio;\n\nvarying vec2 vUV;\n\nvoid main(void) {\n\tvUV = aUV0;\n\n  float a = _AspectRatio / _TextureAspectRatio;\n  if(a < 1.){\n    vUV.x = (vUV.x - 0.5) * a + 0.5;\n  }else{\n    vUV.y = (vUV.y - 0.5) / a + 0.5;\n  }\n\n\tgl_Position = vec4(aPos, 1.0);\n}\n"},787:function(t,e,n){"use strict";n.r(e),e.default="uniform float _Cutoff;\nuniform float _Softness;\n\nfloat hash12(vec2 p)\n{\n\tvec3 p3  = fract(vec3(p.xyx) * .1031);\n\tp3 += dot(p3, p3.yzx + 33.33);\n\treturn fract((p3.x + p3.y) * p3.z);\n}\n\nfloat alphaToCoverage(float a, vec2 uv)\n{\n\t//float _Cutoff = 0.5;\n\tif (_Softness < 0.01){\n\t\t// rescale alpha by partial derivative\n\t\ta = clamp((a - _Cutoff) / max(fwidth(a), 0.0001) + 0.5, 0., 1.);\n\t}else {\n\t\tif (_Softness < 0.99){\n\t\t\tfloat l = _Cutoff - _Softness * 0.5;\n\t\t\tfloat h = _Cutoff + _Softness * 0.5;\n\t\t\ta = clamp((a - l) / (h - l), 0., 1.);\n\t\t}\n\t\t//tweaked for 2x msaa, 4 samples\n\t\tfloat noiseAmount = 0.25;\n\n\t\t//a += (hash12(uv * 1000.) -  0.5) * noiseAmount;\n\t\ta += hash12(uv * 1000.) * noiseAmount;\n\t\t//a += hash12(gl_FragCoord.xy) * noiseAmount;\n\t\ta = a * (1. + noiseAmount) - noiseAmount;\n\t}\n\treturn a;\n}\n"},788:function(t,e,n){"use strict";n.r(e),e.default="precision mediump float;\n\nvarying vec3 vColor;\n\nvoid main(void) {\n\tvec2 uv = gl_PointCoord.xy * 2. - 1.;\n\tfloat b = smoothstep(1., 0., dot(uv, uv));\n\n\tgl_FragColor.xyz = vColor * b;\n\tgl_FragColor.w = 0.;\n}"},789:function(t,e,n){"use strict";n.r(e),e.default="attribute vec4 aData;\n\nuniform mat4 _ViewProjection;\nuniform float _PointSize;\nuniform float _ScreenHeight;\n\nvarying vec3 vColor;\n\nvoid main(void) {\n\n\tgl_Position = _ViewProjection * vec4(aData.xyz, 1.);\n\n\tgl_PointSize = _ScreenHeight * 0.1 / gl_Position.w;\n\n\tvColor = aData.w < 0.5? vec3(1,0,0) : aData.w < 1.5? vec3(0,1,0) : vec3(0,0,1);\n }\n"},790:function(t,e,n){"use strict";n.r(e),e.default="precision mediump float;\n\nvarying vec2 vUV;\nvarying float vOpacity;\n\nvoid main(void) {\n\tgl_FragColor = vec4(1., 1., 1.,vOpacity);\n }\n"},791:function(t,e,n){"use strict";n.r(e),e.default="\nattribute vec3 aPos;\nattribute vec2 aUV0;\n\nuniform mat4 _ViewProjection;\nuniform float _Width;\nuniform float _Length;\nuniform vec3 _CameraPos;\nuniform vec3 _Position;\nuniform vec3 vWorld;\nuniform float _Visibility;\nuniform float _Opacity;\n\nvarying vec2 vUV;\nvarying float vOpacity;\n\n#ifdef TRACK_DEFORM\n   uniform vec2 _MinMaxZ;\n    #define DEFORM_COUNT 64\n   uniform vec2 _Deform[DEFORM_COUNT];\n\n   float linearStep(float e0, float e1, float x)\n   {\n    return clamp((x - e0) / (e1 - e0), 0., 1.);\n   }\n#endif\n\nvoid main(void) {\n\n  vec3 p = aPos;\n  p.x *= _Width;\n  p.z = (p.z * 0.5 + 0.5) * _Length;\n  p += _Position;\n\n   #ifdef TRACK_DEFORM\n      float phase = linearStep(_MinMaxZ.x, _MinMaxZ.y, p.z);\n      float count = float(DEFORM_COUNT);\n      float iPhase = phase * count;\n      vec2 offset0 = _Deform[int(min(floor(iPhase), count - 1.))];\n      vec2 offset1 = _Deform[int(min(ceil(iPhase), count - 1.))];\n      p.xy += mix(offset0, offset1, fract(iPhase));\n    #endif\n\n\n  float d = distance(p, _CameraPos);\n  vOpacity = smoothstep(50., 0., d) * _Visibility * _Opacity;\n\n\tgl_Position = _ViewProjection * vec4(p,1);\n\n\tvUV = aUV0 * 2. - 1.;\n}\n\n"},792:function(t,e,n){"use strict";n.r(e),e.default="\n#ifdef GL_ES\n\tprecision mediump float;\n#endif\n\nvoid main(void) {\n\tgl_FragColor = vec4(1,0,0,1);\n }"},793:function(t,e,n){"use strict";n.r(e),e.default="\nattribute vec3 aPos;\n\nuniform mat4 _ViewProjection;\nuniform vec3 _Min;\nuniform vec3 _Max;\n\nvoid main(void) {\n\tvec3 p = mix(_Min, _Max, aPos * 0.5 + 0.5);\n\tgl_Position = _ViewProjection * vec4(p, 1.0);\n}\n\n"},794:function(t,e,n){"use strict";n.r(e),e.default="\n#ifdef GL_ES\n\tprecision mediump float;\n#endif\n\n#extension GL_OES_standard_derivatives : enable\n\nvarying vec2 vUV;\nvarying float vOpacity;\n\nuniform float _Opacity;\nuniform float _Additive;\n\nvoid main(void) {\n  vec2 d = smoothstep(1., 0., abs(vUV));\n  float a = d.x * d.y * _Opacity * vOpacity;\n\tgl_FragColor = vec4(1., 1., 1.,1.  - _Additive) * a;\n }\n"},795:function(t,e,n){"use strict";n.r(e),e.default="\nattribute vec4 aData0;\nattribute vec4 aData1;\n\nuniform mat4 _ViewProjection;\nuniform float _Length;\nuniform float _Width;\n//uniform float _AspectRatio;\nuniform vec3 _CameraPos;\n\nuniform highp float _Time;\nuniform float _Gravity;\nuniform float _Spread;\nuniform vec3 _CameraDir;\nuniform float _Amount;\n\nvarying vec2 vUV;\nvarying float vOpacity;\n\nvec3 getPos(vec3 p)\n{\n\tp.y -= _Gravity * _Time;\n\treturn p;\n}\n\nvoid main(void) {\n\n  vec3 p = getPos(aData1.xyz);\n\n  vec3 center = _CameraPos - _CameraDir * _Spread;\n  p = mod (p * _Spread - center, vec3(2.* _Spread)) - _Spread + center;\n\n  vec3 v = vec3(0, -1, 0);\n\n\tvec3 local = v * (aData0.x * _Length * (aData0.w + 0.5));\n\n  vec3 e = normalize(p - _CameraPos);\n\n\tvec3 side = normalize(cross (v, e));\n\n\tlocal += side * ((aData0.y * 2. - 1.) * _Width);\n\n  local *= smoothstep(_Amount + 0.1, _Amount, aData0.w * 1.1);\n\n  p += local;\n\n\tgl_Position = _ViewProjection * vec4(p,1);\n\n\tvUV = aData0.xy ;\n\n\tvOpacity = 0.5 + aData0.z;\n}\n\n"},796:function(t,e,n){"use strict";n.r(e),e.default="precision mediump float;\n\nvarying float vOpacity;\nvarying vec2 vUvOffset;\nvarying float vRotation;\n\nuniform sampler2D _Texture;\nuniform float _Additive;\nuniform float _Grid;\n\nmat2 rotate (float a){\n  float s = sin(a);\n  float c = cos(a);\n  return mat2(c, -s, s, c);\n}\n\nvoid main(void) {\n  vec2 centered = (gl_PointCoord.xy - 0.5);\n  if(length(centered) > 0.5)discard;\n  vec2 localUv = (rotate(vRotation) * centered) + 0.5;\n\tvec2 uv = localUv / _Grid + vUvOffset;\n\tfloat a = texture2D(_Texture, uv).x * vOpacity;\n\tgl_FragColor = vec4(1,1,1, 1.  - _Additive) * a;\n}\n"},797:function(t,e,n){"use strict";n.r(e),e.default="attribute vec4 aData0;\nattribute vec4 aData1;\n\n#define aPos aData0.xyz\n#define aRandom aData0.w\n#define aRandom1 aData1.x\n#define aRandom2 aData1.y\n#define aSprite aData1.zw\n\nuniform mat4 _ViewProjection;\n\nuniform float _Opacity;\nuniform highp float _Time;\nuniform float _Gravity;\n\nuniform float _Spread;\nuniform float _PointSize;\nuniform float _ScreenHeight;\n\nuniform vec3 _CameraPos;\nuniform vec3 _CameraDir;\nuniform float _Amp;\nuniform float _Amount;\n\nvarying vec2 vUvOffset;\nvarying float vRotation;\nvarying float vOpacity;\n\nvec3 getPos(vec3 p)\n{\n\tp += sin(p * 50. + (_Time * 0.05)) * _Amp;\n\tp.y -= _Gravity * _Time;\n\treturn p;\n}\n\nvoid main(void) {\n\n\tvec3 p = getPos(aPos);\n\n\tvec3 center = _CameraPos - _CameraDir * _Spread;\n\tp = mod (p * _Spread - center, vec3(2.* _Spread)) - _Spread + center;\n\n\tgl_Position = _ViewProjection * vec4(p, 1.);\n\n\tfloat size = _ScreenHeight * _PointSize / gl_Position.w;\n\tsize *= aRandom1 + 0.5;\n\t//prevent performance drop because of fillrate\n\tgl_PointSize = min(size, 100.);\n\tgl_PointSize *= smoothstep(_Amount + 0.1, _Amount, aRandom1 * 1.1);\n\n\tfloat alpha = _Opacity * (aRandom2 + 0.5);\n\tvOpacity = alpha * min(gl_PointSize, 1.);\n\n\tvUvOffset = aSprite;\n\n\tvRotation = _Time * (aRandom1 - 0.5) * 5.;\n }\n"},798:function(t,e,n){"use strict";n.r(e),e.default="#extension GL_OES_standard_derivatives : enable\n\nprecision mediump float;\n\nvarying highp vec2 vUV;\n\n#ifdef FADE\n\tuniform float _Opacity;\n#endif\n\n#ifdef ALPHA_TO_COVERAGE\n//\t#include includes/alphaToCoverage.glsl\n\n#endif\n\nuniform vec4 _Color;\n\n#ifdef DEBUG\nuniform vec2 _TextureResolution;\nuniform float _ShowPixelDensity;\nuniform float _ShowOverdraw;\n\nvec3 pixelDensityColor(float x){\n  x = 1. - exp(-x);\n  //return vec3(min(x, 1.), max(1. - x, 0.), 0.5);\n  return vec3(x,x,x);\n}\n\n#endif\n\n#ifdef TEXTURED\n\tuniform sampler2D _Texture;\n#endif\n\n#ifdef ALPHA_MAP\n\tuniform sampler2D _AlphaMap;\n#endif\n\n#ifdef TERRAIN\n\tuniform sampler2D  _Texture0;\n\tuniform sampler2D  _Texture1;\n\tuniform sampler2D  _Texture2;\n\n\tvarying vec2 vUV0;\n\tvarying vec2 vUV1;\n\tvarying vec2 vUV2;\n\n\tvec3 terrain(in vec3 c)\n\t{\n\t\tc /= c.x + c.y + c.z;\n\t\tvec3 terrain = c.x * texture2D(_Texture0, vUV0).xyz;\n\t\tterrain += c.y * texture2D(_Texture1, vUV1).xyz;\n\t\tterrain += c.z * texture2D(_Texture2, vUV2).xyz;\n\t\treturn terrain;\n\t}\n#endif\n\n#ifdef TEXTURE_SCROLL\n//  uniform float _EndsFade;\n\n  varying highp vec2 vScrollUv;\n#endif\n\n#ifdef BACKFACE_TINT\n uniform vec4 _BackFaceColor;\n#endif\n\n#ifdef FOG\n  uniform vec3 _CameraPosition;\n  varying vec3 vWorld;\n  //varying vec2 vDistanceHeight;\n  uniform vec4 _Fog;\n#endif\n\n#ifdef WATER\n  uniform highp float _Time;\n\n  #define m3 mat3(-0.7373, 0.4562, 0.4980, 0, -0.7373, 0.6754, 0.6754, 0.4980, 0.5437)\n  vec3 sineNoise33(vec3 p)\n  {\n      float a = 1.;\n       vec3 n = vec3(0);\n       for(int i = 0; i <5 ; i++){\n         p = m3 * p;\n         vec3 s = sin( p.zxy / a) * a;\n         p += s;\n         n += s;\n         a *= 0.8;\n       }\n       return n;\n  }\n#endif\n\n#ifdef BOTTLE\n\tvarying vec3 vNormal;\n\tvarying vec3 vWorld;\n  uniform vec3 _CamPos;\n#endif\n\n\nvoid main(void) {\n\n\tvec4 c = _Color;\n\n\t\t#ifdef TEXTURED\n\t\t  #ifdef TRANSPARENT\n\t\t     #ifdef TEXTURE_SCROLL\n\t\t       #ifdef ALPHA_MAP\n\t\t         c.w *= texture2D(_AlphaMap, vScrollUv).x;\n             //c.xyz *= texture2D(_Texture, vUV).xyz;\n\t\t         #else\n\t\t        c *= texture2D(_Texture, vScrollUv);\n            #endif\n//            c.w *= smoothstep(0.5, 0.5 - _EndsFade, abs(vUV.x - 0.5));\n\t\t      #else\n\t\t        #ifdef COLOR_LAYER\n\t\t          c = texture2D(_Texture, vUV);\n\t\t          c.xyz = mix( c.xyz, _Color.xyz, _Color.w);\n\t\t        #else\n\t\t          c *= texture2D(_Texture, vUV);\n           #endif\n\t\t    #endif\n      #else\n\n           #ifdef COLOR_LAYER\n              c.xyz = mix(texture2D(_Texture, vUV).xyz, _Color.xyz, _Color.w);\n              c.w = 1.;\n           #else\n            vec2 uv = vUV;\n              \t#ifdef WATER\n              \t \t  uv += sineNoise33(vec3(vUV * 20., _Time * 2.)).xy * 0.02;\n              \t \t  uv.x += _Time * 0.1;\n              \t \t#endif\n               c.xyz *= texture2D(_Texture, uv).xyz;\n\t \t\t      #endif\n        #endif\n\t \t#endif\n\n\n\n\t \t#ifdef ALPHA_TO_COVERAGE\n//\t \t  c.w = alphaToCoverage(c.w, vUV);\n\t \t#endif\n\n\t \t#ifdef FADE\n      c.w *= _Opacity;\n    #endif\n\n\t  #ifdef TERRAIN\n       c.xyz = terrain(c.xyz);\n    #endif\n\n    #ifdef BACKFACE_TINT\n      if(!gl_FrontFacing)c.xyz *= _BackFaceColor.xyz;\n     #endif\n\n    #ifdef FOG\n      float d = distance(vWorld, _CameraPosition);\n      float df = 1.0 - exp( -d * _Fog.w );\n      float dhf = 1.0 - exp( -d * _Fog.w * 25.);\n      float hf = smoothstep(30., 0., vWorld.y);\n      float fogAmount = min(df + hf * dhf, 1.);\n//      float fogAmount = 1.0 - exp( -vDistanceHeight.x * _Fog.w );\n//       fogAmount *= smoothstep(30., -10., vDistanceHeight.y);\n        c.xyz = mix( c.xyz, _Fog.xyz, fogAmount );\n    #endif\n\n    #ifdef BOTTLE\n      vec3 v = normalize(vWorld -_CamPos);\n      vec3 n = normalize(vNormal);\n      vec3 r = reflect(n,v);\n      float spec = dot(r, normalize(vec3(0.5, 1, 1)));\n      spec = pow(abs(spec), 50.);\n    \t//c.xyz = vec3(1. - abs(dot(n,v)));\n//    \tc.xyz *= 0.75 + n.y * 0.25;\n    \tc.xyz *= 0.8 + step(0.,  n.y) * 0.2;\n    \tc.xyz += smoothstep(0.,fwidth(spec), spec - 0.1) * 0.25;\n    #endif\n\n     //premultiplied alpha\n     c.xyz *= c.w;\n\n    #ifdef DEBUG\n      if(_ShowPixelDensity > 0.5){\n      vec2 p = vUV * _TextureResolution;\n      vec2 pixel = mod(floor(p * 0.5), 2.);\n      float checker = fract((pixel.x + pixel.y) * 0.5) + 0.5;\n      c.xyz = pixelDensityColor(length(fwidth(p))) * checker;\n       c.xyz *= c.w;\n      }\n\n      //does not work with alpha to coverage\n     if(_ShowOverdraw > 0.5){\n\n       \t#ifdef ALPHA_TO_COVERAGE\n       \t // c.xyz = vec3(1,1,1);\n       \t // c.w = step(hash12(vUV * 100.), 0.1);\n       \t#else\n         //c.xyz = vec3(step(0.01, c.w) * 0.1);\n         c.xyz = vec3(0.1);\n         c.w = 0.;\n        #endif\n     }\n    #endif\n\n\tgl_FragColor = c;\n }\n"},799:function(t,e,n){"use strict";n.r(e),e.default="\nattribute vec3 aPos;\nattribute vec2 aUV0;\n\nuniform highp float _Time;\n\n#ifdef MOVEMENT\nattribute vec3 aColor;\n\n#define m4  mat4( 0.00, 0.80, 0.60, -0.4, -0.80,  0.36, -0.48, -0.5, -0.60, -0.48, 0.64, 0.2, 0.40, 0.30, 0.20,0.4)\n#define m3 mat3(-0.73736, 0.45628, 0.49808, 0, -0.73736, 0.67549, 0.67549, 0.49808, 0.54371)\nvec3 movement(vec3 p)\n{\n  //keep matched with unity\n  float _Amplitude = 0.1;\n  float _SpatialFrequency = 2.;\n  float _TemporalFrequency = 2.;\n\n  vec3 q = p * _SpatialFrequency;\n  q.y +=  _Time * _TemporalFrequency;\n  float _Falloff = 0.618;\n  float a = 1.;\n   vec3 sum = vec3(0);\n   for(int i = 0; i <3 ; i++){\n     q = m3 * q;\n     vec3 s = sin( q.yxz / a) * a;\n     sum += s;\n     a *= _Falloff;\n   }\n  return sum * _Amplitude * aColor.x;\n}\n#endif\n\n#ifdef TIME_SCROLL\n  uniform float _Speed;\n#endif\n\nuniform mat4 _ViewProjection;\nuniform mat4 _Model;\n\n#ifdef BILLBOARD\n  uniform mat4 _View;\n  uniform mat4 _Projection;\n#endif\n\n#ifdef TEXTURED\nuniform vec4 _MainTex_ST;\n#endif\n\n#ifdef BOTTLE\n  attribute vec3 aNormal;\n\tvarying vec3 vNormal;\n\tvarying vec3 vWorld;\n#endif\n\n#ifdef SKINNED_MATRICES\nattribute vec4 aSkinIndex;\nattribute vec4 aSkinWeight;\n#endif\n\n#ifdef TERRAIN\n\tvarying vec2 vUV0;\n\tvarying vec2 vUV1;\n\tvarying vec2 vUV2;\n\n\tuniform vec4 _Texture0ScaleOffset;\n\tuniform vec4 _Texture1ScaleOffset;\n\tuniform vec4 _Texture2ScaleOffset;\n#endif\n\n#ifdef TEXTURE_SCROLL\n  uniform float _ScrollPhase;\n  uniform float _Repeat;\n\n  varying highp vec2 vScrollUv;\n#endif\n\nvarying highp vec2 vUV;\n\n#ifdef SKINNED_MATRICES\n\tuniform mat4 _BoneMatrices[BONE_COUNT];\n\tmat4 getBoneMatrix( const in float i ) {\n\t\treturn _BoneMatrices[int(i)];\n\t}\n#endif\n\n#ifdef FOG\n  //varying highp vec2 vDistanceHeight;\n  varying highp vec3 vWorld;\n#endif\n\n#ifdef TRACK_DEFORM\n   uniform vec2 _MinMaxZ;\n    #define DEFORM_COUNT 64\n   uniform vec2 _Deform[DEFORM_COUNT];\n\n   float linearStep(float e0, float e1, float x)\n   {\n    return clamp((x - e0) / (e1 - e0), 0., 1.);\n   }\n#endif\n\nvoid main(void) {\n#ifdef SKINNED_MATRICES\n\tmat4 skinMatrix = mat4(0.0);\n\t\tskinMatrix += aSkinWeight.x * getBoneMatrix(aSkinIndex.x);\n\t\tskinMatrix += aSkinWeight.y * getBoneMatrix(aSkinIndex.y);\n\t\tskinMatrix += aSkinWeight.z * getBoneMatrix(aSkinIndex.z);\n\t\tskinMatrix += aSkinWeight.w * getBoneMatrix(aSkinIndex.w);\n\n\tvec4 pos = skinMatrix * vec4(aPos, 1.0);\n#else\n\tvec4 pos = vec4(aPos, 1.0);\n#endif\n\n\t#ifdef TERRAIN\n\t\tvUV0 = aUV0 * _Texture0ScaleOffset.xy + _Texture0ScaleOffset.zw;\n\t\tvUV1 = aUV0 * _Texture0ScaleOffset.xy + _Texture1ScaleOffset.zw;\n\t\tvUV2 = aUV0 * _Texture0ScaleOffset.xy + _Texture2ScaleOffset.zw;\n\t#endif\n\n  vUV = aUV0;\n\n  #ifdef TEXTURE_SCROLL\n      vScrollUv = aUV0;\n      vScrollUv.x -= _ScrollPhase;\n      vScrollUv.x *= _Repeat;\n  #endif\n\n\n\t  vec4 world;\n\t  #ifdef BILLBOARD\n\t      //does not work well with negative scale\n\t\t\t\tvec3 vpos = mat3(_Model) * aPos;\n\t\t\t\tworld = _Model * vec4(0,0,0,1);\n        vec4 viewPos = _View * world + vec4(vpos, 0);\n        gl_Position = _Projection * viewPos;\n\t  #else\n\t      world = _Model * pos;\n\n\t      #ifdef MOVEMENT\n          world.xyz += movement(world.xyz);\n        #endif\n\n        #ifdef TRACK_DEFORM\n          float phase = linearStep(_MinMaxZ.x, _MinMaxZ.y, world.z);\n          float count = float(DEFORM_COUNT);\n          float iPhase = phase * count;\n//          vec2 offset0 = _Deform[int(floor(iPhase))];\n//          vec2 offset1 = _Deform[int(ceil(iPhase))];\n          vec2 offset0 = _Deform[int(min(floor(iPhase), count - 1.))];\n          vec2 offset1 = _Deform[int(min(ceil(iPhase), count - 1.))];\n          world.xy += mix(offset0, offset1, fract(iPhase));\n        #endif\n\n        gl_Position = _ViewProjection * world;\n\n\t  #endif\n\n\t     #ifdef FOG\n\t      vWorld =  world.xyz;\n//         vDistanceHeight = vec2(distance(_CameraPosition, world.xyz), world.y);\n       #endif\n\n  \t#ifdef TEXTURED\n  \t   #ifdef PROJECT_XY\n  \t   \tvProjectUV = vProjectUV * _MainTex_ST.xy + _MainTex_ST.zw;\n  \t   #else\n  \t   \tvUV = vUV * _MainTex_ST.xy + _MainTex_ST.zw;\n      #endif\n\n  \t#endif\n\n    #ifdef TIME_SCROLL\n      vUV.x += _Time * _Speed;\n    #endif\n\n    #ifdef BOTTLE\n      vWorld =  world.xyz;\n    \tvNormal = mat3( _Model) * aNormal;\n    #endif\n\n\n}\n\n"},800:function(t,e,n){"use strict";n.r(e),e.default="precision mediump float;\n\nvarying vec2 vUV;\n\nuniform sampler2D _Texture;\nuniform sampler2D _Mask;\nuniform float _Progress;\n#define _Feather 0.05\n\n\nvec2 hash( vec2 p )\n{\n    //p = mod(p, 4.0); // tile\n    p = vec2(dot(p,vec2(127.1,311.7)),\n             dot(p,vec2(269.5,183.3)));\n    return fract(sin(p)*18.5453);\n}\n\n\n// return distance, and cell id\nvec2 voronoi( in vec2 x )\n{\n    vec2 n = floor( x );\n    vec2 f = fract( x );\n\n\tvec3 m = vec3( 8.0 );\n    for( int j=-1; j<=1; j++ )\n    for( int i=-1; i<=1; i++ )\n    {\n        vec2  g = vec2( float(i), float(j) );\n        vec2  o = hash( n + g );\n      vec2  r = g - f + o;\n\t    //vec2  r = g - f ;//+ (0.5+0.5*sin(iTime+6.2831*o));\n\t\tfloat d = dot( r, r );\n        if( d<m.x )\n            m = vec3( d, o );\n    }\n\n    return vec2( sqrt(m.x), m.y+m.z );\n}\n\n\nfloat getMask(vec3 c, vec2 uv){\n  return voronoi(uv * 20.).x;\n}\n\nvoid main(void) {\n //float mask = texture2D(_Mask, vUV).x;\n  vec3 c =  texture2D(_Texture, vUV).xyz;\n   float mask = getMask(c, vUV);\n\n\tgl_FragColor.xyz = c;\n\tgl_FragColor.w = smoothstep(0., _Feather, _Progress * (1. + _Feather) - mask);\n}\n"},801:function(t,e,n){"use strict";n.r(e),e.default="attribute vec3 aPos;\nattribute vec2 aUV0;\n\nuniform float _AspectRatio;\nuniform float _TextureAspectRatio;\n\nvarying vec2 vUV;\n\nvoid main(void) {\n\tvUV = aUV0;\n\n  float a = _AspectRatio / _TextureAspectRatio;\n  if(a < 1.){\n    vUV.x = (vUV.x - 0.5) * a + 0.5;\n  }else{\n    vUV.y = (vUV.y - 0.5) / a + 0.5;\n  }\n\n\tgl_Position = vec4(aPos, 1.0);\n}\n"},802:function(t,e,n){"use strict";n.r(e),e.default="precision mediump float;\n\nvarying vec2 vUV;\n\nuniform sampler2D _Mask;\nuniform float _Progress;\n#define _Feather 0.05\n\nvoid main(void) {\n  float mask = texture2D(_Mask, vUV).x;\n\tgl_FragColor.xyz = vec3(1,1,1);\n\tgl_FragColor.w = smoothstep(0., _Feather, _Progress * (1. + _Feather) - mask);\n}\n"},803:function(t,e,n){"use strict";n.r(e),e.default="attribute vec3 aPos;\nattribute vec2 aUV0;\n\nuniform float _AspectRatio;\nuniform float _TextureAspectRatio;\n\nvarying vec2 vUV;\n\nvoid main(void) {\n\tvUV = aUV0;\n\n  float a = _AspectRatio / _TextureAspectRatio;\n  if(a < 1.){\n    vUV.x = (vUV.x - 0.5) * a + 0.5;\n  }else{\n    vUV.y = (vUV.y - 0.5) / a + 0.5;\n  }\n\n\tgl_Position = vec4(aPos, 1.0);\n}\n"},804:function(t,e,n){"use strict";n.r(e),e.default="precision mediump float;\n\n#extension GL_OES_standard_derivatives : enable\n\nvarying float vAlpha;\nvarying vec2 vUv;\n\nuniform float _Additive;\nuniform float _Softness;\n\nvoid main(void) {\n  float phase = (vUv.x + 1.) * 1.57;\n  float h = sin(phase);\n  float a = smoothstep(h,  h - abs(fwidth(vUv.y)) * _Softness, abs(vUv.y));\n  a *= vAlpha;\n\tgl_FragColor = vec4(1,1,1,1. - _Additive) * a;\n}\n"},805:function(t,e,n){"use strict";n.r(e),e.default="attribute vec4 aData0;\nattribute vec4 aData1;\n\n#define aUV aData0.xy\n#define aPos aData1.xyz\n#define aRandom0 aData0.z\n#define aRandom1 aData0.w\n#define aRandom2 aData1.w\n\nuniform mat4 _ViewProjection;\n\nuniform float _Opacity;\n\nuniform float _Spread;\nuniform float _Length;\nuniform float _Width;\n\nuniform vec3 _WindPos;\nuniform vec3 _CameraPos;\nuniform vec3 _CameraDir;\nuniform float _Amplitude;\nuniform float _Frequency;\nuniform float _Amount;\n\nvarying float vAlpha;\nvarying vec2 vUv;\n\n#define m3 mat3(-0.73736, 0.45628, 0.49808, 0, -0.73736, 0.67549, 0.67549, 0.49808, 0.54371)\n\nvec3 sineNoise(  in vec3 p )\n{\n    vec3 q = p;\n   \tvec3 c = vec3(0);\n    for(int i = 0; i <6; i++){\n        q = m3 * q;\n        vec3 s = sin(q.zxy);\n        q += s * 2.;\n        c += s;\n    }\n    return c * _Amplitude;\n}\n\nvec3 getPos(vec3 p)\n{\n   p += _WindPos;\n\treturn p;\n}\n\nvoid main(void) {\n\n\tvec3 p = getPos(aPos);\n\n\tvec3 center = _CameraPos - _CameraDir * _Spread;\n\tp = mod (p * _Spread - center, vec3(2.*_Spread)) - _Spread + center;\n\n  p += _CameraDir * (aUV.x * _Length);\n\n  p += sineNoise(p * _Frequency);\n\n  vec3 v = normalize(p - _CameraPos);\n  vec3 side = normalize(cross(_CameraDir, v));\n  p += side * (_Width * aUV.y);\n\n\tgl_Position = _ViewProjection * vec4(p, 1.);\n\n  vAlpha = _Opacity * smoothstep(_Amount + 0.1, _Amount, aRandom0 * 1.1);\n  //no surface\n  if(vAlpha < 0.001)gl_Position.xyz *= 0.;\n\n  vUv = aUV;\n }\n"},806:function(t,e,n){"use strict";n.r(e),e.default="precision mediump float;\n\nvarying vec2 vUV;\n\nuniform sampler2D _Source;\nuniform sampler2D _Noise;\nuniform float _Amount;\n\n#define ITERATIONS 8\n\nvoid main(void) {\n  vec2 center = vUV - 0.5;\n  vec3 c = vec3(0,0,0);\n  float l = texture2D(_Noise, gl_FragCoord.xy / 256.).x;\n  float inv = 1. / float(ITERATIONS);\n  float step = inv * _Amount;\n  l = 1. + l * step;\n  float sum = 0.;\n\n  for(int i = 0; i < ITERATIONS; i++){\n    float weight = smoothstep(0.6, 0., abs(float(i) / float(ITERATIONS) - 0.5));\n    l -= step;\n    c +=  texture2D(_Source, center * l + 0.5).xyz * weight;\n    sum += weight;\n  }\n  c *= 1. / sum;\n  //c *= inv;\n\n\tgl_FragColor.xyz = c;\n\t//gl_FragColor.xy = vUV;\n\n\tgl_FragColor.w = 1.;\n}\n"},807:function(t,e,n){"use strict";n.r(e),e.default="attribute vec3 aPos;\nattribute vec2 aUV0;\n\nvarying vec2 vUV;\n\nvoid main(void) {\n\tvUV = aUV0;\n\n\tgl_Position = vec4(aPos, 1.0);\n}\n"},830:function(t,e,n){var r={"./en-gb.json":[880,0],"./en-hk.json":[881,1],"./en-sg.json":[882,2],"./ko-kr.json":[883,3],"./zh-tw.json":[884,4]};function i(t){if(!n.o(r,t))return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=r[t],i=e[0];return n.e(e[1]).then((function(){return n.t(i,3)}))}i.keys=function(){return Object.keys(r)},i.id=830,t.exports=i},879:function(t,e,n){"use strict";n.r(e);n(626);var r=n(28),i=n(185),a=n.n(i),o=n(404),s=(n(627),n(7));s.default.sensibleDefaults=!1;var l={},u=n(628),c={name:"Icon",props:{name:s.default.string.isRequired},computed:{icon:function(){return u("./".concat(this.name,".svg"))}}},f=n(255),h=n(10);var d={Icon:Object(h.a)(c,(function(){var t=this.$createElement;return(this._self._c||t)("span",{class:[this.$style.icon],domProps:{innerHTML:this._s(this.icon)}})}),[],!1,(function(t){this.$style=f.default.locals||f.default}),null,null).exports},v=n(285),p="production",m="development",y="staging",g="local",_={LOCALE:"locale",API:"api"},E={LOCALE_ENABLED:"locale-enabled",LOCALE_ROUTING_ENABLED:"locale-routing-enabled",STATIC_ROOT:"static-root",PUBLIC_PATH:"public-path",VERSIONED_STATIC_ROOT:"versioned-static-root"},T={DEFAULT_LOCALE:"default-locale",AVAILABLE_LOCALES:"available-locales",PERSIST_QUERY_PARAMS:"persist-query-params"},A={},R=function(t,e){A[t]=e},b=function(t){return A[t]},w=function(){var t=b("configManager"),e=t.getProperty(T.AVAILABLE_LOCALES).map((function(t){return"string"===typeof t?{code:t,urlPrefix:t,translationKey:t}:t})),n={persistent:!1,defaultCode:t.getProperty(T.DEFAULT_LOCALE),languages:e};return{localeEnabled:t.getVariable(E.LOCALE_ENABLED),localeRoutingEnabled:t.getVariable(E.LOCALE_ROUTING_ENABLED),config:n}},S=n(12),x=n.n(S),k=n(16),M=n.n(k),C=n(14),I=n.n(C),P=n(6),D=n(11),O=n(1),N=n.n(O),L=n(2),F=n.n(L),B=n(3),U=n.n(B),V=n(4),z=n.n(V),G=n(0),H=n.n(G);function $(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var W=function(t){U()(n,t);var e=$(n);function n(){return N()(this,n),e.apply(this,arguments)}return F()(n,[{key:"setupTransitionInTimeline",value:function(t,e,n){t.add((function(){}),.01)}},{key:"setupTransitionOutTimeline",value:function(t,e,n){}},{key:"setupLoopingAnimationTimeline",value:function(t,e,n){}}]),n}(P.AbstractTransitionController),X=n(191);D.default.registerPlugin(X.a);var j={VinnieInOut:X.a.create("VinnieInOut","M0,0 C0.2,0 0,1 1,1"),InOutPause:X.a.create("InOutPause","M0,0,C0.094,0,0.322,0.518,0.544,0.518,0.796,0.518,0.838,1,1,1")};function Y(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var K=function(t){U()(n,t);var e=Y(n);function n(){return N()(this,n),e.apply(this,arguments)}return F()(n,[{key:"setupTransitionInTimeline",value:function(t,e,n){var r=e.$refs,i=r.evianLogo,a=r.title,o=r.subTitle,s=r.startCta,l=[];i&&l.push(i.$el),a&&l.push(a.$el),o&&l.push(o),s&&l.push(s.$el),t.fromTo(e.$el,{autoAlpha:0},{autoAlpha:1,duration:.5}),t.fromTo(l,{scale:0,autoAlpha:0},{scale:1,autoAlpha:1,duration:.5,stagger:.05,ease:j.VinnieInOut},">-0.3")}},{key:"setupTransitionOutTimeline",value:function(t,e,n){t.to(e.$el,{autoAlpha:0,duration:.5,ease:j.VinnieInOut})}},{key:"setupLoopingAnimationTimeline",value:function(t,e,n){}}]),n}(P.AbstractTransitionController);function q(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Z=function(t){U()(n,t);var e=q(n);function n(){return N()(this,n),e.apply(this,arguments)}return F()(n,[{key:"setupTransitionInTimeline",value:function(t,e,n){}},{key:"setupTransitionOutTimeline",value:function(t,e,n){}},{key:"setupLoopingAnimationTimeline",value:function(t,e,n){}}]),n}(P.AbstractTransitionController),Q=n(50);function J(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var tt,et=function(t){U()(n,t);var e=J(n);function n(){return N()(this,n),e.apply(this,arguments)}return F()(n,[{key:"setupTransitionInTimeline",value:function(t,e,n){}},{key:"setupTransitionOutTimeline",value:function(t,e,n){}},{key:"setupLoopingAnimationTimeline",value:function(t,e,n){}}]),n}(P.AbstractTransitionController),nt=n(42),rt=n.n(nt),it=n(65),at=n.n(it);!function(t){t[t.SEQUENCE=0]="SEQUENCE",t[t.IMAGE=1]="IMAGE",t[t.FILE=2]="FILE"}(tt||(tt={}));var ot=n(89),st=function(t,e,n){var r=t;return e&&(r=r.replace("{$versionRoot}",e)),r=r.replace("{deviceState}","number"===typeof n&&n<ot.a.MEDIUM?"-mobile":"")},lt=function(t,e,n){var r=st(t,e,n);return at.a.safari?r:r.replace(".jpg",".webp").replace(".png",".webp")};function ut(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ct(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ut(Object(n),!0).forEach((function(e){I()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ut(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ft={name:"ResponsiveImage",extends:P.AbstractTransitionComponent,props:{loadWebp:s.default.bool.def(!0),isContained:s.default.bool.def(!1),source:s.default.string.isRequired,alt:s.default.string},computed:ct(ct({},Object(Q.c)({deviceState:function(t){return t.app.deviceState}})),{},{getSource:function(){return this.source?lt(this.source,this.$staticRoot,this.deviceState,this.loadWebp):null}}),methods:{onLoad:function(){this.$emit("loaded")},onError:function(){this.$emit("loaded")},handleAllComponentsReady:function(){this.transitionController=new et(this),this.isReady()}}},ht=n(256);var dt=Object(h.a)(ft,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("picture",{class:[t.$style.responsiveImage,"abs-fill"]},[t.getSource?n("img",{class:[t.$style.imageElement,t.isContained&&t.$style.contain],attrs:{src:t.getSource,alt:t.alt},on:{load:t.onLoad,error:t.onError}}):t._e()])}),[],!1,(function(t){this.$style=ht.default.locals||ht.default}),null,null).exports,vt={name:"StartScreenLogo",components:{ResponsiveImage:dt},extends:P.AbstractTransitionComponent,methods:{handleAllComponentsReady:function(){this.transitionController=new Z(this),this.isReady()}}},pt=n(257);var mt=Object(h.a)(vt,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{class:[this.$style.startScreenLogo]},[e("div",{class:this.$style.imageWrapper},[e("ResponsiveImage",{attrs:{"is-contained":!0,source:this.$staticRoot+"image/start/image-01.png"}})],1)])}),[],!1,(function(t){this.$style=pt.default.locals||pt.default}),null,null).exports;function yt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var gt=function(t){U()(n,t);var e=yt(n);function n(){return N()(this,n),e.apply(this,arguments)}return F()(n,[{key:"setupTransitionInTimeline",value:function(t,e,n){}},{key:"setupTransitionOutTimeline",value:function(t,e,n){}},{key:"setupLoopingAnimationTimeline",value:function(t,e,n){}}]),n}(P.AbstractTransitionController),_t={name:"StartScreenTitle",extends:P.AbstractTransitionComponent,methods:{handleAllComponentsReady:function(){this.transitionController=new gt(this),this.isReady()}}},Et=n(258);var Tt,At=Object(h.a)(_t,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{class:[this.$style.startScreenTitle]},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 461.03 160"}},[e("path",{staticStyle:{fill:"#fff"},attrs:{d:"M186.36,25.2h10.5l1-19h10.37L208.42,0H177.81l-.55,6.23h10.38Zm35.42-9.82h11.36l.11,9.82h10.51L243,0H233l.08,8.94H221.87L222,0H211.89l-.68,25.19h10.52Zm57,9.82L278.28,19H260.35l-.22-3.9h14.95l-.48-5.78H259.8l-.2-3.42h17.2L276.28,0H249.2l1,25.19ZM124.54,82.12H143l4.64-35.63h17.75l1.15-11.37h-52l-2.14,11.35h17.82ZM187,65.54h8.87l8,16.58h20.7L213.7,63a18.4,18.4,0,0,0,6.85-5.68,13.24,13.24,0,0,0,2.54-7.89,13.07,13.07,0,0,0-2-7.09,14.19,14.19,0,0,0-6-5.21,22,22,0,0,0-9.92-2H171.84l-4.34,47H186Zm1.3-20.3h12.19a4.93,4.93,0,0,1,2.49.63,4.49,4.49,0,0,1,1.68,1.67A4.69,4.69,0,0,1,205.2,50a4.87,4.87,0,0,1-.42,2,4.92,4.92,0,0,1-1.17,1.65A5.06,5.06,0,0,1,200,55H187.67ZM258.65,83a42.55,42.55,0,0,0,15.25-2.4,17.81,17.81,0,0,0,9.12-7,17.45,17.45,0,0,0,2.28-11.24l-2.55-27.22h-17.1l1.76,27a8.21,8.21,0,0,1-.36,3.41,8.31,8.31,0,0,1-1.72,3Q263,71.06,258,71.06t-7.57-2.55a9.06,9.06,0,0,1-2.65-6.39l-.91-27h-17.1l.1,27.22a18.52,18.52,0,0,0,3.44,11.24,20.75,20.75,0,0,0,9.88,7A44.77,44.77,0,0,0,258.65,83Zm89.24-.89-2.24-11.92H314.47l-1-7.37h25.91l-1.94-10.76H312l-.88-6.3h29.46l-2-10.66h-46l5.17,47Zm-282.53,15a25,25,0,0,0-8.42-3.32A49.9,49.9,0,0,0,46.1,92.76a62.5,62.5,0,0,0-11.42,1,43.79,43.79,0,0,0-10.47,3.29,28.21,28.21,0,0,0-8.48,6,22.89,22.89,0,0,0-5.35,9.13,15.92,15.92,0,0,0-.8,7.86,10.33,10.33,0,0,0,2.85,5.52,17.91,17.91,0,0,0,5.4,3.66,41.66,41.66,0,0,0,6.88,2.35q3.67.92,7.14,1.59c2.31.46,4.36.94,6.19,1.45a13.24,13.24,0,0,1,4.19,1.86,2.59,2.59,0,0,1,1,1.3,2.53,2.53,0,0,1,0,1.63A4.58,4.58,0,0,1,42,141.49a6,6,0,0,1-2,1.33,12.82,12.82,0,0,1-2.57.75,18.2,18.2,0,0,1-2.76.3c-.93,0-1.81,0-2.63,0a26.61,26.61,0,0,1-5.77-.54,5.11,5.11,0,0,1-3.44-2.13c-.65-1.05-.68-2.56-.12-4.52.06-.19.12-.4.2-.63a2.85,2.85,0,0,1,.31-.72H1.9a3.65,3.65,0,0,0-.34.72c-.08.23-.13.41-.17.54Q-.8,143.41.46,148a12.34,12.34,0,0,0,5.33,7.18A27.25,27.25,0,0,0,16,158.87,76.82,76.82,0,0,0,29.63,160a55.08,55.08,0,0,0,17-2.54,32.65,32.65,0,0,0,13.2-7.89,27.61,27.61,0,0,0,7.23-13.7,15,15,0,0,0,.08-7.79,11.42,11.42,0,0,0-3.38-5.24,19.38,19.38,0,0,0-5.65-3.41,41.61,41.61,0,0,0-6.91-2.07c-2.44-.53-4.79-1-7-1.43s-4.27-.89-6-1.38a11,11,0,0,1-4-1.82,2.51,2.51,0,0,1-.89-1.26,2.42,2.42,0,0,1,0-1.55,4,4,0,0,1,1.6-2,9.35,9.35,0,0,1,3.39-1.48,21.05,21.05,0,0,1,5.07-.53,10.26,10.26,0,0,1,4.79.89,4.25,4.25,0,0,1,2.16,2.33,5.11,5.11,0,0,1,.08,3.07l-.09.37H70.61l.26-1.09a14.07,14.07,0,0,0-.46-8.5A12.72,12.72,0,0,0,65.36,97.15Zm70.91-1q-7.47-3.45-18.71-3.44A52.8,52.8,0,0,0,97.78,96.2a35.44,35.44,0,0,0-14.43,10.46q-5.84,7.09-8.28,18.07c-1.63,7.34-1.6,13.8.31,19a21.41,21.41,0,0,0,10.69,12.1Q94,160,106.32,160A53.37,53.37,0,0,0,128,155.86a34.52,34.52,0,0,0,14.74-12.1,40.89,40.89,0,0,0,6.67-19c.84-7.43.07-13.34-2.24-18.07A22,22,0,0,0,136.27,96.2Zm-9,25.54-.88,6a21.53,21.53,0,0,1-1.81,6.18,15.32,15.32,0,0,1-8.74,8.12,18.5,18.5,0,0,1-6.71,1.14,15.71,15.71,0,0,1-6.32-1.14,9.44,9.44,0,0,1-4.09-3.19A10.85,10.85,0,0,1,96.87,134a19.72,19.72,0,0,1,.25-6.18l1.13-6a22.38,22.38,0,0,1,2-6,16,16,0,0,1,3.51-4.61,15.14,15.14,0,0,1,5-2.93,18.71,18.71,0,0,1,6.38-1,15.89,15.89,0,0,1,6,1,9.5,9.5,0,0,1,6.07,7.54,18.34,18.34,0,0,1,0,6Zm77.19,9.08a13.21,13.21,0,0,1-3.41,8.87q-3.27,3.56-9.53,3.56t-9.14-3.56a12.23,12.23,0,0,1-2.47-8.83l2.51-37H161.28l-3.73,37.32q-.92,9.21,2.66,15.66a23.08,23.08,0,0,0,11.37,9.83c5.19,2.24,11.59,3.37,19.16,3.37s14.09-1.13,19.5-3.37a26.26,26.26,0,0,0,12.32-9.87q4.2-6.44,4.19-15.66V93.78h-21.1Zm97.74-6.69a18.4,18.4,0,0,0,1.9-10.88,21.52,21.52,0,0,0-3.63-9.7,21.79,21.79,0,0,0-8.23-7.1,27.08,27.08,0,0,0-12.55-2.67H238.43l1.14,65H262.8l-1.15-23.21h11.08l12.56,23.21h26.06L294.55,132a19.76,19.76,0,0,0,7.64-7.85Zm-21.61-5a5.19,5.19,0,0,1-1.9,1.44,5.48,5.48,0,0,1-2.33.46H260.92l-.67-13.43h15.1a6.1,6.1,0,0,1,3.2.86,6.81,6.81,0,0,1,2.33,2.29,7.45,7.45,0,0,1,1.06,3.37,6.5,6.5,0,0,1-1.36,5Zm80.19,11.82a12.73,12.73,0,0,1-.22,6.54,7.59,7.59,0,0,1-3.59,4.28,17.15,17.15,0,0,1-15-.5,14.44,14.44,0,0,1-5.12-5.49,24,24,0,0,1-2.62-8l-.94-6a20.14,20.14,0,0,1,.09-7.66,8.27,8.27,0,0,1,3.26-5.08c1.66-1.2,4-1.79,7.07-1.79a14.83,14.83,0,0,1,6.75,1.43,12.85,12.85,0,0,1,4.74,4.07,15.91,15.91,0,0,1,2.59,6.33h21A31.16,31.16,0,0,0,358.5,95.64a48.68,48.68,0,0,0-17.24-2.88c-11.17,0-19.31,2.57-24.37,7.8s-7.12,13.29-5.78,24.17a44,44,0,0,0,6.5,19,33.16,33.16,0,0,0,14.12,12.1q9,4.14,21.29,4.14,11.06,0,18.15-3.47a18.77,18.77,0,0,0,9.65-10c1.74-4.32,1.91-9.53.56-15.6ZM455.6,142H416.49l-2.76-10.25H446.1l-4.71-14.86H409.71l-2.33-8.64h36.55l-4.7-14.49H382.35l15.42,65H461Z"}})])])}),[],!1,(function(t){this.$style=Et.default.locals||Et.default}),null,null).exports,Rt={INTERNAL:"link-type-internal",EXTERNAL:"link-type-external",EXTERNAL_BLANK:"link-type-external-blank",DOWNLOAD:"link-type-download"};!function(t){t[t.XSMALL=0]="XSMALL",t[t.SMALL=1]="SMALL",t[t.MEDIUM=2]="MEDIUM",t[t.LARGE=3]="LARGE",t[t.XLARGE=4]="XLARGE"}(Tt||(Tt={}));var bt,wt=Tt,St={ACTION:"button-type-action",LINK:"button-type-link",SHARE:"button-type-share",SUBMIT:"button-type-submit"},xt={ID:"id",SLUG:"slug"};!function(t){t.PRIMARY="primary",t.SECONDARY="secondary"}(bt||(bt={}));var kt=bt,Mt={name:"AbstractButtonComponent",extends:P.AbstractScrollComponent,props:{isActive:s.default.bool.def(!1),disabled:s.default.bool,theme:s.default.oneOf(Object.values(kt)).def(kt.PRIMARY),invalid:s.default.bool,tracking:s.default.shape({name:s.default.string,variable:s.default.any}).def({}),size:s.default.oneOf([wt.SMALL,wt.MEDIUM,wt.LARGE,wt.XLARGE]).def(wt.MEDIUM),icon:s.default.string,label:s.default.string,title:s.default.string,type:s.default.oneOf(Object.values(St)).isRequired,link:s.default.shape({type:s.default.oneOf(Object.values(Rt)).isRequired,target:s.default.any.isRequired}),tabindex:s.default.string},computed:{buttonSize:function(){return"is-".concat(wt[this.size].toLowerCase())},target:function(){var t=this,e=this.link.target;if(this.link.type===Rt.INTERNAL){var n=rt()(ws).reduce((function(t,e){return e.children&&e.children.forEach((function(e){return t.push(e)})),t.push(e),t}),[]).find((function(e){return e.name===t.link.target.name}));e=n.path,this.link.target.params&&Object.keys(xt).forEach((function(n){e=e.replace(":".concat(xt[n]),t.link.target.params[xt[n]])}))}return e}},methods:{onClick:function(){},handleClick:function(t){switch(this.onClick(),this.$emit("click"),this.type){case St.LINK:switch(this.link.type){case Rt.DOWNLOAD:at.a.ios&&(t.preventDefault(),this.openExternalLink(!0));break;case Rt.EXTERNAL:t.preventDefault(),this.openExternalLink();break;case Rt.EXTERNAL_BLANK:t.preventDefault(),this.openExternalLink(!0);break;case Rt.INTERNAL:default:t.preventDefault(),this.openInternalLink()}break;case St.ACTION:t&&t.preventDefault()}},openInternalLink:function(){this.$router.push(this.link.target)},openExternalLink:function(t){t?window.open(this.link.target):window.location.href=this.link.target}}};function Ct(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var It=function(t){U()(n,t);var e=Ct(n);function n(){return N()(this,n),e.apply(this,arguments)}return F()(n,[{key:"setupTransitionInTimeline",value:function(t,e,n){}},{key:"setupTransitionOutTimeline",value:function(t,e,n){}},{key:"setupLoopingAnimationTimeline",value:function(t,e,n){}}]),n}(P.AbstractTransitionController),Pt={name:"PrimaryButton",extends:Mt,props:{ariaLabel:s.default.string},methods:{handleAllComponentsReady:function(){this.transitionController=new It(this),this.isReady()}}},Dt=n(259);var Ot=Object(h.a)(Pt,(function(){var t,e,n=this,r=n.$createElement,i=n._self._c||r;return n.type===n.ButtonType.LINK?i("a",{ref:"button",class:[n.$style.primaryButton,"button",n.$style[n.theme],(t={},t["is-disabled"]=n.disabled,t)],attrs:{href:n.target,disabled:"",title:n.title||n.label||"","aria-label":n.ariaLabel||n.title||""},on:{click:n.handleClick}},[i("div",{ref:"background",class:[n.$style.background]}),n._v(" "),i("span",{class:["copy-05",n.$style.label],domProps:{innerHTML:n._s(n.label)}})]):i("button",{ref:"button",class:[n.$style.primaryButton,"button",n.$style[n.theme],(e={},e["is-disabled"]=n.disabled,e)],attrs:{title:n.title||n.label||"","aria-label":n.ariaLabel||n.title||"",type:n.type===n.ButtonType.SUBMIT?"submit":"button"},on:{click:n.handleClick}},[i("div",{ref:"background",class:[n.$style.background]}),n._v(" "),i("span",{class:["copy-05",n.$style.label],domProps:{innerHTML:n._s(n.label)}})])}),[],!1,(function(t){this.$style=Dt.default.locals||Dt.default}),null,null).exports,Nt=Ot,Lt={AMBIENT_INTRO:"ambient/intro",AMBIENT_FIRST_LEVEL:"ambient/first_level",AMBIENT_SECOND_LEVEL:"ambient/second_level",AMBIENT_THIRD_LEVEL:"ambient/third_level",MUSIC_FIRST_LEVEL:"music/first_level",MUSIC_SECOND_LEVEL:"music/second_level",MUSIC_THIRD_LEVEL:"music/third_level",UI_SELECT_NEXT:"sfx/select_next",UI_SELECT_START_01:"sfx/select_start_01",UI_SELECT_START_02:"sfx/select_start_02",SFX_BLUE_ITEM_01:"sfx/blue_item_01",SFX_BLUE_ITEM_02:"sfx/blue_item_02",SFX_BLUE_ITEM_03:"sfx/blue_item_03",SFX_RED_ITEM:"sfx/red_item",SFX_SWITCHING_LINES_01:"sfx/switching_lanes_01",SFX_SWITCHING_LINES_02:"sfx/switching_lanes_02",SFX_SWITCHING_LINES_03:"sfx/switching_lanes_03",SFX_TRANSITION_FREEZE:"sfx/transition_freeze",SFX_TRANSITION_UNFREEZE:"sfx/transition_unfreeze"},Ft=Object.values(Lt).map((function(t){return{name:t,extension:t===Lt.MUSIC_THIRD_LEVEL?"wav":void 0}})),Bt={SFX:"sfx",AMBIENT:"ambient",MUSIC:"music"},Ut={name:"StartScreen",components:{StartScreenLogo:mt,StartScreenTitle:At,PrimaryButton:Nt},extends:P.AbstractTransitionComponent,methods:{onStartButtonClick:function(){this.$sound.play(Lt.UI_SELECT_START_01,Bt.SFX,1,1e-4),this.$emit("onStartButtonClick")},handleAllComponentsReady:function(){this.transitionController=new K(this),this.isReady()}}},Vt=n(260);var zt=Object(h.a)(Ut,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:["grid-row",t.$style.startScreen]},[n("div",{class:t.$style.overlayBackground}),t._v(" "),n("div",{class:t.$style.overlayGradient}),t._v(" "),n("StartScreenLogo",{ref:"evianLogo",class:["grid-col-8 grid-col-md-12",t.$style.logo]}),t._v(" "),n("StartScreenTitle",{ref:"title",class:["grid-col-8 grid-col-md-12",t.$style.title]}),t._v(" "),n("div",{ref:"subTitle",class:["grid-col-8 grid-col-md-12 copy-01",t.$style.subTitle]},[n("span",{domProps:{innerHTML:t._s(t.$t("startScreen.subTitle"))}})]),t._v(" "),n("div",{class:["grid-col-8 grid-col-md-12",t.$style.ctaWrapper]},[n("PrimaryButton",{ref:"startCta",class:t.$style.cta,attrs:{type:t.ButtonType.ACTION,label:t.$t("startScreen.cta.label"),"aria-label":t.$t("startScreen.cta.ariaLabel")},on:{click:t.onStartButtonClick}})],1)],1)}),[],!1,(function(t){this.$style=Vt.default.locals||Vt.default}),null,null).exports;function Gt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Ht=function(t){U()(n,t);var e=Gt(n);function n(){return N()(this,n),e.apply(this,arguments)}return F()(n,[{key:"setupTransitionInTimeline",value:function(t,e,n){var r=e.$refs,i=r.evianLogo,a=r.carousel,o=r.carouselPagination,s=r.cta,l=[];i&&l.push(i.$el),a&&l.push(a.$el),o&&l.push(o.$el),s&&l.push(s.$el),t.fromTo(e.$el,{scale:0,autoAlpha:0},{scale:1,autoAlpha:1,duration:.5,ease:j.VinnieInOut}).fromTo(l,{scale:0,autoAlpha:0},{scale:1,autoAlpha:1,duration:.5,stagger:.1,ease:j.VinnieInOut},.05)}},{key:"setupTransitionOutTimeline",value:function(t,e,n){t.to(e.$el,{autoAlpha:0,duration:.2})}},{key:"setupLoopingAnimationTimeline",value:function(t,e,n){}}]),n}(P.AbstractTransitionController),$t=n(186),Wt=n.n($t),Xt=n(406),jt=n.n(Xt),Yt=n(119),Kt=n(190),qt=n(99),Zt=n(66);function Qt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Jt=function(t){U()(n,t);var e=Qt(n);function n(){return N()(this,n),e.apply(this,arguments)}return F()(n,[{key:"setupTransitionInTimeline",value:function(t,e,n){}},{key:"setupTransitionOutTimeline",value:function(t,e,n){}},{key:"setupLoopingAnimationTimeline",value:function(t,e,n){}}]),n}(P.AbstractTransitionController);function te(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var ee=function(t){U()(n,t);var e=te(n);function n(){return N()(this,n),e.apply(this,arguments)}return F()(n,[{key:"setupTransitionInTimeline",value:function(t,e,n){}},{key:"setupTransitionOutTimeline",value:function(t,e,n){}},{key:"setupLoopingAnimationTimeline",value:function(t,e,n){}}]),n}(P.AbstractTransitionController);function ne(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function re(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ne(Object(n),!0).forEach((function(e){I()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ie={name:"OnboardingCarouselCard",components:{ResponsiveImage:dt},extends:P.AbstractTransitionComponent,props:{card:s.default.shape({title:s.default.string.isRequired,copy:s.default.string,mobileCopy:s.default.string,imagesHaveSmallerMargin:s.default.bool,images:s.default.shape({mobile:s.default.arrayOf(s.default.shape({src:s.default.string.isRequired,width:s.default.string.isRequired,isSvg:s.default.bool,isRotated:s.default.bool,glowColor:s.default.string,eyebrow:s.default.string})),normal:s.default.arrayOf(s.default.shape({src:s.default.string.isRequired,width:s.default.string.isRequired,isSvg:s.default.bool,isRotated:s.default.bool,glowColor:s.default.string,eyebrow:s.default.string}))})})},computed:re(re({},Object(Q.c)({deviceState:function(t){return t.app.deviceState}})),{},{getImages:function(){if(this.card.images)return this.deviceState<this.DeviceState.MEDIUM&&this.card.images.mobile?this.card.images.mobile:this.card.images.normal}}),methods:{handleAllComponentsReady:function(){this.transitionController=new ee(this),this.isReady()}}},ae=n(261);var oe=Object(h.a)(ie,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:[t.$style.onboardingCarouselCard]},[n("h2",{class:["heading-04-new",t.$style.title],domProps:{innerHTML:t._s(t.$t(""+t.card.title))}}),t._v(" "),t.card.copy?n("span",{class:["copy-01-new",t.$style.copy],domProps:{innerHTML:t._s(t.$t(""+(t.deviceState<t.DeviceState.MEDIUM&&t.card.mobileCopy?t.card.mobileCopy:t.card.copy)))}}):t._e(),t._v(" "),t.getImages?n("div",{class:t.$style.imagesWrapper},t._l(t.getImages,(function(e,r){var i=e.src,a=e.width,o=e.isRotated,s=e.isSvg,l=e.glowColor,u=e.eyebrow;return n("div",{key:r,class:[t.$style.image,t.$style["width-"+a],t.card.imagesHaveSmallerMargin&&t.$style.hasSmallerMargin,o&&t.$style.isRotated,s&&t.$style.isSvg]},[l?n("div",{class:[t.$style.imageBackgroundWrapper,t.$style[l+"-glow"]]},[n("div"),t._v(" "),n("div"),t._v(" "),n("div")]):t._e(),t._v(" "),s?n("Icon",{class:["abs-fill",t.$style.svg],attrs:{name:i}}):n("ResponsiveImage",{attrs:{"is-contained":!0,source:t.$staticRoot+"image/onboarding/"+i+".png"}}),t._v(" "),u?n("div",{class:["heading-05-new",t.$style.eyebrow]},[n("span",{domProps:{innerHTML:t._s(u)}})]):t._e()],1)})),0):t._e()])}),[],!1,(function(t){this.$style=ae.default.locals||ae.default}),null,null).exports;D.default.registerPlugin(Kt.a,Yt.a);var se={name:"OnboardingCarousel",components:{OnboardingCarouselCard:oe},extends:P.AbstractTransitionComponent,props:{activeIndex:s.default.number.isRequired,cards:s.default.arrayOf(s.default.shape({title:s.default.string.isRequired,copy:s.default.string,mobileCopy:s.default.string,imagesHaveSmallerMargin:s.default.bool,images:s.default.shape({mobile:s.default.arrayOf(s.default.shape({src:s.default.string.isRequired,width:s.default.string.isRequired,isSvg:s.default.bool,isRotated:s.default.bool,glowColor:s.default.string,eyebrow:s.default.string})),normal:s.default.arrayOf(s.default.shape({src:s.default.string.isRequired,width:s.default.string.isRequired,isSvg:s.default.bool,isRotated:s.default.bool,glowColor:s.default.string,eyebrow:s.default.string}))})})).isRequired},data:function(){return{currentActiveIndex:0}},watch:{activeIndex:function(t){t!==this.currentActiveIndex&&this.transitionCarousel(t)}},mounted:function(){this.setupCarousel()},beforeDestroy:function(){this.disposables&&this.disposables.dispose()},methods:{handleAllComponentsReady:function(){var t=this;this.transitionController=new Jt(this),this.disposables=new qt.DisposableManager,this.disposables.add(Object(Zt.addEventListener)(window,"resize",jt()((function(){return t.onWindowResize()}),100))),this.isReady()},setupCarousel:function(){var t=this;this.itemWidth=this.$refs.items[0].$el.offsetWidth,this.carouselWidth=this.itemWidth*this.$refs.items.length;var e=Yt.a.create(this.$refs.dragSlider,{dragClickables:!0,allowContextMenu:!0,type:"x",throwProps:!0,throwResistance:0,dragResistance:0,edgeResistance:.85,zIndexBoost:!1,bounds:{minX:-(this.carouselWidth-this.itemWidth),maxX:0},snap:{x:function(e){var n=Math.max(t.draggable.minX,Math.min(t.draggable.maxX,e)),r=Math.round(n/t.itemWidth),i=t.currentActiveIndex-Math.abs(r),a=t.currentActiveIndex+1*(i<0)+-1*(i>0);return t.handleDrag(a),a*-t.itemWidth}},onDragStart:function(){t.timeline&&t.timeline.kill()}}),n=Wt()(e,1);this.draggable=n[0]},transitionCarousel:function(t){this.timeline&&this.timeline.kill();var e=t*-this.$refs.items[0].$el.offsetWidth;this.currentActiveIndex=t,this.timeline=D.default.timeline().to(this.$refs.dragSlider,{x:e,ease:j.VinnieInOut})},handleDrag:function(t){Math.abs(t)!==this.currentActiveIndex&&(this.currentActiveIndex=Math.abs(t),this.$emit("activeIndexChange",this.currentActiveIndex))},onWindowResize:function(){this.itemWidth=this.$refs.items[0].$el.offsetWidth,this.carouselWidth=this.itemWidth*this.$refs.items.length,this.draggable.applyBounds({minX:-(this.carouselWidth-this.itemWidth),maxX:0}),D.default.set(this.$refs.dragSlider,{x:-this.itemWidth*this.currentActiveIndex})}}},le=n(262);var ue=Object(h.a)(se,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{ref:"dragSlider",class:[this.$style.onboardingCarousel]},this._l(this.cards,(function(t,n){return e("OnboardingCarouselCard",{key:n,ref:"items",refInFor:!0,attrs:{card:t}})})),1)}),[],!1,(function(t){this.$style=le.default.locals||le.default}),null,null).exports;function ce(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var fe=function(t){U()(n,t);var e=ce(n);function n(){return N()(this,n),e.apply(this,arguments)}return F()(n,[{key:"setupTransitionInTimeline",value:function(t,e,n){}},{key:"setupTransitionOutTimeline",value:function(t,e,n){}},{key:"setupLoopingAnimationTimeline",value:function(t,e,n){}}]),n}(P.AbstractTransitionController),he={name:"OnboardingCarouselPagination",extends:P.AbstractTransitionComponent,props:{activeIndex:s.default.number.isRequired,paginationLength:s.default.number.isRequired},methods:{handleAllComponentsReady:function(){this.transitionController=new fe(this),this.isReady()}}},de=n(263);var ve,pe=Object(h.a)(he,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:[t.$style.onboardingCarouselPagination]},t._l(t.paginationLength,(function(e,r){return n("button",{key:r,class:["button",t.$style.paginationButton],on:{click:function(e){return t.$emit("activeIndexChange",r)}}},[n("span",{class:[t.$style.paginationDot,r===t.activeIndex&&t.$style.isActive]})])})),0)}),[],!1,(function(t){this.$style=de.default.locals||de.default}),null,null).exports;!function(t){t.BLUE="blue",t.RED="red"}(ve||(ve={}));var me=ve,ye=[{title:"onboardingScreen.cardFive.title",copy:"onboardingScreen.cardFive.copy"},{title:"onboardingScreen.cardOne.title",copy:"onboardingScreen.cardOne.copy",images:{normal:[{src:"drop",width:"01",glowColor:me.BLUE,eyebrow:"+5"}]}},{title:"onboardingScreen.cardTwo.title",copy:"onboardingScreen.cardTwo.copy",images:{normal:[{src:"drop",width:"01",glowColor:me.BLUE},{src:"crystal",width:"02",glowColor:me.BLUE}]}},{title:"onboardingScreen.cardThree.title",copy:"onboardingScreen.cardThree.copy",imagesHaveSmallerMargin:!0,images:{normal:[{src:"leaves",width:"03",glowColor:me.RED},{src:"gravel-patches",width:"04",glowColor:me.RED},{src:"ground-shrubs",width:"05",glowColor:me.RED}]}},{title:"onboardingScreen.cardFour.title",copy:"onboardingScreen.cardFour.copy",mobileCopy:"onboardingScreen.cardFour.mobileCopy",images:{mobile:[{src:"pointing-arrows",width:"07",isSvg:!0,isRotated:!0},{src:"pointing-hand",width:"08",isSvg:!0},{src:"pointing-arrows",width:"07",isSvg:!0}],normal:[{src:"keyboard-arrow",width:"06",isSvg:!0},{src:"keyboard-arrow",width:"06",isSvg:!0,isRotated:!0}]}}],ge={name:"OnboardingScreen",components:{OnboardingCarousel:ue,OnboardingCarouselCard:oe,OnboardingCarouselPagination:pe,PrimaryButton:Nt,StartScreenLogo:mt,ResponsiveImage:dt},extends:P.AbstractTransitionComponent,data:function(){return{onboardingCarouselCards:ye,activeIndex:0,cardsCount:5}},computed:{ctaLabel:function(){return this.activeIndex<this.cardsCount-1?this.$t("onboardingScreen.cta.labelOne"):this.$t("onboardingScreen.cta.labelTwo")},ctaAriaLabel:function(){return this.activeIndex<this.cardsCount-1?this.$t("onboardingScreen.cta.ariaLabelOne"):this.$t("onboardingScreen.cta.ariaLabelTwo")}},methods:{handleAllComponentsReady:function(){this.transitionController=new Ht(this),this.isReady()},onActiveIndexChange:function(t){this.activeIndex=t},onCtaClick:function(){this.activeIndex<this.cardsCount-1?(this.$sound.play(Lt.UI_SELECT_NEXT,Bt.SFX,1,1e-4),this.activeIndex+=1):(this.$sound.play(Lt.UI_SELECT_START_02,Bt.SFX,1,1e-4),this.$emit("onStartButtonClick"))}}},_e=n(264);var Ee=Object(h.a)(ge,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:["grid-row",t.$style.onboardingScreen]},[n("StartScreenLogo",{ref:"evianLogo",class:[t.$style.logo]}),t._v(" "),n("div",{class:["grid-col-8 grid-col-md-12",t.$style.spacer]}),t._v(" "),n("div",{class:["grid-col-8 grid-col-md-12",t.$style.carouselContainer]},[n("div",{class:t.$style.carouselWrapperTwo},[n("div",{class:t.$style.carouselWrapperOne},[n("div",{class:t.$style.background},[n("ResponsiveImage",{attrs:{"is-contained":!0,source:t.$staticRoot+"image/onboarding/card-background{deviceState}.png"}})],1),t._v(" "),n("OnboardingCarousel",{ref:"carousel",attrs:{"active-index":t.activeIndex,cards:t.onboardingCarouselCards},on:{activeIndexChange:t.onActiveIndexChange}}),t._v(" "),n("OnboardingCarouselPagination",{ref:"carouselPagination",attrs:{"active-index":t.activeIndex,"pagination-length":t.onboardingCarouselCards.length},on:{activeIndexChange:t.onActiveIndexChange}})],1)])]),t._v(" "),n("div",{class:["grid-col-6 grid-col-md-12",t.$style.ctaWrapper]},[n("PrimaryButton",{ref:"cta",class:t.$style.cta,attrs:{type:t.ButtonType.ACTION,label:t.ctaLabel,"aria-label":t.ctaAriaLabel},on:{click:t.onCtaClick}})],1)],1)}),[],!1,(function(t){this.$style=_e.default.locals||_e.default}),null,null).exports,Te=n(152);function Ae(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Re=function(t){U()(n,t);var e=Ae(n);function n(t,r,i,a,o){var s;return N()(this,n),(s=e.call(this,t,i,a,o)).data=r,s}return F()(n,[{key:"clone",value:function(){return new n(this.type,this.data,this.bubbles,this.cancelable)}}]),n}(n.n(Te).a);Re.ANIMATION_EVENT="WebGLEvent.ANIMATION_EVENT",Re.ANIMATION_END="WebGLEvent.ANIMATION_END",Re.ANIMATION_READY="WebGLEvent.ANIMATION_READY",Re.OBSTACLE_HIT="WebGLEvent.OBSTACLE_HIT",Re.COLLECTABLE_HIT="WebGLEvent.COLLECTABLE_HIT",Re.LANE_CHANGE="WebGLEvent.LANE_CHANGE";var be=n(9),we=n.n(be),Se=function(){function t(){N()(this,t)}return F()(t,null,[{key:"log",value:function(){if(t.ENABLED){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];console.log(n)}}},{key:"error",value:function(){if(t.ENABLED){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];console.error(n),console.trace()}}},{key:"getScreenLogDiv",value:function(){return t._screenLogDiv||(t._screenLogDiv=t.createDebugDiv()),t._screenLogDiv}},{key:"logToScreen",value:function(e){t.ENABLED&&(t._screenLogDiv||(t._screenLogDiv=t.createDebugDiv()),t._screenLogDiv.innerHTML=e)}},{key:"logAppendToScreen",value:function(e){t.ENABLED&&(t._screenLogDiv||(t._screenLogDiv=t.createDebugDiv()),t._screenLogDiv.innerHTML+=e)}},{key:"logArray",value:function(e){if(t.ENABLED){for(var n=e.length,r="",i=0;i<n;i++)r+=e[i],r+=",";r=r.substring(0,r.length-1),console.log(r)}}},{key:"log2dArray",value:function(e){if(t.ENABLED){for(var n=e.length,r="",i=0;i<n;i++)for(var a=0;a<e[i].length;a++)r+=e[i][a],r+=",";r=r.substring(0,r.length-1),console.log(r)}}},{key:"createDebugDiv",value:function(){var t=document.createElement("div");return document.body.appendChild(t),t.style.position="absolute",t.style.left="160px",t.style.top="0px",t.style.color="#fff",t.style.backgroundColor="#000",t.style.display="block",t.style.width="158px",t.style.height="94px",t.style.padding="1px",t.style.font="10px Helvetica,Arial,sans-serif",t.style.lineHeight="14px",t.style.zIndex="1000",t}}]),t}();Se.ENABLED=!0;var xe=function(){function t(){N()(this,t),this.isDestructed=!1}return F()(t,[{key:"destruct",value:function(){this.isDestructed&&Se.error("Cannot destruct twice"),this.isDestructed=!0}}]),t}();function ke(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Me=function(t){U()(n,t);var e=ke(n);function n(t,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return N()(this,n),(i=e.call(this)).exposed=!1,i.name=r,i.id=n._id++,i.parent=t,i._callback=o,i._materials=a||[],i}return F()(n,[{key:"expose",value:function(){this.exposed=!0}},{key:"setUpdateUICallback",value:function(t){this._updateUIcallback=t}},{key:"setChangeCallback",value:function(t){this._callback=t}},{key:"setValue",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t!==this._value&&(this._value=t,this.setShaderUniform(t),this._callback&&n&&this._callback(this._value),!e&&this._updateUIcallback&&this._updateUIcallback.call(this,this.value))}},{key:"setFromUI",value:function(t){this.setValue(t,!0)}},{key:"setShaderUniform",value:function(t){}},{key:"value",get:function(){return this._value}}]),n}(xe);function Ce(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}Me._id=0;var Ie=function(t){U()(n,t);var e=Ce(n);function n(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return N()(this,n),e.call(this,t,r,null,i)}return F()(n,[{key:"value",get:function(){return this._callback}}]),n}(Me);function Pe(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var De=function(t){U()(n,t);var e=Pe(n);function n(t,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return N()(this,n),(a=e.call(this,t,r,o,s)).setValue(i,!1,!1),a}return F()(n,[{key:"setShaderUniform",value:function(t){for(var e=0;e<this._materials.length;e++)this._materials[e].setFloat(this.name,!0===t?1:0)}}]),n}(Me),Oe=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;N()(this,t),this.x=e,this.y=n,this.z=r}return F()(t,[{key:"clone",value:function(){return new t(this.x,this.y,this.z)}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}},{key:"setValues",value:function(t,e,n){return this.x=t,this.y=e,this.z=n,this}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.z+")"}},{key:"equals",value:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}},{key:"normalize",value:function(){var t=this.x*this.x+this.y*this.y+this.z*this.z;return t>0&&(t=1/Math.sqrt(t)),this.x*=t,this.y*=t,this.z*=t,this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}},{key:"multiplyScalar",value:function(t){return this.x*=t,this.y*=t,this.z*=t,this}},{key:"multiply",value:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}},{key:"divide",value:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}},{key:"add",value:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}},{key:"subtract",value:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}},{key:"rotateX",value:function(t,e){var n=this.y-t.y,r=this.z-t.z;return this.y=n*Math.cos(e)-r*Math.sin(e)+t.y,this.z=n*Math.sin(e)+r*Math.cos(e)+t.z,this}},{key:"rotateY",value:function(t,e){var n=this.x-t.x,r=this.z-t.z;return this.x=r*Math.cos(e)-n*Math.sin(e)+t.x,this.z=r*Math.sin(e)+n*Math.cos(e)+t.z,this}},{key:"rotateZ",value:function(t,e){var n=this.x-t.x,r=this.y-t.y;return this.x=n*Math.cos(e)-r*Math.sin(e)+t.x,this.y=n*Math.sin(e)+r*Math.cos(e)+t.y,this}},{key:"transform",value:function(t){var e=this.x,n=this.y,r=this.z,i=t.m,a=i[3]*e+i[7]*n+i[11]*r+i[15];return a=a||1,this.x=(i[0]*e+i[4]*n+i[8]*r+i[12])/a,this.y=(i[1]*e+i[5]*n+i[9]*r+i[13])/a,this.z=(i[2]*e+i[6]*n+i[10]*r+i[14])/a,this}},{key:"transformMat3",value:function(t){var e=this.x,n=this.y,r=this.z,i=t.m;return this.x=e*i[0]+n*i[3]+r*i[6],this.y=e*i[1]+n*i[4]+r*i[7],this.z=e*i[2]+n*i[5]+r*i[8],this}},{key:"transformQuat",value:function(t){var e=t.x,n=t.y,r=t.z,i=t.w,a=this.x,o=this.y,s=this.z,l=n*s-r*o,u=r*a-e*s,c=e*o-n*a,f=n*c-r*u,h=r*l-e*c,d=e*u-n*l,v=2*i;return l*=v,u*=v,c*=v,f*=2,h*=2,d*=2,this.x=a+l+f,this.y=o+u+h,this.z=s+c+d,this}},{key:"randomize",value:function(){return this.x=2*Math.random()-1,this.y=2*Math.random()-1,this.z=2*Math.random()-1,this}},{key:"randomize01",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}},{key:"randomizeSphere",value:function(){do{this.randomize()}while(this.length()>1);return this}},{key:"smoothstep",value:function(){return this.x=t.smoothstep1(this.x),this.y=t.smoothstep1(this.y),this.z=t.smoothstep1(this.z),this}},{key:"min",value:function(t){this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z)}},{key:"max",value:function(t){this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z)}}],[{key:"smoothstep1",value:function(t){return t*t*(3-2*t)}},{key:"dot",value:function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}},{key:"distance",value:function(t,e){var n=t.x-e.x,r=t.y-e.y,i=t.z-e.z;return Math.sqrt(n*n+r*r+i*i)}},{key:"multiplyScalar",value:function(e,n){return new t(e.x*n,e.y*n,e.z*n)}},{key:"cross",value:function(e,n){var r=e.x,i=e.y,a=e.z,o=n.x,s=n.y,l=n.z;return new t(i*l-a*s,a*o-r*l,r*s-i*o)}},{key:"add",value:function(e,n){return new t(e.x+n.x,e.y+n.y,e.z+n.z)}},{key:"subtract",value:function(e,n){return new t(e.x-n.x,e.y-n.y,e.z-n.z)}},{key:"lerp",value:function(e,n,r){var i=e.x,a=e.y,o=e.z;return new t(i+r*(n.x-i),a+r*(n.y-a),o+r*(n.z-o))}},{key:"fract",value:function(e){return new t(e.x-Math.floor(e.x),e.y-Math.floor(e.y),e.z-Math.floor(e.z))}},{key:"floor",value:function(e){return new t(Math.floor(e.x),Math.floor(e.y),Math.floor(e.z))}},{key:"transform",value:function(t,e){return t.clone().transform(e)}},{key:"transformMat3",value:function(t,e){return t.clone().transformMat3(e)}},{key:"bezier",value:function(e,n,r,i,a){var o=1-a,s=o*o,l=a*a,u=s*o,c=3*a*s,f=3*l*o,h=l*a,d=new t;return d.x=e.x*u+n.x*c+r.x*f+i.x*h,d.y=e.y*u+n.y*c+r.y*f+i.y*h,d.z=e.z*u+n.z*c+r.z*f+i.z*h,d}},{key:"transformQuat",value:function(t,e){return t.clone().transformQuat(e)}},{key:"angle",value:function(e,n){var r=e.x,i=e.y,a=e.z,o=n.x,s=n.y,l=n.z,u=Math.sqrt(r*r+i*i+a*a)*Math.sqrt(o*o+s*s+l*l),c=u&&t.dot(e,n)/u;return Math.acos(Math.min(Math.max(c,-1),1))}}]),t}();function Ne(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}Oe.ZERO=new Oe(0,0,0),Oe.RIGHT=new Oe(1,0,0),Oe.UP=new Oe(0,1,0),Oe.FORWARD=new Oe(0,0,1),Oe.ONE=new Oe(1,1,1);var Le=function(t){U()(n,t);var e=Ne(n);function n(t,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],s=arguments.length>4?arguments[4]:void 0;N()(this,n),(a=e.call(this,t,r,o,s))._uniforms=[],a._color=new Oe;for(var l=0;l<a._materials.length;l++)a._uniforms[l]=a._materials[l].addVector3Uniform(r,a._color);return a.setValue([255*i.x,255*i.y,255*i.z]),a}return F()(n,[{key:"getValueVector3",value:function(){return this._color}},{key:"convertColorToArray",value:function(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:t}},{key:"setValue",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t instanceof Oe?this._color.copy(t):(t=this.convertColorToArray(t),this._color.setValues(t[0]/255,t[1]/255,t[2]/255)),we()(H()(n.prototype),"setValue",this).call(this,[255*this._color.x,255*this._color.y,255*this._color.z],e)}},{key:"setShaderUniform",value:function(t){for(var e=0;e<this._uniforms.length;e++)this._uniforms[e].set(this._color)}}]),n}(Me),Fe=function(){function t(){N()(this,t)}return F()(t,null,[{key:"posMod",value:function(t,e){return(t%e+e)%e}},{key:"fract",value:function(t){return t-Math.floor(t)}},{key:"lerp",value:function(t,e,n){return(1-n)*t+n*e}},{key:"map",value:function(e,n,r){return t.clamp01((r-e)/(n-e))}},{key:"inverseLerp",value:function(e,n,r){return t.map(e,n,r)}},{key:"clamp01",value:function(t){return t<0?0:t>1?1:t}},{key:"gain01",value:function(t,e){return t>.5?1-.5*Math.pow(2-2*t,e):.5*Math.pow(2*t,e)}},{key:"smootherStep01",value:function(t){return t*t*t*(t*(6*t-15)+10)}},{key:"smoothStep01",value:function(e){return(e=t.clamp01(e))*e*(3-2*e)}},{key:"invSmoothStep01",value:function(e){return e=t.clamp01(e),.5-Math.sin(Math.asin(1-2*e)/3)}},{key:"smoothStep",value:function(e,n,r){return(r=t.clamp((r-e)/(n-e),0,1))*r*(3-2*r)}},{key:"smootherStep",value:function(e,n,r){return r=t.clamp((r-e)/(n-e),0,1),t.smootherStep01(r)}},{key:"step",value:function(e,n,r){return t.clamp01((r-e)/(n-e))}},{key:"nearestPowerOfTwo",value:function(t){return Math.pow(2,Math.round(Math.log(t)/Math.log(2)))}},{key:"nextPowerOfTwo",value:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.log(2)))}},{key:"isPowerOfTwo",value:function(t){return 0===(t&t-1)}},{key:"smallerPowerOfTwo",value:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.log(2)))}},{key:"clamp",value:function(t,e,n){return Math.min(Math.max(t,e),n)}},{key:"degToRad",value:function(t){return t*(Math.PI/180)}},{key:"radToDeg",value:function(t){return t*(180/Math.PI)}},{key:"degToRadVec3",value:function(e){return new Oe(t.degToRad(e.x),t.degToRad(e.y),t.degToRad(e.z))}},{key:"radToDegVec3",value:function(e){return new Oe(t.radToDeg(e.x),t.radToDeg(e.y),t.radToDeg(e.z))}},{key:"latLongToCartesian",value:function(t,e,n,r){var i=this.degToRad(e),a=this.degToRad(n)+Math.PI;return t.z=r*Math.cos(i)*Math.cos(a),t.x=r*Math.cos(i)*Math.sin(a),t.y=r*Math.sin(i),t}},{key:"Approximately",value:function(t,e){return Math.abs(t-e)<1e-6}}]),t}();function Be(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Ue=function(t){U()(n,t);var e=Be(n);function n(t,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;N()(this,n),(a=e.call(this,t,r,l,u))._floatUniforms=[];for(var c=0;c<a._materials.length;c++)a._floatUniforms[c]=a._materials[c].addFloatUniform(r,i);return a.min=o,a.max=s,a.max<i&&(a.max=2*i),a.min>i&&(a.min=i-1),a.setValue(i,!1,!1),a}return F()(n,[{key:"setValue",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t=Fe.clamp(t,this.min,this.max),we()(H()(n.prototype),"setValue",this).call(this,t,e,r)}},{key:"setShaderUniform",value:function(t){for(var e=0;e<this._floatUniforms.length;e++)this._floatUniforms[e].value=t}},{key:"destruct",value:function(){if(this._floatUniforms){for(var t=0;t<this._floatUniforms.length;t++)this._floatUniforms[t].destruct();this._floatUniforms=[]}we()(H()(n.prototype),"destruct",this).call(this)}}]),n}(Me);function Ve(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var ze=function(t){U()(n,t);var e=Ve(n);function n(t,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;N()(this,n),(a=e.call(this,t,r,l,u))._floatUniforms=[];for(var c=0;c<a._materials.length;c++)a._floatUniforms[c]=a._materials[c].addFloatUniform(r,i);return a.min=o,a.max=s,a.max<i&&(a.max=2*i),a.min>i&&(a.min=i-1),a.setValue(i),a}return F()(n,[{key:"setShaderUniform",value:function(t){for(var e=0;e<this._floatUniforms.length;e++)this._floatUniforms[e].value=t}}]),n}(Me);function Ge(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var He=function(t){U()(n,t);var e=Ge(n);function n(t,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return N()(this,n),(a=e.call(this,t,r,o,s)).setValue(i,!1,!1),a}return n}(Me);function $e(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return We(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return We(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function We(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Xe(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var je=function(t){U()(n,t);var e=Xe(n);function n(){var t;return N()(this,n),(t=e.call(this)).params=[],t.children=[],t.id=0,t.id=n._id++,t}return F()(n,[{key:"addGroup",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=new n;return i.init(t,e,r),this.children.push(i),i}},{key:"removeGroup",value:function(t){var e,n=null,r=$e(this.children);try{for(r.s();!(e=r.n()).done;){var i=e.value;if(console.log("checking",i.name,t),i.name===t){n=i;break}}}catch(a){r.e(a)}finally{r.f()}n&&this.children.splice(this.children.indexOf(n),1)}},{key:"removeAllGroups",value:function(){this.children=[]}},{key:"pushGroup",value:function(t){this.children.push(t)}},{key:"init",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.name=t,n._usedGroupNames.push(this.name),this.collapsed=r,this.materials=e?[].concat(e):[]}},{key:"addParamFloat",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=new Ue(this,t,e,n,r,[],i);return this.params.push(a),a}},{key:"addShaderParamFloat",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.materials&&0!=this.materials.length||console.warn("Adding shader param to param group that has no materials",t);var a=new Ue(this,t,e,n,r,this.materials,i);return this.params.push(a),a}},{key:"addParamInt",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=new ze(this,t,e,n,r,null,i);return this.params.push(a),a}},{key:"addShaderParamInt",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.materials&&0!=this.materials.length||console.warn("Adding shader param to param group that has no materials");var a=new ze(this,t,e,n,r,this.materials,i);return this.params.push(a),a}},{key:"addParamBool",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=new De(this,t,e,null,n);return this.params.push(r),r}},{key:"addShaderParamBool",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.materials&&0!=this.materials.length||console.warn("Adding shader param to param group that has no materials");var r=new De(this,t,e,this.materials,n);return this.params.push(r),r}},{key:"addParamColor",value:function(t,e,n){var r=new Le(this,t,e,[],n);return this.params.push(r),r}},{key:"addShaderParamColor",value:function(t,e,n){this.materials&&0!=this.materials.length||console.warn("Adding shader param to param group that has no materials");var r=new Le(this,t,e,this.materials,n);return this.params.push(r),r}},{key:"addParamText",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=new He(this,t,e,null,n);return this.params.push(r),r}},{key:"addButton",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=new Ie(this,t,e);return this.params.push(n),n}},{key:"getParameters",value:function(){var t,e=[],n=$e(this.children);try{for(n.s();!(t=n.n()).done;){var r=t.value;e=e.concat(r.getParameters())}}catch(s){n.e(s)}finally{n.f()}var i,a=$e(this.params);try{for(a.s();!(i=a.n()).done;){var o=i.value;e.push(o)}}catch(s){a.e(s)}finally{a.f()}return e}},{key:"destruct",value:function(){if(this.params)for(var t=0;t<this.params.length;t++)this.params[t].isDestructed||this.params[t].destruct();if(this.children)for(var e=0;e<this.children.length;e++)this.children[e].isDestructed||this.children[e].destruct(),this.children[e].destruct();we()(H()(n.prototype),"destruct",this).call(this)}}],[{key:"exposeParam",value:function(t){t.expose()}},{key:"destruct",value:function(){n._usedGroupNames=[],n._id=0}}]),n}(xe);je._id=0,je._usedGroupNames=[];var Ye=n(27),Ke=n.n(Ye),qe=n(407);function Ze(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Qe=function(t){U()(n,t);var e=Ze(n);function n(t,r,i,a){var o,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"unnamed",u=arguments.length>6?arguments[6]:void 0;return N()(this,n),(o=e.call(this)).init(t,s),o._value=r,o._shaderParam=l,o._x=o.addShaderParamFloat("_X",r.x,i.x,a.x,(function(t){o._value.x=t,o.setShaderValue(),u(o._value)})),o._y=o.addShaderParamFloat("_Y",r.y,i.y,a.y,(function(t){o._value.y=t,o.setShaderValue(),u(o._value)})),o._z=o.addShaderParamFloat("_Z",r.z,i.z,a.z,(function(t){o._value.z=t,o.setShaderValue(),u(o._value)})),o.setShaderValue(),o}return F()(n,[{key:"setShaderValue",value:function(){if(!this.materials)throw new ReferenceError("Cannot set shader value: ParamGroup not initialized");for(var t=0;t<this.materials.length;t++)this.materials[t].setVector3(this._shaderParam,this._value)}},{key:"getValue",value:function(){return this._value}},{key:"setValue",value:function(t){this._value=t,this._x.setValue(t.x),this._y.setValue(t.y),this._z.setValue(t.z)}}]),n}(je);function Je(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return tn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tn(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function tn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function en(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var nn=function(t){U()(n,t);var e=en(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return N()(this,n),(t=e.call(this)).visible=!1,t._params={},t._uniqueNames=[],t.folderIndex=-2,r&&r.add(Ke()(t)),t._jsonExportEnabled=i,t._params=a,t}return F()(n,[{key:"load",value:function(t){t.call(this)}},{key:"init",value:function(t){this._rootGroup=t;var e={};return this._gui=new qe.a(this._params),this.readGroup(null,t,e,this._gui),this._jsonExportEnabled&&this._gui.remember(e),this.setVisible(!0),this._gui}},{key:"getDatGUI",value:function(){return this._gui}},{key:"setPreset",value:function(t){if(!this._gui)throw new Error("Cannot set preset: DatGui not initialized");this.folderIndex=-2,this.setPresetRecurse(this._gui.__folders.controls,t.remembered.Default)}},{key:"setPresetRecurse",value:function(t,e){this.folderIndex++;var n=e[this.folderIndex];if("undefined"!==typeof n){var r,i=Je(t.__controllers);try{for(i.s();!(r=i.n()).done;){var a=r.value,o=n[a.property];"undefined"!==typeof o&&a.setValue(o)}}catch(f){i.e(f)}finally{i.f()}}for(var s=0,l=Object.keys(t.__folders);s<l.length;s++){var u=l[s],c=t.__folders[u];this.setPresetRecurse(c,e)}}},{key:"readGroup",value:function(t,e,n,r){if(!e.name)throw new Error("group name not initialized");if(!this._gui)throw new Error("cannot read group: DatGui not initialized");var i=this.uniqueName(r.__folders,e.name),a=r.addFolder(i);e.collapsed||a.open();var o,s=Je(e.params);try{for(s.s();!(o=s.n()).done;){var l=o.value,u=this.uniqueName(n,l.name);this._uniqueNames[l.id]=u,void 0==n[u]?n[u]=l.value:console.log("property "+u+" already exists on param object",n);var c=void 0;if(l instanceof Ue){var f=l;c=a.add(n,u,f.min,f.max)}else if(l instanceof ze){var h=l;c=a.add(n,u,h.min,h.max).step(1)}else if(l instanceof De)c=a.add(n,u);else if(l instanceof Ie)c=a.add(n,u);else if(l instanceof Qe)c=a.add(n,u);else if(l instanceof Le)c=a.addColor(n,u);else if(l instanceof He)c=a.add(n,u);else if(void 0===c)throw new TypeError("Unknown type of parameter");l instanceof Ie||this.addHandlers(c,n,l)}}catch(y){s.e(y)}finally{s.f()}var d,v=Je(e.children);try{for(v.s();!(d=v.n()).done;){var p=d.value,m={};this._jsonExportEnabled&&this._gui.remember(m),this.readGroup(e,p,m,a)}}catch(y){v.e(y)}finally{v.f()}}},{key:"uniqueName",value:function(t,e){return e in t?this.uniqueName(t,"_"+e):e}},{key:"addHandlers",value:function(t,e,n){var r=this;n.setUpdateUICallback((function(t){e[r._uniqueNames[n.id]]=t})),t.listen(),t.onChange((function(t){e[r._uniqueNames[n.id]]=t,n.setFromUI(t)})),t.onFinishChange=function(t){return n.setFromUI(t)}}},{key:"setVisible",value:function(t){if(!this._gui)throw new Error("cannot set visible: DatGui not initialized");this.visible=t,this._gui.domElement.parentElement&&(this._gui.domElement.parentElement.style.zIndex=(t?999:0).toString(),this._gui.domElement.parentElement.style.visibility=(t?"visible":"hidden").toString())}},{key:"destruct",value:function(){this._gui&&(this._gui.domElement.parentElement&&this._gui.domElement.parentElement.removeChild(this._gui.domElement),delete this._gui),we()(H()(n.prototype),"destruct",this).call(this)}}]),n}(xe);function rn(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var an=function(t){U()(n,t);var e=rn(n);function n(t){var r;return N()(this,n),(r=e.call(this)).resizeInterval=.5,r.pixelRatio=1,r.resizeWait=0,r._canvasParent=t,t&&t.offsetWidth*t.offsetHeight<1&&console.error("canvasParent has no area",t),r.canvas=r.prepareCanvas(t),window.devicePixelRatio&&(r.pixelRatio=window.devicePixelRatio),r}return F()(n,[{key:"prepareCanvas",value:function(t){var e=document.createElement("canvas");return e.setAttribute("id","canvas"),e.style.position="absolute",e.style.left="0px",e.style.top="0px",t&&(e.style.width=t.offsetWidth+"px",e.style.height=t.offsetHeight+"px",t.appendChild(e)),e}},{key:"update",value:function(t){if(this._canvasParent&&(this.resizeWait-=t,this.resizeWait<=0)){this.resizeWait=this.resizeInterval;var e=this._canvasParent.offsetWidth,n=this._canvasParent.offsetHeight;return e*n>0?this.setSize(e,n):console.warn("canvasParent has no area",this._canvasParent),!0}return!1}},{key:"setSize",value:function(t,e){if(this.canvas.width!=(t*this.pixelRatio|0)||this.canvas.height!=(e*this.pixelRatio|0)){this.canvas.width=t*this.pixelRatio|0,this.canvas.height=e*this.pixelRatio|0;var n=document.createEvent("Event");n.initEvent("resize",!1,!0),this.canvas.dispatchEvent(n),Se.log("canvas resize",this.canvas.width,this.canvas.height)}this.canvas.style.width==t+"px"&&this.canvas.style.height==e+"px"||(this.canvas.style.width=t+"px",this.canvas.style.height=e+"px")}},{key:"destruct",value:function(){this.canvas.width=1,this.canvas.height=1,this._canvasParent&&this._canvasParent.removeChild(this.canvas),we()(H()(n.prototype),"destruct",this).call(this)}},{key:"canvasParent",get:function(){return this._canvasParent}}]),n}(xe);function on(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var sn=function(t){U()(n,t);var e=on(n);function n(){var t;return N()(this,n),(t=e.apply(this,arguments)).loadsRequested=[],t.loadsCompleted=0,t.progress=0,t._loading=!1,t.progressCallBack=void 0,t.callbackPerPreloadable=[],t}return F()(n,[{key:"add",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=this.loadsRequested.push(t)-1;return this.callbackPerPreloadable.push(e),this.loading&&this.startLoader(n),t}},{key:"load",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;this.callback=t,this.progressCallBack=e,this.loadAll()}},{key:"loadAll",value:function(){if(0!==this.loadsRequested.length){this._loading=!0;for(var t=0;t<this.loadsRequested.length;t++)this.startLoader(t)}else this.loadDoneCallback()}},{key:"setCallbackForPreloadable",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;this.callbackPerPreloadable[this.getIndexOfPreloadable(t)]=e}},{key:"getIndexOfPreloadable",value:function(t){return this.loadsRequested.indexOf(t)}},{key:"startLoader",value:function(t){var e=this;this.loadsRequested[t].load((function(){var n=e.callbackPerPreloadable[t];n&&n(),e.loadDoneCallback()}))}},{key:"loadDoneCallback",value:function(){this.loadsCompleted++,this.progress+=(1-this.progress)/(1+this.loadsRequested.length-this.loadsCompleted),this.progressCallBack&&(this.loadsRequested.length?this.progressCallBack.call(this,this.progress):this.progressCallBack.call(this,1)),this.loadsCompleted>=this.loadsRequested.length&&(this._loading=!1,this.callback&&(this.callback.call(this),this.callback=null))}},{key:"destruct",value:function(){this.callback=void 0,we()(H()(n.prototype),"destruct",this).call(this)}},{key:"loading",get:function(){return this._loading}}]),n}(xe),ln=function t(e){N()(this,t),this.MAX_VERTEX_ATTRIBS=e.getParameter(e.MAX_VERTEX_ATTRIBS),this.MAX_VARYING_VECTORS=e.getParameter(e.MAX_VARYING_VECTORS),this.MAX_VERTEX_UNIFORM_VECTORS=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),this.MAX_FRAGMENT_UNIFORM_VECTORS=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),this.MAX_TEXTURE_IMAGE_UNITS=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),this.MAX_VERTEX_TEXTURE_IMAGE_UNITS=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),this.MAX_TEXTURE_SIZE=e.getParameter(e.MAX_TEXTURE_SIZE),this.MAX_CUBE_MAP_TEXTURE_SIZE=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),this.MAX_VIEWPORT_DIMS=e.getParameter(e.MAX_VIEWPORT_DIMS),this.MAX_RENDERBUFFER_SIZE=e.getParameter(e.MAX_RENDERBUFFER_SIZE),this.MAX_COMBINED_TEXTURE_IMAGE_UNITS=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS);var n=e.getExtension("WEBGL_debug_renderer_info");for(var r in this.UNMASKED_RENDERER=n&&e.getParameter(n.UNMASKED_RENDERER_WEBGL),this.UNMASKED_VENDOR=n&&e.getParameter(n.UNMASKED_VENDOR_WEBGL),this)this.hasOwnProperty(r)&&Se.log(r,this[r])},un=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;N()(this,t),this.x=e,this.y=n,this.z=r,this.w=i}return F()(t,[{key:"clone",value:function(){return new t(this.x,this.y,this.z,this.w)}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this}},{key:"setValues",value:function(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.z+", "+this.w+")"}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"equals",value:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}},{key:"normalize",value:function(){var t=this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w;return t>0&&(t=1/Math.sqrt(t)),this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}},{key:"multiplyScalar",value:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}},{key:"multiply",value:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}},{key:"divide",value:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this.w/=t.w,this}},{key:"add",value:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}},{key:"subtract",value:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}},{key:"dot",value:function(t){return t.x*t.x+t.y*t.y+t.z*t.z+t.w*t.w}},{key:"transform",value:function(t){var e=this.x,n=this.y,r=this.z,i=this.w,a=t.m;return this.x=a[0]*e+a[4]*n+a[8]*r+a[12]*i,this.y=a[1]*e+a[5]*n+a[9]*r+a[13]*i,this.z=a[2]*e+a[6]*n+a[10]*r+a[14]*i,this.w=a[3]*e+a[7]*n+a[11]*r+a[15]*i,this}}],[{key:"dot",value:function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z+t.w*e.w}},{key:"distance",value:function(t,e){var n=e.x-t.x,r=e.y-t.y,i=e.z-t.z,a=e.w-t.w;return Math.sqrt(n*n+r*r+i*i+a*a)}},{key:"add",value:function(e,n){var r=new t;return r.x=e.x+n.x,r.y=e.y+n.y,r.z=e.z+n.z,r.w=e.w+n.w,r}},{key:"subtract",value:function(e,n){var r=new t;return r.x=e.x-n.x,r.y=e.y-n.y,r.z=e.z-n.z,r.w=e.w-n.w,r}},{key:"multiply",value:function(e,n){var r=new t;return r.x=e.x*n.x,r.y=e.y*n.y,r.z=e.z*n.z,r.w=e.w*n.w,r}},{key:"divide",value:function(e,n){var r=new t;return r.x=e.x/n.x,r.y=e.y/n.y,r.z=e.z/n.z,r.w=e.w/n.w,r}},{key:"scale",value:function(e,n){var r=new t;return r.x=e.x*n,r.y=e.y*n,r.z=e.z*n,r.w=e.w*n,r}},{key:"normalize",value:function(t){var e=t.x*t.x+t.y*t.y+t.z*t.z+t.w*t.w;return e>0&&(e=1/Math.sqrt(e)),t.clone().multiplyScalar(e)}},{key:"cross",value:function(e,n,r){var i=n.x*r.y-n.y*r.x,a=n.x*r.z-n.z*r.x,o=n.x*r.w-n.w*r.x,s=n.y*r.z-n.z*r.y,l=n.y*r.w-n.w*r.y,u=n.z*r.w-n.w*r.z,c=e.x,f=e.y,h=e.z,d=e.w,v=new t;return v.x=f*u-h*l+d*s,v.y=-c*u+h*o-d*a,v.z=c*l-f*o+d*i,v.w=-c*s+f*a-h*i,v}},{key:"lerp",value:function(e,n,r){var i=e.x,a=e.y,o=e.z,s=e.w,l=new t;return l.x=i+r*(n.x-i),l.y=a+r*(n.y-a),l.z=o+r*(n.z-o),l.w=s+r*(n.w-s),l}},{key:"transform",value:function(t,e){return t.clone().transform(e)}},{key:"transformQuat",value:function(e,n){var r=e.x,i=e.y,a=e.z,o=n.x,s=n.y,l=n.z,u=n.w,c=u*r+s*a-l*i,f=u*i+l*r-o*a,h=u*a+o*i-s*r,d=-o*r-s*i-l*a,v=new t;return v.x=c*u+d*-o+f*-l-h*-s,v.y=f*u+d*-s+h*-o-c*-l,v.z=h*u+d*-l+c*-s-f*-o,v.w=e.w,v}}]),t}();function cn(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}un.ZERO=new un(0,0,0,0);var fn=function(t){U()(n,t);var e=cn(n);function n(){return N()(this,n),e.apply(this,arguments)}return F()(n,[{key:"toRGBString",value:function(){return"rgb("+Math.round(255*this.r)+","+Math.round(255*this.g)+","+Math.round(255*this.b)+")"}},{key:"getHex",value:function(){return"#"+n.componentToHex(this.r)+n.componentToHex(this.g)+n.componentToHex(this.b)}},{key:"setRGBA255",value:function(t){return this.r=t[0]/255,this.g=t[1]/255,this.b=t[2]/255,this.a=t[3],this}},{key:"getRGBA255",value:function(){return[Math.round(255*this.r),Math.round(255*this.g),Math.round(255*this.b),this.a]}},{key:"setFromHex",value:function(t){t=t.replace(/[^0-9A-F]/gi,"");var e=parseInt(t,16);return this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this.a=1,this}},{key:"setFromHSV",value:function(t,e,n){var r=0,i=0,a=0,o=Math.floor(6*t),s=6*t-o,l=n*(1-e),u=n*(1-s*e),c=n*(1-(1-s)*e);switch(o%6){case 0:r=n,i=c,a=l;break;case 1:r=u,i=n,a=l;break;case 2:r=l,i=n,a=c;break;case 3:r=l,i=u,a=n;break;case 4:r=c,i=l,a=n;break;case 5:r=n,i=l,a=u}return this.r=r,this.g=i,this.b=a,this}},{key:"getRgbaString",value:function(){return"rgba("+Math.round(255*this.r)+", "+Math.round(255*this.g)+", "+Math.round(255*this.b)+", "+this.a+")"}},{key:"toVector3",value:function(){return new Oe(this.x,this.y,this.z)}},{key:"r",get:function(){return this.x},set:function(t){this.x=t}},{key:"g",get:function(){return this.y},set:function(t){this.y=t}},{key:"b",get:function(){return this.z},set:function(t){this.z=t}},{key:"a",get:function(){return this.w},set:function(t){this.w=t}}],[{key:"componentToHex",value:function(t){var e=(255*t|0).toString(16);return 1===e.length?"0"+e:e}},{key:"fromHex",value:function(t){return(new n).setFromHex(t)}},{key:"fromRGB255",value:function(t){var e=new n;return e.setRGBA255(t),e}},{key:"getRandom",value:function(){return new n(Math.random(),Math.random(),Math.random())}},{key:"colorFromString",value:function(t){var e=[],r=[];r[0]=t.substr(0,Math.floor(t.length/3)),r[1]=t.substr(Math.floor(t.length/3),Math.floor(2*t.length/3)),r[2]=t.substr(Math.floor(2*t.length/3),t.length);for(var i=0;i<r.length;i++)for(var a=0;a<r[i].length;a++)i in e||(e[i]=0),e[i]+=r[i].charCodeAt(a);return new n(e[0]/128%1,e[1]/128%1,e[2]/128%1,1)}},{key:"fromHSV",value:function(t,e,r){return(new n).setFromHSV(t,e,r)}}]),n}(un),hn=function t(){N()(this,t)};hn.ACTIVE_ATTRIBUTES=35721,hn.ACTIVE_ATTRIBUTE_MAX_LENGTH=35722,hn.ACTIVE_TEXTURE=34016,hn.ACTIVE_UNIFORMS=35718,hn.ACTIVE_UNIFORM_MAX_LENGTH=35719,hn.ALIASED_LINE_WIDTH_RANGE=33902,hn.ALIASED_POINT_SIZE_RANGE=33901,hn.ALPHA=6406,hn.ALPHA_BITS=3413,hn.ALWAYS=519,hn.ARRAY_BUFFER=34962,hn.ARRAY_BUFFER_BINDING=34964,hn.ATTACHED_SHADERS=35717,hn.BACK=1029,hn.BLEND=3042,hn.BLEND_COLOR=32773,hn.BLEND_DST_ALPHA=32970,hn.BLEND_DST_RGB=32968,hn.BLEND_EQUATION=32777,hn.BLEND_EQUATION_ALPHA=34877,hn.BLEND_EQUATION_RGB=32777,hn.BLEND_SRC_ALPHA=32971,hn.BLEND_SRC_RGB=32969,hn.BLUE_BITS=3412,hn.BOOL=35670,hn.BOOL_VEC2=35671,hn.BOOL_VEC3=35672,hn.BOOL_VEC4=35673,hn.BROWSER_DEFAULT_WEBGL=37444,hn.BUFFER_SIZE=34660,hn.BUFFER_USAGE=34661,hn.BYTE=5120,hn.CCW=2305,hn.CLAMP_TO_EDGE=33071,hn.COLOR_ATTACHMENT0=36064,hn.COLOR_BUFFER_BIT=16384,hn.COLOR_CLEAR_VALUE=3106,hn.COLOR_WRITEMASK=3107,hn.COMPILE_STATUS=35713,hn.COMPRESSED_TEXTURE_FORMATS=34467,hn.CONSTANT_ALPHA=32771,hn.CONSTANT_COLOR=32769,hn.CONTEXT_LOST_WEBGL=37442,hn.CULL_FACE=2884,hn.CULL_FACE_MODE=2885,hn.CURRENT_PROGRAM=35725,hn.CURRENT_VERTEX_ATTRIB=34342,hn.CW=2304,hn.DECR=7683,hn.DECR_WRAP=34056,hn.DELETE_STATUS=35712,hn.DEPTH_ATTACHMENT=36096,hn.DEPTH_BITS=3414,hn.DEPTH_BUFFER_BIT=256,hn.DEPTH_CLEAR_VALUE=2931,hn.DEPTH_COMPONENT=6402,hn.DEPTH_COMPONENT16=33189,hn.DEPTH_FUNC=2932,hn.DEPTH_RANGE=2928,hn.DEPTH_STENCIL=34041,hn.DEPTH_STENCIL_ATTACHMENT=33306,hn.DEPTH_TEST=2929,hn.DEPTH_WRITEMASK=2930,hn.DITHER=3024,hn.DONT_CARE=4352,hn.DST_ALPHA=772,hn.DST_COLOR=774,hn.DYNAMIC_DRAW=35048,hn.ELEMENT_ARRAY_BUFFER=34963,hn.ELEMENT_ARRAY_BUFFER_BINDING=34965,hn.EQUAL=514,hn.FASTEST=4353,hn.FLOAT=5126,hn.FLOAT_MAT2=35674,hn.FLOAT_MAT3=35675,hn.FLOAT_MAT4=35676,hn.FLOAT_VEC2=35664,hn.FLOAT_VEC3=35665,hn.FLOAT_VEC4=35666,hn.FRAGMENT_SHADER=35632,hn.FRAMEBUFFER=36160,hn.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,hn.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,hn.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,hn.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,hn.FRAMEBUFFER_BINDING=36006,hn.FRAMEBUFFER_COMPLETE=36053,hn.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,hn.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,hn.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,hn.FRAMEBUFFER_UNSUPPORTED=36061,hn.FRONT=1028,hn.FRONT_AND_BACK=1032,hn.FRONT_FACE=2886,hn.FUNC_ADD=32774,hn.FUNC_REVERSE_SUBTRACT=32779,hn.FUNC_SUBTRACT=32778,hn.GENERATE_MIPMAP_HINT=33170,hn.GEQUAL=518,hn.GREATER=516,hn.GREEN_BITS=3411,hn.HIGH_FLOAT=36338,hn.HIGH_INT=36341,hn.INCR=7682,hn.INCR_WRAP=34055,hn.INFO_LOG_LENGTH=35716,hn.INT=5124,hn.INT_VEC2=35667,hn.INT_VEC3=35668,hn.INT_VEC4=35669,hn.INVALID_ENUM=1280,hn.INVALID_FRAMEBUFFER_OPERATION=1286,hn.INVALID_OPERATION=1282,hn.INVALID_VALUE=1281,hn.INVERT=5386,hn.KEEP=7680,hn.LEQUAL=515,hn.LESS=513,hn.LINEAR=9729,hn.LINEAR_MIPMAP_LINEAR=9987,hn.LINEAR_MIPMAP_NEAREST=9985,hn.LINES=1,hn.LINE_LOOP=2,hn.LINE_STRIP=3,hn.LINE_WIDTH=2849,hn.LINK_STATUS=35714,hn.LOW_FLOAT=36336,hn.LOW_INT=36339,hn.LUMINANCE=6409,hn.LUMINANCE_ALPHA=6410,hn.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,hn.MAX_CUBE_MAP_TEXTURE_SIZE=34076,hn.MAX_FRAGMENT_UNIFORM_VECTORS=36349,hn.MAX_RENDERBUFFER_SIZE=34024,hn.MAX_TEXTURE_IMAGE_UNITS=34930,hn.MAX_TEXTURE_SIZE=3379,hn.MAX_VARYING_VECTORS=36348,hn.MAX_VERTEX_ATTRIBS=34921,hn.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,hn.MAX_VERTEX_UNIFORM_VECTORS=36347,hn.MAX_VIEWPORT_DIMS=3386,hn.MEDIUM_FLOAT=36337,hn.MEDIUM_INT=36340,hn.MIRRORED_REPEAT=33648,hn.NEAREST=9728,hn.NEAREST_MIPMAP_LINEAR=9986,hn.NEAREST_MIPMAP_NEAREST=9984,hn.NEVER=512,hn.NICEST=4354,hn.NONE=0,hn.NOTEQUAL=517,hn.NO_ERROR=0,hn.NUM_COMPRESSED_TEXTURE_FORMATS=34466,hn.ONE=1,hn.ONE_MINUS_CONSTANT_ALPHA=32772,hn.ONE_MINUS_CONSTANT_COLOR=32770,hn.ONE_MINUS_DST_ALPHA=773,hn.ONE_MINUS_DST_COLOR=775,hn.ONE_MINUS_SRC_ALPHA=771,hn.ONE_MINUS_SRC_COLOR=769,hn.OUT_OF_MEMORY=1285,hn.PACK_ALIGNMENT=3333,hn.POINTS=0,hn.POLYGON_OFFSET_FACTOR=32824,hn.POLYGON_OFFSET_FILL=32823,hn.POLYGON_OFFSET_UNITS=10752,hn.RED_BITS=3410,hn.RENDERBUFFER=36161,hn.RENDERBUFFER_ALPHA_SIZE=36179,hn.RENDERBUFFER_BINDING=36007,hn.RENDERBUFFER_BLUE_SIZE=36178,hn.RENDERBUFFER_DEPTH_SIZE=36180,hn.RENDERBUFFER_GREEN_SIZE=36177,hn.RENDERBUFFER_HEIGHT=36163,hn.RENDERBUFFER_INTERNAL_FORMAT=36164,hn.RENDERBUFFER_RED_SIZE=36176,hn.RENDERBUFFER_STENCIL_SIZE=36181,hn.RENDERBUFFER_WIDTH=36162,hn.RENDERER=7937,hn.REPEAT=10497,hn.REPLACE=7681,hn.RGB=6407,hn.RGB5_A1=32855,hn.RGB565=36194,hn.RGBA=6408,hn.RGBA4=32854,hn.SAMPLER_2D=35678,hn.SAMPLER_CUBE=35680,hn.SAMPLES=32937,hn.SAMPLE_ALPHA_TO_COVERAGE=32926,hn.SAMPLE_BUFFERS=32936,hn.SAMPLE_COVERAGE=32928,hn.SAMPLE_COVERAGE_INVERT=32939,hn.SAMPLE_COVERAGE_VALUE=32938,hn.SCISSOR_BOX=3088,hn.SCISSOR_TEST=3089,hn.SHADER_COMPILER=36346,hn.SHADER_SOURCE_LENGTH=35720,hn.SHADER_TYPE=35663,hn.SHADING_LANGUAGE_VERSION=35724,hn.SHORT=5122,hn.SRC_ALPHA=770,hn.SRC_ALPHA_SATURATE=776,hn.SRC_COLOR=768,hn.STATIC_DRAW=35044,hn.STENCIL_ATTACHMENT=36128,hn.STENCIL_BACK_FAIL=34817,hn.STENCIL_BACK_FUNC=34816,hn.STENCIL_BACK_PASS_DEPTH_FAIL=34818,hn.STENCIL_BACK_PASS_DEPTH_PASS=34819,hn.STENCIL_BACK_REF=36003,hn.STENCIL_BACK_VALUE_MASK=36004,hn.STENCIL_BACK_WRITEMASK=36005,hn.STENCIL_BITS=3415,hn.STENCIL_BUFFER_BIT=1024,hn.STENCIL_CLEAR_VALUE=2961,hn.STENCIL_FAIL=2964,hn.STENCIL_FUNC=2962,hn.STENCIL_INDEX=6401,hn.STENCIL_INDEX8=36168,hn.STENCIL_PASS_DEPTH_FAIL=2965,hn.STENCIL_PASS_DEPTH_PASS=2966,hn.STENCIL_REF=2967,hn.STENCIL_TEST=2960,hn.STENCIL_VALUE_MASK=2963,hn.STENCIL_WRITEMASK=2968,hn.STREAM_DRAW=35040,hn.SUBPIXEL_BITS=3408,hn.TEXTURE=5890,hn.TEXTURE0=33984,hn.TEXTURE1=33985,hn.TEXTURE2=33986,hn.TEXTURE3=33987,hn.TEXTURE4=33988,hn.TEXTURE5=33989,hn.TEXTURE6=33990,hn.TEXTURE7=33991,hn.TEXTURE8=33992,hn.TEXTURE9=33993,hn.TEXTURE10=33994,hn.TEXTURE11=33995,hn.TEXTURE12=33996,hn.TEXTURE13=33997,hn.TEXTURE14=33998,hn.TEXTURE15=33999,hn.TEXTURE16=34e3,hn.TEXTURE17=34001,hn.TEXTURE18=34002,hn.TEXTURE19=34003,hn.TEXTURE20=34004,hn.TEXTURE21=34005,hn.TEXTURE22=34006,hn.TEXTURE23=34007,hn.TEXTURE24=34008,hn.TEXTURE25=34009,hn.TEXTURE26=34010,hn.TEXTURE27=34011,hn.TEXTURE28=34012,hn.TEXTURE29=34013,hn.TEXTURE30=34014,hn.TEXTURE31=34015,hn.TEXTURE_2D=3553,hn.TEXTURE_BINDING_2D=32873,hn.TEXTURE_BINDING_CUBE_MAP=34068,hn.TEXTURE_CUBE_MAP=34067,hn.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,hn.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,hn.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,hn.TEXTURE_CUBE_MAP_POSITIVE_X=34069,hn.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,hn.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,hn.TEXTURE_MAG_FILTER=10240,hn.TEXTURE_MIN_FILTER=10241,hn.TEXTURE_WRAP_S=10242,hn.TEXTURE_WRAP_T=10243,hn.TRIANGLES=4,hn.TRIANGLE_FAN=6,hn.TRIANGLE_STRIP=5,hn.UNPACK_ALIGNMENT=3317,hn.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,hn.UNPACK_FLIP_Y_WEBGL=37440,hn.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,hn.UNSIGNED_BYTE=5121,hn.UNSIGNED_INT=5125,hn.UNSIGNED_SHORT=5123,hn.UNSIGNED_SHORT_4_4_4_4=32819,hn.UNSIGNED_SHORT_5_5_5_1=32820,hn.UNSIGNED_SHORT_5_6_5=33635,hn.VALIDATE_STATUS=35715,hn.VENDOR=7936,hn.VERSION=7938,hn.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,hn.VERTEX_ATTRIB_ARRAY_ENABLED=34338,hn.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,hn.VERTEX_ATTRIB_ARRAY_POINTER=34373,hn.VERTEX_ATTRIB_ARRAY_SIZE=34339,hn.VERTEX_ATTRIB_ARRAY_STRIDE=34340,hn.VERTEX_ATTRIB_ARRAY_TYPE=34341,hn.VERTEX_SHADER=35633,hn.VIEWPORT=2978,hn.ZERO=0;var dn=hn,vn=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;N()(this,t),this.x=e,this.y=n}return F()(t,[{key:"clone",value:function(){return new t(this.x,this.y)}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this}},{key:"setValues",value:function(t,e){return this.x=t,this.y=e,this}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"toString",value:function(){return this.x+","+this.y}},{key:"equals",value:function(t){return t.x===this.x&&t.y===this.y}},{key:"normalize",value:function(){var t=this.x*this.x+this.y*this.y;return t>0&&(t=1/Math.sqrt(t)),this.x*=t,this.y*=t,this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this}},{key:"multiplyScalar",value:function(t){return this.x*=t,this.y*=t,this}},{key:"multiplyMatrix",value:function(t){var e=t.m,n=e[0]*this.x+e[2]*this.y,r=e[1]*this.x+e[3]*this.y;return this.setValues(n,r)}},{key:"multiply",value:function(t){return this.x*=t.x,this.y*=t.y,this}},{key:"add",value:function(t){return this.x+=t.x,this.y+=t.y,this}},{key:"subtract",value:function(t){return this.x-=t.x,this.y-=t.y,this}},{key:"subtractScalar",value:function(t){return this.x-=t,this.y-=t,this}},{key:"rotate",value:function(t,e){var n=Math.sin(e),r=Math.cos(e);this.x-=t.x,this.y-=t.y;var i=this.x*r-this.y*n,a=this.x*n+this.y*r;return this.x=i+t.x,this.y=a+t.y,this}},{key:"randomize",value:function(){return this.x=2*Math.random()-1,this.y=2*Math.random()-1,this}},{key:"randomize01",value:function(){return this.x=Math.random(),this.y=Math.random(),this}},{key:"randomizeDisc",value:function(){do{this.randomize()}while(this.length()>1);return this}}],[{key:"dot",value:function(t,e){return t.x*e.x+t.y*e.y}},{key:"distance",value:function(t,e){var n=t.x-e.x,r=t.y-e.y;return Math.sqrt(n*n+r*r)}},{key:"transformMat2",value:function(e,n){var r=e.x,i=e.y,a=n.m,o=new t;return o.x=a[0]*r+a[2]*i+a[4],o.y=a[1]*r+a[3]*i+a[5],o}},{key:"transformMat3",value:function(e,n){var r=e.x,i=e.y,a=n.m,o=new t;return o.x=a[0]*r+a[3]*i+a[6],o.y=a[1]*r+a[4]*i+a[7],o}},{key:"transformMat4",value:function(e,n){var r=e.x,i=e.y,a=n.m,o=new t;return o.x=a[0]*r+a[4]*i+a[12],o.y=a[1]*r+a[5]*i+a[13],o}},{key:"multiplyScalar",value:function(e,n){var r=new t;return r.x=e.x*n,r.y=e.y*n,r}},{key:"add",value:function(e,n){return new t(e.x+n.x,e.y+n.y)}},{key:"subtract",value:function(e,n){return new t(e.x-n.x,e.y-n.y)}},{key:"lerp",value:function(e,n,r){var i=e.x,a=e.y;return new t(i+r*(n.x-i),a+r*(n.y-a))}},{key:"fract",value:function(e){return t.subtract(e,t.floor(e))}},{key:"floor",value:function(e){return new t(Math.floor(e.x),Math.floor(e.y))}}]),t}();function pn(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var mn=function(t){U()(n,t);var e=pn(n);function n(t,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(N()(this,n),(i=e.call(this))._loc=t.getUniformLocation(r),i._loc||Se.log("FloatUniform: uniform does not exist on shader: ",t.name,r),!t.shader.program)throw new ReferenceError("Cannot construct FloatUniform from material: material shader is not yet initialized.");return i._renderer=t.renderer,i._program=t.shader.program,i.value=a,i}return F()(n,[{key:"destruct",value:function(){we()(H()(n.prototype),"destruct",this).call(this)}},{key:"value",set:function(t){t!=this._value&&(this._value=t,this._renderer.renderState.setProgram(this._program),this._renderer.context.uniform1f(this._loc,this._value))},get:function(){return this._value}}]),n}(xe),yn=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new vn;if(N()(this,t),this._value=r,this._loc=e.getUniformLocation(n),this._loc||Se.log("FloatUniform: uniform does not exist on shader: ",n),!e.shader.program)throw new ReferenceError("Cannot construct Vector2Uniform from material: material shader is not yet initialized.");this._renderer=e.renderer,this._program=e.shader.program}return F()(t,[{key:"set",value:function(t){t.x==this._value.x&&t.y==this._value.y||(this._value=t,this._renderer.renderState.setProgram(this._program),this._renderer.context.uniform2f(this._loc,this._value.x,this._value.y))}},{key:"getValue",value:function(){return this._value}}]),t}(),gn=function(){function t(e,n){arguments.length>2&&void 0!==arguments[2]||new Oe;if(N()(this,t),this._value=new Oe,this._loc=e.getUniformLocation(n),this._loc||Se.log("FloatUniform: uniform does not exist on shader: ",n),!e.shader.program)throw new ReferenceError("Cannot construct Vector3Uniform from material: material shader is not yet initialized.");this._renderer=e.renderer,this._program=e.shader.program}return F()(t,[{key:"set",value:function(t){t.x==this._value.x&&t.y==this._value.y&&t.z==this._value.z||(this._value.copy(t),this._renderer.renderState.setProgram(this._program),this._renderer.context.uniform3f(this._loc,this._value.x,this._value.y,this._value.z))}},{key:"getValue",value:function(){return this._value}}]),t}();function _n(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var En=function(t){U()(n,t);var e=_n(n);function n(t,r,i){var a;return N()(this,n),(a=e.call(this))._shaderDefines={},a.drawType=dn.TRIANGLES,a.depthTest=!0,a.depthWrite=!0,a.alphaToCoverage=!1,a.blend=!1,a.culling=dn.BACK,a.blendFuncSeparate=!1,a.renderer=t,a.name=r,a.shader=i,a.id=n.staticId++,a.setDefaultBlending(),a}return F()(n,[{key:"setActive",value:function(){if(this.renderer.renderState.setProgram(this.shader.program),this.shader.getTextureUniforms().forEach((function(t){return t.bind()})),this.renderer.renderState.material!=this&&(this.renderer.renderState.material=this,this.renderer.renderState.setAlphaToCoverage(this.alphaToCoverage),this.renderer.renderState.setDepthTest(this.depthTest),this.renderer.renderState.setDepthMask(this.depthWrite),this.depthFunc&&this.renderer.renderState.setDepthFunc(this.depthFunc),this.renderer.renderState.setCulling(this.culling),this.renderer.renderState.setBlendEnabled(this.blend),this.blend))if(this.renderer.renderState.setBlendEquation(this.blendEquation),this.blendFuncSeparate){if(void 0===this.sourceBlendRGB||void 0===this.destinationBlendRGB||void 0===this.sourceBlendAlpha||void 0===this.destinationBlendAlpha)throw new ReferenceError("expected blend properties to be set");this.renderer.renderState.setBlendFuncSeparate(this.sourceBlendRGB,this.destinationBlendRGB,this.sourceBlendAlpha,this.destinationBlendAlpha)}else this.renderer.renderState.setBlendFunc(this.sourceBlend,this.destinationBlend)}},{key:"setDefaultBlending",value:function(){this.depthTest=!0,this.depthWrite=!0,this.blend=!1,this.blendEquation=dn.FUNC_ADD,this.sourceBlend=dn.ZERO,this.destinationBlend=dn.ONE}},{key:"setAlphaBlending",value:function(){this.depthWrite=!1,this.depthTest=!0,this.blend=!0,this.blendEquation=dn.FUNC_ADD,this.setBlendUnified(dn.SRC_ALPHA,dn.ONE_MINUS_SRC_ALPHA)}},{key:"setPreMultipliedAlphaBlending",value:function(){this.depthWrite=!1,this.depthTest=!0,this.blend=!0,this.blendEquation=dn.FUNC_ADD,this.setBlendUnified(dn.ONE,dn.ONE_MINUS_SRC_ALPHA)}},{key:"setMaxBlending",value:function(){this.depthWrite=!1,this.depthTest=!1,this.blend=!0,this.blendEquation=32776,this.sourceBlend=dn.ONE,this.destinationBlend=dn.ONE,this.setBlendUnified(dn.ONE,dn.ONE)}},{key:"setAdditiveBlending",value:function(){this.depthWrite=!1,this.depthTest=!0,this.blend=!0,this.blendEquation=dn.FUNC_ADD,this.setBlendUnified(dn.ONE,dn.ONE)}},{key:"setMultiplyBlending",value:function(){this.depthWrite=!1,this.depthTest=!0,this.blend=!0,this.blendEquation=dn.FUNC_ADD,this.setBlendUnified(dn.ZERO,dn.SRC_COLOR)}},{key:"setSubtractiveBlending",value:function(){this.depthWrite=!1,this.depthTest=!1,this.blend=!0,this.blendEquation=dn.FUNC_SUBTRACT,this.setBlendUnified(dn.ONE,dn.ONE_MINUS_SRC_ALPHA)}},{key:"setBlendUnified",value:function(t,e){this.blendFuncSeparate=!1,this.sourceBlend=t,this.destinationBlend=e}},{key:"setBlendSeparate",value:function(t,e,n,r){this.blendFuncSeparate=!0,this.sourceBlendRGB=t,this.sourceBlendAlpha=n,this.destinationBlendRGB=e,this.destinationBlendAlpha=r}},{key:"setCullingBackFace",value:function(){this.culling=dn.BACK}},{key:"setCullingFrontFace",value:function(){this.culling=dn.FRONT}},{key:"setCullingDisabled",value:function(){this.culling=dn.NONE}},{key:"setDrawTypePoints",value:function(){this.drawType=dn.POINTS}},{key:"setDrawTypeLines",value:function(){this.drawType=dn.LINES}},{key:"setDrawTypeLineStrip",value:function(){this.drawType=dn.LINE_STRIP}},{key:"setDrawTypeTriangles",value:function(){this.drawType=dn.TRIANGLES}},{key:"setDrawTypeTriangleFan",value:function(){this.drawType=dn.TRIANGLE_FAN}},{key:"setDrawTypeTriangleStrip",value:function(){this.drawType=dn.TRIANGLE_STRIP}},{key:"setFloat",value:function(t,e){var n=this.getUniformLocation(t);n&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniform1f(n,e))}},{key:"setInt",value:function(t,e){var n=this.getUniformLocation(t);n&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniform1i(n,e))}},{key:"setFloats",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=this.getUniformLocation(t);a&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniform4f(a,e,n,r,i))}},{key:"setMatrix",value:function(t,e){var n=this.getUniformLocation(t);n&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniformMatrix4fv(n,!1,e.m))}},{key:"setMatrix3x3",value:function(t,e){var n=this.getUniformLocation(t);n&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniformMatrix3fv(n,!1,e.m))}},{key:"setMatrix2x2",value:function(t,e){var n=this.getUniformLocation(t);n&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniformMatrix2fv(n,!1,e.m))}},{key:"setMatrixArray",value:function(t,e){for(var n=0;n<e.length;n++){var r=t+"["+n+"]";this.setMatrix(r,e[n])}}},{key:"setMatrixArray2",value:function(t,e){var n=this.getUniformLocation(t);n&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniformMatrix4fv(n,!1,e.m))}},{key:"setMatrixFloatArray",value:function(t,e){var n=this.getUniformLocation(t);n&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniformMatrix4fv(n,!1,e))}},{key:"setTexture",value:function(t,e){if(!this.shader)throw new ReferenceError("Material has no Shader");var n=this.shader.getTextureUniformByName(t);n&&n.set(e)}},{key:"unSetTexture",value:function(t){var e=this.shader.getTextureUniformByName(t);e&&e.unSet()}},{key:"setFloat32Array",value:function(t,e){var n=this.getUniformLocation(t);n&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniform1fv(n,e))}},{key:"setInt32Array",value:function(t,e){var n=this.getUniformLocation(t);n&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniform1iv(n,e))}},{key:"setColor",value:function(t,e){var n=this.getUniformLocation(t);n&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniform4f(n,e.r,e.g,e.b,e.a))}},{key:"setVector3",value:function(t,e){var n=this.getUniformLocation(t);n&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniform3f(n,e.x,e.y,e.z))}},{key:"setVector3Array",value:function(t,e){var n=this.getUniformLocation(t);n&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniform3fv(n,e))}},{key:"setVector2",value:function(t,e){var n=this.getUniformLocation(t);n&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniform2f(n,e.x,e.y))}},{key:"setVector2Array",value:function(t,e){var n=this.getUniformLocation(t);n&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniform2fv(n,e))}},{key:"setVector4",value:function(t,e){var n=this.getUniformLocation(t);n&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniform4f(n,e.x,e.y,e.z,e.w))}},{key:"setVector4Array",value:function(t,e){var n=this.getUniformLocation(t);n&&(this.renderer.renderState.setProgram(this.shader.program),this.renderer.context.uniform4fv(n,e))}},{key:"getUniformLocation",value:function(t){return this.shader.getUniformLocation(t)}},{key:"hasUniform",value:function(t){return!!this.getUniformLocation(t)}},{key:"addFloatUniform",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new mn(this,t,e)}},{key:"addVector2Uniform",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new vn;return new yn(this,t,e)}},{key:"addVector3Uniform",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Oe;return new gn(this,t,e)}},{key:"addShaderDefines",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0;r<e.length;r++){var i=e[r]instanceof Array?e[r][0]:e[r],a=e[r]instanceof Array?e[r][1]:1;void 0==this._shaderDefines[i]&&(this._shaderDefines[i]=a)}}},{key:"getShaderDefines",value:function(){return this._shaderDefines}},{key:"clearShaderDefines",value:function(){this._shaderDefines=[]}},{key:"destruct",value:function(){this.isDestructed||this.shader.destruct(),we()(H()(n.prototype),"destruct",this).call(this)}}]),n}(xe);En.staticId=0;var Tn=function t(e,n,r){N()(this,t),this.name=e,this.stride=n,this.loc=r},An=function(){function t(e,n,r,i){if(N()(this,t),this.texture=void 0,this.name=n,this.samplerIndex=i,!e.program)throw new ReferenceError("Cannot construct TextureUniform from shader: shader is not yet initialized.");e.renderer.renderState.setProgram(e.program),e.renderer.context.uniform1i(r,i)}return F()(t,[{key:"set",value:function(t){this.texture=t}},{key:"unSet",value:function(){this.texture&&this.texture.renderer.renderState.unBindTextureFromSlot(this.texture.textureGL,this.samplerIndex)}},{key:"bind",value:function(){this.texture&&this.texture.bindToSlot(this.samplerIndex)}}]),t}(),Rn=function t(){N()(this,t)};Rn.READ_BUFFER=3074,Rn.UNPACK_ROW_LENGTH=3314,Rn.UNPACK_SKIP_ROWS=3315,Rn.UNPACK_SKIP_PIXELS=3316,Rn.PACK_ROW_LENGTH=3330,Rn.PACK_SKIP_ROWS=3331,Rn.PACK_SKIP_PIXELS=3332,Rn.COLOR=6144,Rn.DEPTH=6145,Rn.STENCIL=6146,Rn.RED=6403,Rn.RGB8=32849,Rn.RGBA8=32856,Rn.RGB10_A2=32857,Rn.TEXTURE_BINDING_3D=32874,Rn.UNPACK_SKIP_IMAGES=32877,Rn.UNPACK_IMAGE_HEIGHT=32878,Rn.TEXTURE_3D=32879,Rn.TEXTURE_WRAP_R=32882,Rn.MAX_3D_TEXTURE_SIZE=32883,Rn.UNSIGNED_INT_2_10_10_10_REV=33640,Rn.MAX_ELEMENTS_VERTICES=33e3,Rn.MAX_ELEMENTS_INDICES=33001,Rn.TEXTURE_MIN_LOD=33082,Rn.TEXTURE_MAX_LOD=33083,Rn.TEXTURE_BASE_LEVEL=33084,Rn.TEXTURE_MAX_LEVEL=33085,Rn.MIN=32775,Rn.MAX=32776,Rn.DEPTH_COMPONENT24=33190,Rn.MAX_TEXTURE_LOD_BIAS=34045,Rn.TEXTURE_COMPARE_MODE=34892,Rn.TEXTURE_COMPARE_FUNC=34893,Rn.CURRENT_QUERY=34917,Rn.QUERY_RESULT=34918,Rn.QUERY_RESULT_AVAILABLE=34919,Rn.STREAM_READ=35041,Rn.STREAM_COPY=35042,Rn.STATIC_READ=35045,Rn.STATIC_COPY=35046,Rn.DYNAMIC_READ=35049,Rn.DYNAMIC_COPY=35050,Rn.MAX_DRAW_BUFFERS=34852,Rn.DRAW_BUFFER0=34853,Rn.DRAW_BUFFER1=34854,Rn.DRAW_BUFFER2=34855,Rn.DRAW_BUFFER3=34856,Rn.DRAW_BUFFER4=34857,Rn.DRAW_BUFFER5=34858,Rn.DRAW_BUFFER6=34859,Rn.DRAW_BUFFER7=34860,Rn.DRAW_BUFFER8=34861,Rn.DRAW_BUFFER9=34862,Rn.DRAW_BUFFER10=34863,Rn.DRAW_BUFFER11=34864,Rn.DRAW_BUFFER12=34865,Rn.DRAW_BUFFER13=34866,Rn.DRAW_BUFFER14=34867,Rn.DRAW_BUFFER15=34868,Rn.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657,Rn.MAX_VERTEX_UNIFORM_COMPONENTS=35658,Rn.SAMPLER_3D=35679,Rn.SAMPLER_2D_SHADOW=35682,Rn.FRAGMENT_SHADER_DERIVATIVE_HINT=35723,Rn.PIXEL_PACK_BUFFER=35051,Rn.PIXEL_UNPACK_BUFFER=35052,Rn.PIXEL_PACK_BUFFER_BINDING=35053,Rn.PIXEL_UNPACK_BUFFER_BINDING=35055,Rn.FLOAT_MAT2x3=35685,Rn.FLOAT_MAT2x4=35686,Rn.FLOAT_MAT3x2=35687,Rn.FLOAT_MAT3x4=35688,Rn.FLOAT_MAT4x2=35689,Rn.FLOAT_MAT4x3=35690,Rn.SRGB=35904,Rn.SRGB8=35905,Rn.SRGB8_ALPHA8=35907,Rn.COMPARE_REF_TO_TEXTURE=34894,Rn.RGBA32F=34836,Rn.RGB32F=34837,Rn.RGBA16F=34842,Rn.RGB16F=34843,Rn.VERTEX_ATTRIB_ARRAY_INTEGER=35069,Rn.MAX_ARRAY_TEXTURE_LAYERS=35071,Rn.MIN_PROGRAM_TEXEL_OFFSET=35076,Rn.MAX_PROGRAM_TEXEL_OFFSET=35077,Rn.MAX_VARYING_COMPONENTS=35659,Rn.TEXTURE_2D_ARRAY=35866,Rn.TEXTURE_BINDING_2D_ARRAY=35869,Rn.R11F_G11F_B10F=35898,Rn.UNSIGNED_INT_10F_11F_11F_REV=35899,Rn.RGB9_E5=35901,Rn.UNSIGNED_INT_5_9_9_9_REV=35902,Rn.TRANSFORM_FEEDBACK_BUFFER_MODE=35967,Rn.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968,Rn.TRANSFORM_FEEDBACK_VARYINGS=35971,Rn.TRANSFORM_FEEDBACK_BUFFER_START=35972,Rn.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973,Rn.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976,Rn.RASTERIZER_DISCARD=35977,Rn.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978,Rn.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979,Rn.INTERLEAVED_ATTRIBS=35980,Rn.SEPARATE_ATTRIBS=35981,Rn.TRANSFORM_FEEDBACK_BUFFER=35982,Rn.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983,Rn.RGBA32UI=36208,Rn.RGB32UI=36209,Rn.RGBA16UI=36214,Rn.RGB16UI=36215,Rn.RGBA8UI=36220,Rn.RGB8UI=36221,Rn.RGBA32I=36226,Rn.RGB32I=36227,Rn.RGBA16I=36232,Rn.RGB16I=36233,Rn.RGBA8I=36238,Rn.RGB8I=36239,Rn.RED_INTEGER=36244,Rn.RGB_INTEGER=36248,Rn.RGBA_INTEGER=36249,Rn.SAMPLER_2D_ARRAY=36289,Rn.SAMPLER_2D_ARRAY_SHADOW=36292,Rn.SAMPLER_CUBE_SHADOW=36293,Rn.UNSIGNED_INT_VEC2=36294,Rn.UNSIGNED_INT_VEC3=36295,Rn.UNSIGNED_INT_VEC4=36296,Rn.INT_SAMPLER_2D=36298,Rn.INT_SAMPLER_3D=36299,Rn.INT_SAMPLER_CUBE=36300,Rn.INT_SAMPLER_2D_ARRAY=36303,Rn.UNSIGNED_INT_SAMPLER_2D=36306,Rn.UNSIGNED_INT_SAMPLER_3D=36307,Rn.UNSIGNED_INT_SAMPLER_CUBE=36308,Rn.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311,Rn.DEPTH_COMPONENT32F=36012,Rn.DEPTH32F_STENCIL8=36013,Rn.FLOAT_32_UNSIGNED_INT_24_8_REV=36269,Rn.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296,Rn.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297,Rn.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298,Rn.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299,Rn.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300,Rn.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301,Rn.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302,Rn.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303,Rn.FRAMEBUFFER_DEFAULT=33304,Rn.DEPTH_STENCIL_ATTACHMENT=33306,Rn.DEPTH_STENCIL=34041,Rn.UNSIGNED_INT_24_8=34042,Rn.DEPTH24_STENCIL8=35056,Rn.UNSIGNED_NORMALIZED=35863,Rn.DRAW_FRAMEBUFFER_BINDING=36006,Rn.READ_FRAMEBUFFER=36008,Rn.DRAW_FRAMEBUFFER=36009,Rn.READ_FRAMEBUFFER_BINDING=36010,Rn.RENDERBUFFER_SAMPLES=36011,Rn.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052,Rn.MAX_COLOR_ATTACHMENTS=36063,Rn.COLOR_ATTACHMENT1=36065,Rn.COLOR_ATTACHMENT2=36066,Rn.COLOR_ATTACHMENT3=36067,Rn.COLOR_ATTACHMENT4=36068,Rn.COLOR_ATTACHMENT5=36069,Rn.COLOR_ATTACHMENT6=36070,Rn.COLOR_ATTACHMENT7=36071,Rn.COLOR_ATTACHMENT8=36072,Rn.COLOR_ATTACHMENT9=36073,Rn.COLOR_ATTACHMENT10=36074,Rn.COLOR_ATTACHMENT11=36075,Rn.COLOR_ATTACHMENT12=36076,Rn.COLOR_ATTACHMENT13=36077,Rn.COLOR_ATTACHMENT14=36078,Rn.COLOR_ATTACHMENT15=36079,Rn.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182,Rn.MAX_SAMPLES=36183,Rn.HALF_FLOAT=5131,Rn.RG=33319,Rn.RG_INTEGER=33320,Rn.R8=33321,Rn.RG8=33323,Rn.R16F=33325,Rn.R32F=33326,Rn.RG16F=33327,Rn.RG32F=33328,Rn.R8I=33329,Rn.R8UI=33330,Rn.R16I=33331,Rn.R16UI=33332,Rn.R32I=33333,Rn.R32UI=33334,Rn.RG8I=33335,Rn.RG8UI=33336,Rn.RG16I=33337,Rn.RG16UI=33338,Rn.RG32I=33339,Rn.RG32UI=33340,Rn.VERTEX_ARRAY_BINDING=34229,Rn.R8_SNORM=36756,Rn.RG8_SNORM=36757,Rn.RGB8_SNORM=36758,Rn.RGBA8_SNORM=36759,Rn.SIGNED_NORMALIZED=36764,Rn.COPY_READ_BUFFER=36662,Rn.COPY_WRITE_BUFFER=36663,Rn.COPY_READ_BUFFER_BINDING=36662,Rn.COPY_WRITE_BUFFER_BINDING=36663,Rn.UNIFORM_BUFFER=35345,Rn.UNIFORM_BUFFER_BINDING=35368,Rn.UNIFORM_BUFFER_START=35369,Rn.UNIFORM_BUFFER_SIZE=35370,Rn.MAX_VERTEX_UNIFORM_BLOCKS=35371,Rn.MAX_FRAGMENT_UNIFORM_BLOCKS=35373,Rn.MAX_COMBINED_UNIFORM_BLOCKS=35374,Rn.MAX_UNIFORM_BUFFER_BINDINGS=35375,Rn.MAX_UNIFORM_BLOCK_SIZE=35376,Rn.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377,Rn.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379,Rn.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380,Rn.ACTIVE_UNIFORM_BLOCKS=35382,Rn.UNIFORM_TYPE=35383,Rn.UNIFORM_SIZE=35384,Rn.UNIFORM_BLOCK_INDEX=35386,Rn.UNIFORM_OFFSET=35387,Rn.UNIFORM_ARRAY_STRIDE=35388,Rn.UNIFORM_MATRIX_STRIDE=35389,Rn.UNIFORM_IS_ROW_MAJOR=35390,Rn.UNIFORM_BLOCK_BINDING=35391,Rn.UNIFORM_BLOCK_DATA_SIZE=35392,Rn.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394,Rn.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395,Rn.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396,Rn.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398,Rn.INVALID_INDEX=4294967295,Rn.MAX_VERTEX_OUTPUT_COMPONENTS=37154,Rn.MAX_FRAGMENT_INPUT_COMPONENTS=37157,Rn.MAX_SERVER_WAIT_TIMEOUT=37137,Rn.OBJECT_TYPE=37138,Rn.SYNC_CONDITION=37139,Rn.SYNC_STATUS=37140,Rn.SYNC_FLAGS=37141,Rn.SYNC_FENCE=37142,Rn.SYNC_GPU_COMMANDS_COMPLETE=37143,Rn.UNSIGNALED=37144,Rn.SIGNALED=37145,Rn.ALREADY_SIGNALED=37146,Rn.TIMEOUT_EXPIRED=37147,Rn.CONDITION_SATISFIED=37148,Rn.WAIT_FAILED=37149,Rn.SYNC_FLUSH_COMMANDS_BIT=1,Rn.VERTEX_ATTRIB_ARRAY_DIVISOR=35070,Rn.ANY_SAMPLES_PASSED=35887,Rn.ANY_SAMPLES_PASSED_CONSERVATIVE=36202,Rn.SAMPLER_BINDING=35097,Rn.RGB10_A2UI=36975,Rn.INT_2_10_10_10_REV=36255,Rn.TRANSFORM_FEEDBACK=36386,Rn.TRANSFORM_FEEDBACK_PAUSED=36387,Rn.TRANSFORM_FEEDBACK_ACTIVE=36388,Rn.TRANSFORM_FEEDBACK_BINDING=36389,Rn.TEXTURE_IMMUTABLE_FORMAT=37167,Rn.MAX_ELEMENT_INDEX=36203,Rn.TEXTURE_IMMUTABLE_LEVELS=33503;var bn=Rn;function wn(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Sn=function(t){U()(n,t);var e=wn(n);function n(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return N()(this,n),(r=e.call(this)).textureUniforms=void 0,r.uniformLocationsByName=void 0,r.vShaderSource="",r.fShaderSource="",r.compileStatusChecked=!1,r.id=n.staticId++,r.renderer=t,r.shaderDefines=i,r}return F()(n,[{key:"load",value:function(t,e,n){var r=this;Promise.all([e.loadAssetByName("".concat(t,".vs.glsl")),e.loadAssetByName("".concat(t,".fs.glsl"))]).then((function(i){r.loadIncludes(i,e,(function(e){r.init(t,e[0],e[1],n)}))}))}},{key:"loadIncludes",value:function(t,e,n){for(var r=this,i=/^#include\s+(\S+)/,a=[],o=0;o<t.length;o++)for(var s=t[o].split("\n"),l=0;l<s.length;l++){var u=s[l];u=u.trim();var c;null!==(c=i.exec(u))&&a.push([c[1],c])}if(a.length){for(var f=[],h=0;h<a.length;h++)f[h]=a[h][0];Promise.all(f.map((function(t){return e.loadAssetByPath(t)}))).then((function(i){for(var o=0;o<t.length;o++)for(var s=0;s<a.length;s++)t[o]=t[o].replace(a[s][1][0],"\n\n///// Start "+f[s]+"\n\n"+i[s]+"\n\n///// End "+f[s]+"\n\n");r.loadIncludes(t,e,n)}))}else n.call(this,t)}},{key:"init",value:function(t,e,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(this.name=t,this.shaderDefines){var a="",o=0;for(var s in this.shaderDefines)a+="#define "+s+" "+this.shaderDefines[s]+"\n",o++;o>0&&(e=a+e,r=a+r)}e=n.stripUniformDuplicates(e),r=n.stripUniformDuplicates(r),this.vShaderSource=this.renderer.preprocessShaderString(e),this.fShaderSource=this.renderer.preprocessShaderString(r);var l=this.renderer.context;return this.vShader=n.compileShader(l,this.vShaderSource,l.VERTEX_SHADER),this.fShader=n.compileShader(l,this.fShaderSource,l.FRAGMENT_SHADER),this.program=n.LinkProgram(l,this.vShader,this.fShader),i&&i.call(this),this}},{key:"checkCompileStatus",value:function(){if(!this.compileStatusChecked){this.compileStatusChecked=!0;var t=this.renderer.context;if(t.getProgramParameter(this.program,t.LINK_STATUS))return;throw this.showErrorLog(t.getShaderInfoLog(this.vShader),this.vShaderSource),this.showErrorLog(t.getShaderInfoLog(this.fShader),this.fShaderSource),this.showErrorLog(t.getProgramInfoLog(this.program),this.fShaderSource),new Error("unable to compile shader")}}},{key:"showErrorLog",value:function(t,e){if(t){Se.error("compileShader: error: "+this.name+" \n"+t),console.log("%c compileShader: "+this.name,"background: #fff0f0; color: red"),console.log(t);for(var n=/ERROR: (\d+):(\d+):/,r=t.split("\n"),i=[],a=0;a<r.length;a++){var o,s=r[a];null!==(o=n.exec(s))&&(i[parseInt(o[2],10)-1]=s)}r=e.split("\n");var l=[];l[0]="";for(var u=0;u<r.length;u++)l[0]+="%c"+r[u]+"\n",l[u+1]=i[u]?"background: #fff0f0; color: red":"background: white; color: black",i[u]&&(l[0]+=" --\x3e "+i[u]+"\n");console.log.apply(console,l),console.log("%c compileShader: "+this.name,"background: #fff0f0; color: red")}}},{key:"getUniformLocation",value:function(t){this.uniformLocationsByName||this.getTextureUniforms();var e=this.uniformLocationsByName[t];if(void 0===e){var n=this.renderer.context.getUniformLocation(this.program,t)||!1;this.uniformLocationsByName[t]=n}return e}},{key:"getTextureUniforms",value:function(){if(!this.textureUniforms){this.checkCompileStatus();var t=this.renderer.context,e=t.getProgramParameter(this.program,t.ACTIVE_UNIFORMS);this.textureUniforms=[],this.uniformLocationsByName={};for(var n=0,r=0;r<e;r++){var i=t.getActiveUniform(this.program,r),a=t.getUniformLocation(this.program,i.name);this.uniformLocationsByName[i.name]=a,i.type!==dn.SAMPLER_2D&&i.type!==dn.SAMPLER_CUBE&&i.type!==bn.SAMPLER_3D||(this.textureUniforms.push(new An(this,i.name,a,n)),n++)}}return this.textureUniforms}},{key:"getAttributes",value:function(){if(!this.attributes){this.checkCompileStatus();var t=this.renderer.context,e=t.getProgramParameter(this.program,t.ACTIVE_ATTRIBUTES);this.attributes=[];for(var r=0;r<e;r++){var i=t.getActiveAttrib(this.program,r),a=t.getAttribLocation(this.program,i.name),o=n.getStride(i.type);this.attributes.push(new Tn(i.name,o,a))}}return this.attributes}},{key:"getAttributeByName",value:function(t){return(this.attributes||this.getAttributes()).find((function(e){return e.name===t}))}},{key:"getTextureUniformByName",value:function(t){return(this.textureUniforms||this.getTextureUniforms()).find((function(e){return e.name===t}))}},{key:"destruct",value:function(){var t=this.renderer.context;t.deleteShader(this.vShader),t.deleteShader(this.fShader),t.deleteProgram(this.program),we()(H()(n.prototype),"destruct",this).call(this)}}],[{key:"stripUniformDuplicates",value:function(t){for(var e="",n={},r=/^uniform\s+(\S*)\s+(\S*);/,i=t.split("\n"),a=0;a<i.length;a++){var o=i[a];o=o.trim();var s;if(null!==(s=r.exec(o))){var l=s[2];n[l]&&(o="// "+o),n[l]=!0}e+=o+"\n"}return e}},{key:"compileShader",value:function(t,e,n){var r=t.createShader(n);return t.shaderSource(r,e),t.compileShader(r),r}},{key:"LinkProgram",value:function(t,e,n){var r=t.createProgram();return t.attachShader(r,e),t.attachShader(r,n),t.linkProgram(r),r}},{key:"getStride",value:function(t){switch(t){case dn.FLOAT:return 1;case dn.FLOAT_VEC2:return 2;case dn.FLOAT_VEC3:return 3;case dn.FLOAT_VEC4:return 4;default:return Se.error("attribute type not handled: "+t),-1}}}]),n}(xe);function xn(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}Sn.staticId=0;var kn=function(t){U()(n,t);var e=xn(n);function n(t,r,i){var a;return N()(this,n),(a=e.call(this,t,i,new Sn(t))).shaderIndex=t.shaderIndex,a.shaderName=i,r.add(Ke()(a)),a}return F()(n,[{key:"load",value:function(t){var e=this;this.shader.shaderDefines=this.getShaderDefines(),this.shader.load(this.shaderName,this.shaderIndex,(function(){t.call(e)}))}}]),n}(En);function Mn(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Cn=function(t){U()(n,t);var e=Mn(n);function n(t){var r;return N()(this,n),(r=e.call(this)).depthMask=!0,r.depthTest=!0,r.alphaToCoverage=!0,r.depthFunc=-1,r.culling=-1,r.cullingEnabled=!0,r.blendEquation=-1,r.blendEnabled=!0,r.sourceBlend=-1,r.destinationBlend=-1,r.renderer=t,r.setBlendEnabled(!r.blendEnabled),r.setCullingEnabled(!r.cullingEnabled),r.setDepthMask(!r.depthMask),r.setDepthTest(!r.depthTest),r.enabledAttribArrays=[],r.textureSlots=[],r}return F()(n,[{key:"bindTextureToSlot",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.textureSlots[e]!=t.textureGL&&(this.renderer.context.activeTexture(dn.TEXTURE0+e),this.renderer.context.bindTexture(t.target,t.textureGL),this.textureSlots[e]=t.textureGL)}},{key:"activateSlot",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.renderer.context.activeTexture(dn.TEXTURE0+t)}},{key:"unBindTextureFromSlot",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.textureSlots[e]==t&&(this.renderer.context.activeTexture(dn.TEXTURE0+e),this.renderer.context.bindTexture(dn.TEXTURE_2D,null),this.textureSlots[e]=void 0)}},{key:"setProgram",value:function(t){return t!=this.program&&(this.program=t,this.renderer.context.useProgram(this.program),!0)}},{key:"setDepthMask",value:function(t){t!=this.depthMask&&(this.renderer.context.depthMask(t),this.depthMask=t)}},{key:"getDepthMask",value:function(){return this.depthMask}},{key:"setAlphaToCoverage",value:function(t){t!=this.alphaToCoverage&&(t?this.renderer.context.enable(dn.SAMPLE_ALPHA_TO_COVERAGE):this.renderer.context.disable(dn.SAMPLE_ALPHA_TO_COVERAGE),this.alphaToCoverage=t)}},{key:"setDepthTest",value:function(t){t!=this.depthTest&&(t?this.renderer.context.enable(dn.DEPTH_TEST):this.renderer.context.disable(dn.DEPTH_TEST),this.depthTest=t)}},{key:"setDepthFunc",value:function(t){t!=this.depthFunc&&(t?this.renderer.context.depthFunc(t):this.renderer.context.depthFunc(this.renderer.context.LESS),this.depthFunc=t)}},{key:"setCullingEnabled",value:function(t){t!=this.cullingEnabled&&(t?this.renderer.context.enable(dn.CULL_FACE):this.renderer.context.disable(dn.CULL_FACE),this.cullingEnabled=t)}},{key:"setCulling",value:function(t){t!=this.culling&&(t==dn.NONE?this.setCullingEnabled(!1):(this.setCullingEnabled(!0),this.renderer.context.cullFace(t)),this.culling=t)}},{key:"setBlendEquation",value:function(t){t!=this.blendEquation&&(this.renderer.context.blendEquation(t),this.blendEquation=t)}},{key:"setBlendEnabled",value:function(t){t!=this.blendEnabled&&(t?this.renderer.context.enable(dn.BLEND):this.renderer.context.disable(dn.BLEND),this.blendEnabled=t)}},{key:"setBlendFunc",value:function(t,e){t==this.sourceBlend&&e==this.destinationBlend||(this.renderer.context.blendFunc(t,e),this.sourceBlend=t,this.destinationBlend=e)}},{key:"setBlendFuncSeparate",value:function(t,e,n,r){this.renderer.context.blendFuncSeparate(t,e,n,r),this.sourceBlend=-1}}]),n}(xe),In=function(){function t(){N()(this,t),this.maxAnisotropy=0}return F()(t,[{key:"enableExtensions",value:function(e){this.color_buffer_float=t.enableExtension(e,"WEBGL_color_buffer_float")||t.enableExtension(e,"EXT_color_buffer_float"),this.color_buffer_half_float=t.enableExtension(e,"EXT_color_buffer_half_float"),this.texture_float=t.enableExtension(e,"OES_texture_float"),this.texture_float_linear=t.enableExtension(e,"OES_texture_float_linear"),this.texture_half_float=t.enableExtension(e,"OES_texture_half_float"),this.texture_half_float_linear=t.enableExtension(e,"OES_texture_half_float_linear"),this.shader_texture_lod=t.enableExtension(e,"EXT_shader_texture_lod"),this.standard_derivatives=t.enableExtension(e,"OES_standard_derivatives"),this.blend_minmax=t.enableExtension(e,"EXT_blend_minmax"),this.seamless_cube_map=t.enableExtension(e,"OES_seamless_cube_map"),this.vertex_array_object=t.enableExtension(e,"OES_vertex_array_object"),this.filter_anisotropic=t.enableExtension(e,"texture_filter_anisotropic"),this.filter_anisotropic||(this.filter_anisotropic=t.enableExtension(e,"MOZ_EXT_texture_filter_anisotropic")),this.filter_anisotropic||(this.filter_anisotropic=t.enableExtension(e,"WEBKIT_EXT_texture_filter_anisotropic")),this.filter_anisotropic&&(this.maxAnisotropy=e.getParameter(this.filter_anisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT),Se.log("MAX_TEXTURE_MAX_ANISOTROPY_EXT: ",this.maxAnisotropy)),this.frag_depth=t.enableExtension(e,"EXT_frag_depth"),this.depth_texture=t.enableExtension(e,"WEBGL_depth_texture"),this.element_index_uint=t.enableExtension(e,"OES_element_index_uint"),this.enableTextureCompression(e)}},{key:"enableTextureCompression",value:function(e){var n=t.enableExtension(e,"WEBKIT_WEBGL_compressed_texture_s3tc");if(n){var r=e.getParameter(e.COMPRESSED_TEXTURE_FORMATS);if(r.length>0)for(var i in r)r[i]===n.COMPRESSED_RGB_S3TC_DXT1_EXT&&Se.log("support found for texture compression: RGB_S3TC_DXT1"),r[i]===n.COMPRESSED_RGBA_S3TC_DXT1_EXT&&Se.log("support found for texture compression: RGBA_S3TC_DXT1"),r[i]===n.COMPRESSED_RGBA_S3TC_DXT3_EXT&&Se.log("support found for texture compression: RGBA_S3TC_DXT3"),r[i]===n.COMPRESSED_RGBA_S3TC_DXT5_EXT&&Se.log("support found for texture compression: RGBA_S3TC_DXT5");else Se.log("no support found for texture compression ")}}},{key:"getMinMaxSupported",value:function(){return null!==this.blend_minmax}}],[{key:"enableExtension",value:function(t,e){var n=t.getExtension(e);return n?Se.log("enabled extension "+e):Se.log("extension "+e+" is not supported"),n}}]),t}(),Pn=function(){function t(){N()(this,t)}return F()(t,null,[{key:"cacheIsPathRequested",value:function(e){return t.clientCache[e]}},{key:"cacheRegisterRequested",value:function(e,n){t.clientCache[e]=n}},{key:"cacheRegisterCallback",value:function(e,n){t.clientCacheCallbacks[e]||(t.clientCacheCallbacks[e]=[]),t.clientCacheCallbacks[e].push(n)}},{key:"cacheRequestDone",value:function(e,n){var r=t.clientCacheCallbacks[e];if(r)for(var i=0;i<r.length;i++)r[i](n);t.clientCacheCallbacks[e]=null,t.clientCache[e]=!1}},{key:"cacheRequestError",value:function(e){var n=t.clientCacheCallbacks[e];if(n)for(var r=0;r<n.length;r++)n[r](null);t.clientCacheCallbacks[e]=null,t.clientCache[e]=!1}},{key:"loadText",value:function(e,n){if(t.cacheRegisterCallback(e,n),!t.cacheIsPathRequested(e)){var r=new XMLHttpRequest;t.cacheRegisterRequested(e,r),r.onreadystatechange=function(n){4===r.readyState&&(200===r.status?t.cacheRequestDone(e,r.responseText):t.cacheRequestError(e))},r.open("GET",e,!0),r.send()}}},{key:"loadArrayBuffer",value:function(e,n){if(t.cacheRegisterCallback(e,n),!t.cacheIsPathRequested(e)){var r=new XMLHttpRequest;t.cacheRegisterRequested(e,r),r.open("GET",e,!0),r.responseType="arraybuffer",r.send(),r.onreadystatechange=function(n){4===r.readyState&&t.cacheRequestDone(e,r.response)}}}},{key:"loadImage",value:function(e,n){if("string"!==typeof e&&(e=e.default),t.cacheRegisterCallback(e,n),t.cacheIsPathRequested(e))return t.cacheIsPathRequested(e);var r=new Image;return t.cacheRegisterRequested(e,r),r.crossOrigin="Anonymous",r.onload=function(){t.cacheRequestDone(e,r)},r.onerror=function(){console.log("TextureLoader: could not load image",e),t.cacheRequestDone(e,r)},r.src=e,r}},{key:"loadMultipleImages",value:function(e,n){for(var r=this,i=e.length,a=[],o=function(t){return function(e){i--,a[t]=e,0===i&&n.call(r,a)}},s=0;s<e.length;++s)t.loadImage(e[s],o(s))}},{key:"loadSingleFromRequireContext",value:function(t,e){return new Promise((function(n,r){var i;try{i=t("./".concat(e.replace(/^\.\//,"")))}catch(a){r(a)}"function"===typeof i?i(n):n(i.default)}))}},{key:"loadFromRequireContext",value:function(e,n,r){Promise.all(n.map((function(n){return t.loadSingleFromRequireContext(e,n)}))).then((function(t){return r(t)}))}},{key:"loadMultipleTexts",value:function(e,n){for(var r=this,i=e.length,a=[],o=function(t){return function(e){i--,a[t]=e,0===i&&n.apply(r,a)}},s=0;s<e.length;++s)t.loadText(e[s],o(s))}}]),t}();Pn.clientCache={},Pn.clientCacheCallbacks={};var Dn=function(){function t(){N()(this,t),this.webpackContexts=[],this.assetNameMap={},this.assetPathMap={}}return F()(t,[{key:"loadAssetByPath",value:function(t){var e=this.getAssetByPath(t);return Pn.loadSingleFromRequireContext(e.webpackContext,e.path)}},{key:"getAssetByPath",value:function(t){var e="./".concat(t.replace(/^\.\//,""));if("undefined"===typeof this.assetPathMap[e])throw new ReferenceError("Could not find asset with path ".concat(t,". Available paths: \n").concat(Object.keys(this.assetPathMap).join("\n")));return{webpackContext:this.webpackContexts[this.assetPathMap[e]],path:e}}},{key:"loadAssetByName",value:function(t){var e=this.getAssetByName(t);return Pn.loadSingleFromRequireContext(e.webpackContext,e.path)}},{key:"getAssetByName",value:function(t){if("undefined"===typeof this.assetNameMap[t])throw new ReferenceError('Could not find asset with name "'.concat(t,'". Available assets: \n').concat(Object.keys(this.assetNameMap.vs).join(", ")));return{webpackContext:this.webpackContexts[this.assetNameMap[t].contextIndex],path:this.assetNameMap[t].path}}},{key:"addContext",value:function(t){var e=this;if(!(this.webpackContexts.indexOf(t)>=0)){var n=this.webpackContexts.length;this.webpackContexts.push(t),t.keys().forEach((function(t){var r=t.match(/([^\\\/]+)$/);if(r){if(e.assetNameMap[r[1]]){var i=e.webpackContexts[e.assetNameMap[r[1]].contextIndex].resolve(e.assetNameMap[r[1]].path);console.warn('WARNING: found asset "'.concat(t,'" but another asset with the name "').concat(r[1],'" was already found at "').concat(i,'"'))}e.assetNameMap[r[1]]={contextIndex:n,path:t}}e.assetPathMap[t]=n}))}}}]),t}();function On(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Nn=function(t){U()(n,t);var e=On(n);function n(t,r,i,a,o,s){var l;return N()(this,n),(l=e.call(this)).data=null,l.vertexCount=-1,l._renderer=t,l.stride=a,l.name=r,l.storeData=o,l.vertexCount=i.length/a,s?(l.buffer=l._renderer.context.createBuffer(),l.setData(i,o)):l.data=i,l}return F()(n,[{key:"setData",value:function(t,e){if(e||!this.buffer?this.data=t:this.data=null,0!==t.length){if(this.buffer){var n=this._renderer.context;n.bindBuffer(dn.ARRAY_BUFFER,this.buffer),n.bufferData(dn.ARRAY_BUFFER,t.byteLength,dn.STATIC_DRAW),n.bufferSubData(dn.ARRAY_BUFFER,0,t)}}else console.warn("VertexAttribute: no data: probably a mesh file could not be loaded: "+this.name)}},{key:"getBufferLength",value:function(){if(this.data)return this.data.length;if(!this.buffer)throw new ReferenceError("Cannot get buffer length: no buffer set on VertextAttribute");var t=this._renderer.context;return t.bindBuffer(dn.ARRAY_BUFFER,this.buffer),t.getBufferParameter(dn.ARRAY_BUFFER,dn.BUFFER_SIZE)/4}},{key:"destruct",value:function(){if(!this.isDestructed){var t=this._renderer.context;this.buffer&&t.deleteBuffer(this.buffer),this.data=null,we()(H()(n.prototype),"destruct",this).call(this)}}}],[{key:"serialize",value:function(t){return null===t.data?(console.error("Trying to serialize vertex attribute "+t.name+" without saved data"),{}):{name:t.name,data:t.data,stride:t.stride,storeData:t.storeData}}},{key:"deserialize",value:function(t){return{name:t.name,data:t.data,stride:t.stride,storeData:t.storeData}}}]),n}(xe),Ln=function t(e,n){N()(this,t),this.name=e,this.stride=n};function Fn(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}Ln.POSITION=new Ln("aPos",3),Ln.TEXCOORD0=new Ln("aUV0",2),Ln.TEXCOORD1=new Ln("aUV1",2),Ln.NORMAL=new Ln("aNormal",3),Ln.COLOR0=new Ln("aColor0",3),Ln.COLOR1=new Ln("aColor1",3),Ln.TANGENT=new Ln("aTangent",4);var Bn=function(t){U()(n,t);var e=Fn(n);function n(t){var r,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return N()(this,n),(r=e.call(this))._vertexCount=0,r._isInterleavedBufferDirty=!0,r._attributeNames={},r.renderer=t,r.attributes=[],r._vertexCount=0,r.id=n.staticId++,r.interleaved=i,r.isDynamic=a,r}return F()(n,[{key:"setJSONData",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.isDynamic=t.isDynamic||!1,t.indices&&t.indices.length>0&&(t.use32BitIndices?this.setIndices32(new Uint32Array(t.indices)):this.setIndices(new Uint16Array(t.indices)));for(var n=0;n<t.attributes.length;n++){var r=t.attributes[n];this.setAttribute(r.name,r.stride,new Float32Array(r.data),e)}}},{key:"clone",value:function(){for(var t=new n(this.renderer,this.interleaved,this.isDynamic),e=0;e<this.attributes.length;e++)t.attributes.push(this.attributes[e]);return t._vertexCount=this._vertexCount,t}},{key:"interleaveData",value:function(){if(this._isInterleavedBufferDirty&&this.interleaved){this.interleavedStrideSum=0;for(var t=0;t<this.attributes.length;t++)this.interleavedStrideSum+=this.attributes[t].stride;for(var e=new Float32Array(this.interleavedStrideSum*this._vertexCount),n=0,r=0;r<this._vertexCount;r++)for(var i=0;i<this.attributes.length;i++)for(var a=this.attributes[i],o=0;o<a.stride;o++)e[n++]=a.data[r*a.stride+o];for(var s=0;s<this.attributes.length;s++)this.attributes[s].storeData||(this.attributes[s].data=null);this.interleavedBuffer=this.renderer.context.createBuffer();var l=this.renderer.context;l.bindBuffer(dn.ARRAY_BUFFER,this.interleavedBuffer),l.bufferData(dn.ARRAY_BUFFER,e,l.STATIC_DRAW),this._isInterleavedBufferDirty=!1}}},{key:"isInterleaved",value:function(){return this.interleaved}},{key:"hasIndices",value:function(){return!!this.indices}},{key:"setAttribute",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.setData(n,t,e,r)}},{key:"setPositions",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Ln.POSITION;this.setData(t,n.name,n.stride,e)}},{key:"getPositions",value:function(){return this.getData(Ln.POSITION.name)}},{key:"setNormals",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Ln.NORMAL;this.setData(t,n.name,n.stride,e)}},{key:"getNormals",value:function(){return this.getData(Ln.NORMAL.name)}},{key:"setColors",value:function(t){var e=Ln.COLOR0;this.setData(t,e.name,e.stride)}},{key:"getColors",value:function(){return this.getData(Ln.COLOR0.name)}},{key:"setColors1",value:function(t){var e=Ln.COLOR1;this.setData(t,e.name,e.stride)}},{key:"getColors1",value:function(){return this.getData(Ln.COLOR1.name)}},{key:"setUV0",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Ln.TEXCOORD0;this.setData(t,n.name,n.stride,e)}},{key:"getUV0",value:function(){return this.getData(Ln.TEXCOORD0.name)}},{key:"setUV1",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Ln.TEXCOORD1;this.setData(t,n.name,n.stride,e)}},{key:"getUV1",value:function(){return this.getData(Ln.TEXCOORD1.name)}},{key:"setTangents",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Ln.TANGENT;this.setData(t,n.name,n.stride,e)}},{key:"getTangents",value:function(){return this.getData(Ln.TANGENT.name)}},{key:"setData",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this._attributeNames={};var i=this.getAttributeIndex(e),a=t.length/n;i<0?this.attributes.push(new Nn(this.renderer,e,t,n,r,!this.interleaved)):this.attributes[i].vertexCount==a?this.attributes[i].setData(t,r):(this.attributes[i].destruct(),this.attributes[i]=new Nn(this.renderer,e,t,n,r,!this.interleaved)),this._vertexCount=a,this.interleaved&&(this._isInterleavedBufferDirty=!0)}},{key:"deleteAttribute",value:function(t){var e=this.getAttributeIndex(t);e>=0&&this.attributes.splice(e,1),this._isInterleavedBufferDirty=!0,this._attributeNames={}}},{key:"hasAttribute",value:function(t){var e=this._attributeNames[t];if(!0===e||!1===e)return e;var n=this.getAttributeIndex(t);return this._attributeNames[t]=n>=0,this._attributeNames[t]}},{key:"getAttribute",value:function(t){var e=this.getAttributeIndex(t);return e>=0?this.attributes[e]:null}},{key:"getAttributeIndex",value:function(t){for(var e=0;e<this.attributes.length;e++)if(this.attributes[e].name===t)return e;return-1}},{key:"getData",value:function(t){var e=this.getAttribute(t);return e&&e.data?e.data:(Se.log("Mesh: getData",t,"no data"),null)}},{key:"setIndices",value:function(t){if(!(t instanceof Uint16Array))throw"Indices need to be of type Uint16Array";this.indexType=dn.UNSIGNED_SHORT,this.indices=t;var e=this.renderer.context;this.indexBuffer||(this.indexBuffer=e.createBuffer()),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,e.STATIC_DRAW)}},{key:"setIndices32",value:function(t){if(!(t instanceof Uint32Array))throw"Indices need to be of type Uint32Array";if(this.renderer.extensionManager.element_index_uint||this.renderer.context instanceof WebGL2RenderingContext){this.indexType=dn.UNSIGNED_INT,this.indices=t;var e=this.renderer.context;this.indexBuffer||(this.indexBuffer=e.createBuffer()),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,e.STATIC_DRAW)}else Se.log("mesh: setIndices32: extension not supported: element_index_uint: using 16 bits indices"),this.setIndices(new Uint16Array(t))}},{key:"getNumVertices",value:function(){return this._vertexCount}},{key:"isSkinned",value:function(){return this.hasAttribute("aSkinIndex")}},{key:"destruct",value:function(){if(!this.isDestructed){this.renderer.destructVAO(this);var t=this.renderer.context;if(this.interleavedBuffer&&t.deleteBuffer(this.interleavedBuffer),this.indexBuffer&&t.deleteBuffer(this.indexBuffer),this.attributes)for(var e=0;e<this.attributes.length;e++)this.attributes[e].destruct();we()(H()(n.prototype),"destruct",this).call(this)}}}]),n}(xe);Bn.staticId=0;var Un=function(){function t(){N()(this,t),this.averageFps=60,this.manualUpdate=!1,t._instance&&alert("do not create additional instances of the time class"),this.fps=60,this.deltaTime=1/this.fps,this.time=0,this.update()}return F()(t,[{key:"updateManual",value:function(){this.manualUpdate=!0,this.updateDeltaTime()}},{key:"update",value:function(){var t=this;this.manualUpdate||(window.requestAnimationFrame((function(e){return t.update()})),this.updateDeltaTime())}},{key:"updateDeltaTime",value:function(){var t=performance.now();this.deltaTime=.001*t-this.time,this.deltaTime>.05&&(this.deltaTime=.05),0===this.deltaTime&&(this.deltaTime=1/60),this.time=.001*t,this.fps=1/this.deltaTime,this.averageFps>0?this.averageFps=Fe.lerp(this.fps,this.averageFps,.95):this.averageFps=1/60}},{key:"testPerformance",value:function(t){console.time("timer0"),t(),console.timeEnd("timer0")}}],[{key:"instance",get:function(){return t._instance||(t._instance=new t),t._instance}}]),t}();function Vn(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var zn=function t(){N()(this,t),this.down=!1,this.downThisFrame=!1,this.downByTouch=!1,this.clickCanceled=!1,this.downTime=0},Gn=function(t){U()(n,t);var e=Vn(n);function n(t,r){var i;N()(this,n),(i=e.call(this))._mousePos=new vn,i._previousMousePos=new vn,i._mouseVelocity=new vn,i._normalized=new vn,i._screen=new vn,i._wheelCallbacks=[],i._mouseClickCallbacks=[],i._mouseDownCallbacks=[],i._buttons=[],i._manualUpdate=!1,i._resetSpeed=!1,i._preventDefault=!1,i._touchStartListener=function(t){i._preventDefault&&t.preventDefault(),i._resetSpeed=!0,i.handleMouseDown(0),i._buttons[0].downByTouch=!0,i.setMousePosition(t.targetTouches[0]);for(var e=0;e<i._mouseDownCallbacks.length;e++)i._mouseDownCallbacks[e].call(Ke()(i))},i._touchMoveListener=function(t){i.setMousePosition(t.targetTouches[0]),i._preventDefault&&t.preventDefault()},i._endListener=function(){for(var t=0;t<i._buttons.length;t++)i._buttons[t].down=!1,i._buttons[t].downThisFrame=!1,i._buttons[t].downByTouch=!1},i._mouseDownListener=function(t){i._preventDefault&&t.preventDefault(),i.handleMouseDown(t.which-1),i.setMousePosition(t);for(var e=0;e<i._mouseDownCallbacks.length;e++)i._mouseDownCallbacks[e].call(Ke()(i))},i._mouseMoveListener=function(t){i.setMousePosition(t),i._preventDefault&&t.preventDefault();for(var e=0;e<3;e++)i._buttons[e].downTime>.25&&(i._buttons[e].clickCanceled=!0)},i._mouseWheelListener=function(t){for(var e=0;e<i._wheelCallbacks.length;e++)i._wheelCallbacks[e].call(Ke()(i),Math.sign(-t.deltaY))},i._upListener=function(){if(i._resetSpeed=!0,!i._buttons[0].clickCanceled)for(var t=0;t<i._mouseClickCallbacks.length;t++)i._mouseClickCallbacks[t].call(Ke()(i));for(var e=0;e<i._buttons.length;e++)i._buttons[e].down=!1,i._buttons[e].downThisFrame=!1,i._buttons[e].downByTouch=!1},i._element=t,i._canvas=r;for(var a=0;a<3;a++)i._buttons.push(new zn);return i._element.addEventListener("touchstart",i._touchStartListener,!1),i._element.addEventListener("touchmove",i._touchMoveListener,{passive:!1}),i._element.addEventListener("touchend",i._upListener,!1),i._element.addEventListener("touchcancel",i._endListener,!1),i._element.addEventListener("mousedown",i._mouseDownListener,!1),i._element.addEventListener("mousemove",i._mouseMoveListener,!1),i._element.addEventListener("mouseup",i._upListener,!1),i._element.addEventListener("mousecancel",i._endListener,!1),i._element.addEventListener("mouseout",i._endListener,!1),i._element.addEventListener("wheel",i._mouseWheelListener,!1),i.updateLoop(),i}return F()(n,[{key:"getButton",value:function(t){return this._buttons[t]}},{key:"setPreventDefault",value:function(t){this._preventDefault=t}},{key:"handleMouseDown",value:function(t){this._resetSpeed=!0,this._buttons[t].down=!0,this._buttons[t].downThisFrame=!0,this._buttons[t].clickCanceled=!1,this._buttons[t].downByTouch=!1,this._buttons[t].downTime=0}},{key:"addWheelEvent",value:function(t){this._wheelCallbacks.push(t)}},{key:"addMouseClickEvent",value:function(t){this._mouseClickCallbacks.push(t)}},{key:"addMouseDownEvent",value:function(t){this._mouseDownCallbacks.push(t)}},{key:"setMousePosition",value:function(t){this._mousePos.x=t.pageX/this._canvas.clientWidth*2-1,this._mousePos.y=1-t.pageY/this._canvas.clientHeight*2}},{key:"updateManual",value:function(){this._manualUpdate=!0,this.update()}},{key:"updateLoop",value:function(){var t=this;this.isDestructed||this._manualUpdate||(this.update(),window.requestAnimationFrame((function(){return t.updateLoop()})))}},{key:"update",value:function(){this._normalized.x=.5*this._mousePos.x+.5,this._normalized.y=.5*-this._mousePos.y+.5,this._screen.x=this._mousePos.x,this._screen.y=this._mousePos.y,this._resetSpeed?(this._resetSpeed=!1,this._mouseVelocity.setValues(0,0)):(this._mouseVelocity.x=this._normalized.x-this._previousMousePos.x,this._mouseVelocity.y=this._normalized.y-this._previousMousePos.y),this._previousMousePos.copy(this._normalized);for(var t=0;t<3;t++){var e=this._buttons[t];e.downTime>0&&(e.downThisFrame=!1),this._buttons[t].down&&(e.downTime+=Un.instance.deltaTime)}}},{key:"cancelClick",value:function(){for(var t=0;t<this._buttons.length;t++)this._buttons[t].clickCanceled=!0}},{key:"destruct",value:function(){this._canvas&&(this._canvas.removeEventListener("touchstart",this._touchStartListener,!1),this._canvas.removeEventListener("touchmove",this._touchMoveListener,!1),this._canvas.removeEventListener("touchend",this._upListener,!1),this._canvas.removeEventListener("touchcancel",this._endListener,!1),this._canvas.removeEventListener("mousedown",this._mouseDownListener,!1),this._canvas.removeEventListener("mousemove",this._mouseMoveListener,!1),this._canvas.removeEventListener("mouseend",this._endListener,!1),this._canvas.removeEventListener("mousecancel",this._endListener,!1),this._canvas.removeEventListener("mouseout",this._endListener,!1),this._canvas.removeEventListener("wheel",this._mouseWheelListener,!1),this._canvas.removeEventListener("mouseup",this._upListener,!1)),we()(H()(n.prototype),"destruct",this).call(this)}},{key:"normalizedPos",get:function(){return this._normalized.clone()}},{key:"screenPos",get:function(){return this._screen.clone()}},{key:"normalizedVelocity",get:function(){return this._mouseVelocity.clone()}},{key:"mouseDown",get:function(){return this._buttons[0].down}},{key:"mouseDownThisFrame",get:function(){return this._buttons[0].downThisFrame}},{key:"mouseDownRight",get:function(){return this._buttons[2].down}},{key:"mouseDownThisFrameRight",get:function(){return this._buttons[2].downThisFrame}}]),n}(xe);function Hn(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var $n=n(772),Wn=function(t){U()(n,t);var e=Hn(n);function n(t,r,i,a,o){var s,l=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],c=arguments.length>7&&void 0!==arguments[7]&&arguments[7],f=!(arguments.length>8&&void 0!==arguments[8])||arguments[8];N()(this,n),(s=e.call(this)).textureCount=0,s.isWebgl2=!1,s._clearColor=new fn(0,0,0,1),s._size=new vn,s.id=n.staticId++,s.antialias=o,s.transparent=l,s.autoClear=u,s.stencil=c,s.premultipliedAlpha=f,a?"function"===typeof a?(s.shaderIndex=new Dn,s.shaderIndex.addContext(a)):s.shaderIndex=a:s.shaderIndex=new Dn,s.shaderIndex.addContext($n),s.canvas=r,s.canvas.addEventListener("resize",(function(){return s.handleCanvasResize()})),i===n.webgl2ContextNames?s.isWebgl2=!0:l||s.getAlphaIsCorrect()||(l=!0);var h={alpha:l,stencil:c,powerPreference:"high-performance",preserveDrawingBuffer:!u,premultipliedAlpha:f,antialias:o,xrCompatible:!0};if(i.forEach((function(t){s.context=s.context||s.canvas.getContext(t,h)})),!s.context)throw new Error("could not get a 3d context: aborting");return s.maxParams=new ln(s.context),s.renderState=new Cn(Ke()(s)),n.staticExtensionManager=s.extensionManager=new In,s.extensionManager.enableExtensions(s.context),s.copyTextureMaterial=new kn(Ke()(s),t,"default"),s.copyTextureMaterial.depthTest=!1,s.copyTextureMaterial.depthWrite=!1,s.blitMesh=s.createTriangle(),s}return F()(n,[{key:"getAlphaIsCorrect",value:function(){var t=document.createElement("canvas");t.width=1,t.height=1;var e=t.getContext("experimental-webgl",{alpha:!1,preserveDrawingBuffer:!1});e.clearColor(1,0,0,1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);var n=document.createElement("canvas").getContext("2d");n.drawImage(t,0,0);var r=255===n.getImageData(0,0,1,1).data[3];return r||Se.log("alpha bug detected"),r}},{key:"init",value:function(){Se.log("renderer: textureCount",this.textureCount),this.unsetRenderTarget(),this.handleCanvasResize()}},{key:"preprocessShaderString",value:function(t){return t}},{key:"draw",value:function(t,e){}},{key:"startBatch",value:function(t,e){}},{key:"drawElements",value:function(t,e){}},{key:"endBatch",value:function(){}},{key:"createTriangle",value:function(){var t=new Bn(this),e=new Float32Array([-1,-1,0,-1,3,0,3,-1,0]);t.setPositions(e);var n=new Float32Array([0,0,0,2,2,0]);t.setUV0(n);var r=new Uint16Array([0,2,1]);return t.setIndices(r),t}},{key:"handleCanvasResize",value:function(){this.setSize(this.canvas.width,this.canvas.height)}},{key:"enablePointSprites",value:function(){this.context.enable(34370)}},{key:"blit",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=null!=n?n:this.copyTextureMaterial;e&&(this.renderTarget=e),t&&i.setTexture("uTexture",t),r&&this.clear(),this.draw(this.blitMesh,i),e&&this.unsetRenderTarget(),t&&i.unSetTexture("uTexture")}},{key:"unsetRenderTarget",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._renderTarget||t){var e=this.context;e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindRenderbuffer(e.RENDERBUFFER,null),this.setSize(this.canvas.width,this.canvas.height)}this._renderTarget=void 0}},{key:"clearWithColor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.context.clearColor(t,e,n,r),this.clear(),this.context.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a)}},{key:"clearRenderTexture",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;this.renderTarget=t,this.clearWithColor(e,n,r,i),this.unsetRenderTarget()}},{key:"clearDepth",value:function(){this.renderState.setDepthMask(!0),this.context.clear(dn.DEPTH_BUFFER_BIT)}},{key:"clear",value:function(){this.context.depthMask(!0),this.context.clear(dn.COLOR_BUFFER_BIT|dn.DEPTH_BUFFER_BIT|dn.STENCIL_BUFFER_BIT),this.context.depthMask(this.renderState.getDepthMask())}},{key:"setSize",value:function(t,e){t|=0,e|=0,this.width===t&&this.height===e||(this._size.setValues(t,e),this.context.viewport(0,0,this.width,this.height))}},{key:"setScissor",value:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];t=Fe.clamp01(t),e=Fe.clamp01(e);var a=(n=Fe.clamp01(n))-t,o=(r=Fe.clamp01(r))-e,s=this.width,l=this.height;this.context.enable(dn.SCISSOR_TEST),this.context.scissor(t*s|0,e*l|0,a*s|0,o*l|0),i&&this.context.viewport(t*s|0,e*l|0,a*s|0,o*l|0)}},{key:"setScissorPixels",value:function(t,e,n,r){this.context.enable(dn.SCISSOR_TEST),this.context.scissor(t,e,n-t,r-e)}},{key:"unsetScissor",value:function(){this.context.disable(dn.SCISSOR_TEST)}},{key:"setViewPort",value:function(t,e,n,r){this._size.setValues(n,r),this.context.viewport(t,e,this.width,this.height)}},{key:"unsetViewPort",value:function(){this._size.setValues(this.canvas.width,this.canvas.height),this.context.viewport(0,0,this.canvas.width,this.canvas.height)}},{key:"setChannelMask",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.context.colorMask(t,e,n,r)}},{key:"clearChannelMask",value:function(){this.context.colorMask(!0,!0,!0,!0)}},{key:"setStencilEnabled",value:function(t){t?this.context.enable(dn.STENCIL_TEST):this.context.disable(dn.STENCIL_TEST)}},{key:"startDrawToStencil",value:function(){var t=this.context;this.setStencilEnabled(!0),t.stencilFunc(dn.ALWAYS,1,255),t.stencilOp(dn.KEEP,dn.KEEP,dn.REPLACE),t.stencilMask(255)}},{key:"setStencilFuncEqual",value:function(t){this.context.stencilFunc(t?dn.EQUAL:dn.NOTEQUAL,1,255)}},{key:"destructVAO",value:function(t){}},{key:"destruct",value:function(){if(!this.isDestructed){Se.log("Renderer: destruct");for(var t=this.context,e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),r=0;r<e;++r)t.activeTexture(t.TEXTURE0+r),t.bindTexture(t.TEXTURE_2D,null),t.bindTexture(t.TEXTURE_CUBE_MAP,null);t.bindBuffer(t.ARRAY_BUFFER,null),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),t.bindRenderbuffer(t.RENDERBUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.useProgram(null);var i=t.getExtension("WEBGL_lose_context");i&&i.loseContext(),this.blitMesh&&this.blitMesh.destruct(),this.copyTextureMaterial&&this.copyTextureMaterial.destruct(),this.canvas.removeEventListener("resize",this.handleCanvasResize),this._mouseListener&&this._mouseListener.destruct(),we()(H()(n.prototype),"destruct",this).call(this)}}},{key:"mouseListener",get:function(){return this._mouseListener||(this._mouseListener=new Gn(document.body,this.canvas)),this._mouseListener}},{key:"width",get:function(){return this._size.x}},{key:"height",get:function(){return this._size.y}},{key:"size",get:function(){return this._size}},{key:"renderTarget",set:function(t){t?(t.scaleToCanvas&&t.setSize(Math.round(this.canvas.width*t.sizeMultiplier),Math.round(this.canvas.height*t.sizeMultiplier)),t.setAsTarget(),this.setSize(t.width,t.height),this._renderTarget=t):this.unsetRenderTarget()},get:function(){return this._renderTarget}},{key:"aspectRatio",get:function(){return this.width/this.height}},{key:"clearColor",set:function(t){this._clearColor.copy(t),this.context.clearColor(t.r,t.g,t.b,t.a)},get:function(){return this._clearColor}}]),n}(xe);function Xn(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}Wn.staticId=0,Wn.webgl2ContextNames=["webgl2"],Wn.webgl1ContextNames=["webgl","experimental-webgl"],Wn.drawCalls=0,Wn.vertexCount=0;var jn=function(t){U()(n,t);var e=Xn(n);function n(t,r,i,a){var o,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=!(arguments.length>7&&void 0!==arguments[7])||arguments[7];return N()(this,n),(o=e.call(this,t,r,Wn.webgl1ContextNames,i,a,s,l,u,c)).vertexArrayObjects={},o}return F()(n,[{key:"preprocessShaderString",value:function(t){return"#define WEBGL1\n"+t}},{key:"initVAO",value:function(t,e){var n=this.extensionManager.vertex_array_object,r=n.createVertexArrayOES();return n.bindVertexArrayOES(r),this.setStates(t,e),n.bindVertexArrayOES(null),r}},{key:"setStates",value:function(t,e){var n=this.context;if(t.isInterleaved()){t.interleaveData(),n.bindBuffer(n.ARRAY_BUFFER,t.interleavedBuffer);var r=0;t.attributes.forEach((function(i){var a=e.shader.getAttributeByName(i.name);a&&(n.enableVertexAttribArray(a.loc),n.vertexAttribPointer(a.loc,a.stride,n.FLOAT,!1,4*t.interleavedStrideSum,r)),r+=4*i.stride}))}else t.attributes.forEach((function(t){var r=e.shader.getAttributeByName(t.name);if(r){if(void 0===t.buffer)throw new ReferenceError("Expected buffer to be defined on VertexAttribute when setting states.");n.bindBuffer(n.ARRAY_BUFFER,t.buffer),n.enableVertexAttribArray(r.loc),n.vertexAttribPointer(r.loc,r.stride,n.FLOAT,!1,4*r.stride,0)}}));t.indexBuffer&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.indexBuffer)}},{key:"destructVAO",value:function(t){var e=this.extensionManager.vertex_array_object;if(e){var n=this.vertexArrayObjects[t.id];for(var r in n){var i=n[r];e.deleteVertexArrayOES(i)}this.vertexArrayObjects[t.id]=[]}}},{key:"getVAO",value:function(t,e){var n,r=this.vertexArrayObjects[t.id];return r?(n=r[e.id])||(n=this.initVAO(t,e),r[e.id]=n):(r={},n=this.initVAO(t,e),r[e.id]=n,this.vertexArrayObjects[t.id]=r),n}},{key:"bindVAO",value:function(t){var e=this.extensionManager.vertex_array_object;t!=this.currentVAO&&(e.bindVertexArrayOES(t),this.currentVAO=t)}},{key:"drawVAO",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1;n.setActive(),this.bindVAO(t),this.drawElements(e,n,r,i),this.bindVAO(null)}},{key:"draw",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;e.setActive();var i=this.extensionManager.vertex_array_object;if(!i||t.isDynamic)this.setStates(t,e),this.drawElements(t,e,n,r);else{var a=this.getVAO(t,e);this.bindVAO(a),this.drawElements(t,e,n,r),this.bindVAO(null)}Wn.drawCalls++,Wn.vertexCount+=t.getNumVertices()}},{key:"startBatch",value:function(t,e){e.setActive(),this.extensionManager.vertex_array_object?this.extensionManager.vertex_array_object.bindVertexArrayOES(this.getVAO(t,e)):this.setStates(t,e)}},{key:"drawElements",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;if(t.indices){if(void 0===t.indexType)throw new ReferenceError("expected mesh.indexType to be set on a mesh with indices");r>0?this.context.drawElements(e.drawType,Math.min(r,t.indices.length),t.indexType,n*(t.indexType==dn.UNSIGNED_SHORT?2:4)):this.context.drawElements(e.drawType,t.indices.length,t.indexType,0)}else{var i=t.getNumVertices()-n;r>0?this.context.drawArrays(e.drawType,n,Math.min(i,r)):this.context.drawArrays(e.drawType,n,i)}}},{key:"endBatch",value:function(){this.extensionManager.vertex_array_object&&this.extensionManager.vertex_array_object.bindVertexArrayOES(null)}},{key:"destruct",value:function(){if(!this.isDestructed){Se.log("RendererWebGL1: destruct");var t=this.extensionManager.vertex_array_object;if(t&&this.vertexArrayObjects)for(var e=0;e<this.vertexArrayObjects.length;e++)t.deleteVertexArrayOES(this.vertexArrayObjects[e]);we()(H()(n.prototype),"destruct",this).call(this)}}}]),n}(Wn);function Yn(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Kn=function(t){U()(n,t);var e=Yn(n);function n(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:dn.TEXTURE_2D,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];return N()(this,n),(r=e.call(this)).name="",r.unpackAlignment=4,r.flipY=!1,r.autoGenerateMips=!0,r.dirty=!0,r.mipsDirty=!1,r._format=-1,r._type=-1,r._formatType="",r._internalFormat=-1,r._useMips=!1,r._minFilterLinear=!0,r._magFilterLinear=!0,r._clampS=!0,r._clampT=!0,r._clampR=void 0,r._anisotropy=-1,r.renderer=t,r.renderer.textureCount++,r.target=i,r.textureGL=r.renderer.context.createTexture(),r.useMips=a,r.filterLinear=o,r.clampToEdge=s,r}return F()(n,[{key:"bindToSlot",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.renderer.renderState.bindTextureToSlot(this,t),(this.dirty||this.mipsDirty)&&(this.renderer.renderState.activateSlot(t),this.useMips&&this.mipsDirty&&this.autoGenerateMips&&this.generateMips(),this.dirty&&this.updateTexParameters(),this.mipsDirty=!1,this.dirty=!1)}},{key:"bind",value:function(){this.renderer.context.activeTexture(dn.TEXTURE0+this.renderer.maxParams.MAX_TEXTURE_IMAGE_UNITS-1),this.renderer.context.bindTexture(this.target,this.textureGL),this.dirty&&(this.updateTexParameters(),this.dirty=!1)}},{key:"setSize",value:function(t,e,n){}},{key:"updateTexParameters",value:function(){var t=this.renderer.context;t.texParameteri(this.target,dn.TEXTURE_MAG_FILTER,this._magFilterLinear?dn.LINEAR:dn.NEAREST),t.texParameteri(this.target,dn.TEXTURE_MIN_FILTER,this.useMips&&!this.mipsDirty?this._minFilterLinear?dn.LINEAR_MIPMAP_LINEAR:dn.NEAREST_MIPMAP_LINEAR:this._minFilterLinear?dn.LINEAR:dn.NEAREST),t.texParameteri(this.target,dn.TEXTURE_WRAP_S,this._clampS?dn.CLAMP_TO_EDGE:dn.REPEAT),t.texParameteri(this.target,dn.TEXTURE_WRAP_T,this._clampT?dn.CLAMP_TO_EDGE:dn.REPEAT),void 0!==this._clampR&&t.texParameteri(this.target,dn.TEXTURE_WRAP_T,this._clampR?dn.CLAMP_TO_EDGE:dn.REPEAT),this._anisotropy>1&&this.renderer.extensionManager.filter_anisotropic&&(this._anisotropy=Math.min(this.renderer.extensionManager.maxAnisotropy,this._anisotropy),t.texParameterf(this.target,this.renderer.extensionManager.filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._anisotropy))}},{key:"generateMipsIfNeeded",value:function(){this.useMips&&this.autoGenerateMips&&this.mipsDirty&&this.generateMips()}},{key:"generateMips",value:function(){this.renderer.context.generateMipmap(this.target),this.mipsDirty=!1}},{key:"destruct",value:function(){this.isDestructed||this.textureGL&&this.renderer.context.deleteTexture(this.textureGL),we()(H()(n.prototype),"destruct",this).call(this)}},{key:"format",get:function(){return this._format}},{key:"type",get:function(){return this._type}},{key:"formatType",get:function(){return this._formatType}},{key:"internalFormat",get:function(){return this._internalFormat}},{key:"useMips",get:function(){return this._useMips},set:function(t){this._useMips=t,this.dirty=!0}},{key:"filterNearest",set:function(t){this.filterLinear=!t}},{key:"filterLinear",set:function(t){this._minFilterLinear=t,this._magFilterLinear=t,this.dirty=!0}},{key:"minFilterLinear",set:function(t){this._minFilterLinear=t,this.dirty=!0}},{key:"magFilterLinear",set:function(t){this._magFilterLinear=t,this.dirty=!0}},{key:"anisotropy",set:function(t){this.filterLinear=!0,this._anisotropy=t,this.dirty=!0}},{key:"clampToEdge",set:function(t){this._clampS=t,this._clampT=t,this.target===bn.TEXTURE_3D&&(this._clampR=t),this.dirty=!0}},{key:"clampS",set:function(t){this._clampS=t,this.dirty=!0}},{key:"clampT",set:function(t){this._clampT=t,this.dirty=!0}},{key:"clampR",set:function(t){this._clampR=t,this.dirty=!0}}]),n}(xe),qn=function(){function t(){N()(this,t)}return F()(t,null,[{key:"checkFloatCompatibility",value:function(e,n){if(e.isWebgl2)return n;if(!e.extensionManager.texture_float)if(e.extensionManager.texture_half_float){if(n===t.RGB_FLOAT)return t.RGB_HALF_FLOAT;if(n===t.RGBA_FLOAT)return t.RGBA_HALF_FLOAT}else console.log("Texture: setFormatType: not supported: ",n);return n}},{key:"checkHalfFloatCompatibility",value:function(e,n){if(e.isWebgl2)return n;if(!e.extensionManager.texture_half_float)if(e.extensionManager.texture_float){if(n===t.RGB_HALF_FLOAT)return t.RGB_FLOAT;if(n===t.RGBA_HALF_FLOAT)return t.RGBA_FLOAT}else console.log("Texture: setFormatType: not supported: ",n);return n}},{key:"validateFormatType",value:function(e,n){switch(n){case t.RGB_FLOAT:n=this.checkFloatCompatibility(e,n);case t.RGBA_FLOAT:n=this.checkFloatCompatibility(e,n);case t.RGBA_HALF_FLOAT:n=this.checkHalfFloatCompatibility(e,n);case t.RGB_HALF_FLOAT:n=this.checkHalfFloatCompatibility(e,n)}return n}},{key:"getFormat",value:function(e,n){switch(n){case t.RGBA_UNSIGNED_BYTE:return dn.RGBA;case t.RGB_UNSIGNED_BYTE:case t.RGB_FLOAT:return dn.RGB;case t.RGBA_FLOAT:case t.RGBA_HALF_FLOAT:return dn.RGBA;case t.RGB_HALF_FLOAT:return dn.RGB;case t.RG_HALF_FLOAT:return bn.RG;case t.LUMINANCE_UNSIGNED_BYTE:case t.LUMINANCE_FLOAT:case t.LUMINANCE_HALF_fLOAT:return e.isWebgl2?bn.RED:dn.LUMINANCE;case t.DEPTH_UINTSHORT:case t.DEPTH_FLOAT:return dn.DEPTH_COMPONENT;default:return Se.error("can not yet get format for formatType: ",n),-1}}},{key:"getType",value:function(e,n){switch(n){case t.RGBA_UNSIGNED_BYTE:case t.RGB_UNSIGNED_BYTE:return dn.UNSIGNED_BYTE;case t.RGBA_FLOAT:case t.RGB_FLOAT:return dn.FLOAT;case t.RGBA_HALF_FLOAT:case t.RGB_HALF_FLOAT:case t.RG_HALF_FLOAT:return t.getHalfFloatType(e);case t.LUMINANCE_UNSIGNED_BYTE:return dn.UNSIGNED_BYTE;case t.LUMINANCE_FLOAT:return dn.FLOAT;case t.LUMINANCE_HALF_fLOAT:return t.getHalfFloatType(e);case t.DEPTH_UINTSHORT:return dn.UNSIGNED_SHORT;case t.DEPTH_FLOAT:return dn.FLOAT;default:return Se.error("can not yet get type for formatType: ",n),-1}}},{key:"getHalfFloatType",value:function(t){if(t.isWebgl2)return bn.HALF_FLOAT;var e=t.extensionManager.texture_half_float;return e?e.HALF_FLOAT_OES:-1}},{key:"getInternalFormat",value:function(e){switch(e){case t.RGBA_UNSIGNED_BYTE:return bn.RGBA8;case t.RGB_UNSIGNED_BYTE:return bn.RGB8;case t.RGBA_FLOAT:return bn.RGBA32F;case t.RGB_FLOAT:return bn.RGB32F;case t.RGBA_HALF_FLOAT:return bn.RGBA16F;case t.RGB_HALF_FLOAT:return bn.RGB16F;case t.RG_HALF_FLOAT:return bn.RG16F;case t.LUMINANCE_UNSIGNED_BYTE:return bn.R8;case t.LUMINANCE_FLOAT:return bn.R32F;case t.LUMINANCE_HALF_fLOAT:return bn.R16F;case t.DEPTH_UINTSHORT:return bn.DEPTH_COMPONENT24;case t.DEPTH_FLOAT:return bn.DEPTH_COMPONENT32F;default:return Se.error("can not yet get type for formatType: ",e),-1}}},{key:"getBytesPerPixel",value:function(e){switch(e){case t.RGBA_UNSIGNED_BYTE:return 4;case t.RGB_UNSIGNED_BYTE:return 3;case t.RGB_FLOAT:return 12;case t.RGBA_FLOAT:return 16;case t.RGBA_HALF_FLOAT:return 8;case t.RGB_HALF_FLOAT:return 6;case t.RG_HALF_FLOAT:return 4;case t.LUMINANCE_UNSIGNED_BYTE:return 1;case t.LUMINANCE_FLOAT:return 4;case t.LUMINANCE_HALF_fLOAT:case t.DEPTH_UINTSHORT:return 2;case t.DEPTH_FLOAT:default:return 4}}}]),t}();qn.ALPHA_UNSIGNED_BYTE="ALPHA UNSIGNED_BYTE",qn.ALPHA_FLOAT="ALPHA FLOAT",qn.RGBA_UNSIGNED_BYTE="RGBA UNSIGNED_BYTE",qn.RGBA_FLOAT="RGBA FLOAT",qn.RGBA_HALF_FLOAT="RGBA HALF_FLOAT",qn.RGB_HALF_FLOAT="RGB HALF_FLOAT",qn.RGB_UNSIGNED_BYTE="RGB UNSIGNED_BYTE",qn.RGB_FLOAT="RGB_FLOAT",qn.LUMINANCE_UNSIGNED_BYTE="LUMINANCE UNSIGNED_BYTE",qn.LUMINANCE_FLOAT="LUMINANCE FLOAT",qn.LUMINANCE_HALF_fLOAT="LUMINANCE HALF_FLOAT",qn.DEPTH_UINTSHORT="DEPTH_UINTSHORT",qn.DEPTH_FLOAT="DEPTH_FLOAT",qn.RG_HALF_FLOAT="RG HALF_FLOAT";var Zn=function(){function t(){N()(this,t)}return F()(t,null,[{key:"getTempCanvas",value:function(t,e){var n=document.createElement("canvas");return n.width=t,n.height=e,n}},{key:"flipX",value:function(e){var n=t.getTempCanvas(e.width,e.height),r=n.getContext("2d");return r.transform(-1,0,0,1,n.width,0),r.drawImage(e,0,0),n}},{key:"flipY",value:function(e){var n=t.getTempCanvas(e.width,e.height),r=n.getContext("2d");return r.transform(1,0,0,-1,0,n.height),r.drawImage(e,0,0),n}},{key:"resizeImage",value:function(e,n,r){if(n===e.width&&r===e.height)return e;var i=t.getTempCanvas(n,r);return i.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,n,r),i}},{key:"createDummyImage",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=t.getTempCanvas(e,n),a=i.getContext("2d");a.fillStyle="#eb7d24",a.fillRect(0,0,e,n),a.beginPath();for(var o=0;o<e;o+=64)a.moveTo(o,0),a.lineTo(o,n);for(var s=0;s<n;s+=64)a.moveTo(0,s),a.lineTo(e,s);return a.strokeStyle="#ffffff",a.stroke(),a.font="30px Arial",a.fillStyle="#ffffff",a.fillText(e+"x"+n,8,32),r.length&&a.fillText(r,Math.max(0,e/2-8*r.length),n/2+16),i}},{key:"checkImageFormatSupported",value:function(t,e){var n=new Image;n.onload=function(){e(n.width>0&&n.height>0)},n.onerror=function(){e(!1)};try{n.src=t}catch(r){e(!1)}}},{key:"checkWebpSupported",value:function(e){t.checkImageFormatSupported("data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",e)}},{key:"checkAvifSupported",value:function(e){t.checkImageFormatSupported("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUEAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABMAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgS0AAAAAABNjb2xybmNseAACAAIAAoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAABttZGF0EgAKBDgABokyCRAAAAAP+I9ngw==",e)}}]),t}();function Qn(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Jn=function(t){U()(n,t);var e=Qn(n);function n(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:qn.RGBA_UNSIGNED_BYTE,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];return N()(this,n),(r=e.call(this,t,dn.TEXTURE_2D,a,o,s))._size=new vn(-1,-1),r._formatType=t.isWebgl2?i:qn.validateFormatType(t,i),r._format=qn.getFormat(r.renderer,r.formatType),r._type=qn.getType(r.renderer,r.formatType),r._internalFormat=t.isWebgl2?qn.getInternalFormat(i):r._format,r}return F()(n,[{key:"setSize",value:function(t,e){t===this.width&&e===this.height||(this._size.setValues(t,e),this.bind(),this.renderer.isWebgl2?this.renderer.context.texImage2D(dn.TEXTURE_2D,0,this._internalFormat,this.width,this.height,0,this.format,this.type,null):this.renderer.context.texImage2D(dn.TEXTURE_2D,0,this.format,this.width,this.height,0,this.format,this.type,null),Se.log("expensive operation: resize: ",t,e,"format: ",this.format),this.mipsDirty=!0)}},{key:"generateMipsIfNeeded",value:function(){this.useMips&&(this.renderer.isWebgl2||Fe.isPowerOfTwo(this.width)&&Fe.isPowerOfTwo(this.height)?we()(H()(n.prototype),"generateMipsIfNeeded",this).call(this):(Se.error("can't generate mips: npot: ",this.width,this.height),this.useMips=!1))}},{key:"setData",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.flipY;this.flipY=r;var i=this.renderer.context;this.bind(),i.pixelStorei(dn.UNPACK_ALIGNMENT,this.unpackAlignment),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,r?1:0),i.pixelStorei(dn.UNPACK_COLORSPACE_CONVERSION_WEBGL,dn.NONE),this.renderer.isWebgl2?i.texImage2D(dn.TEXTURE_2D,0,this._internalFormat,e,n,0,this.format,this.type,t):i.texImage2D(dn.TEXTURE_2D,0,this.format,e,n,0,this.format,this.type,t),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,0),this._size.setValues(e,n),this.mipsDirty=!0,this.generateMipsIfNeeded()}},{key:"getData",value:function(t){var e,r=this.renderer.context;switch(t||(t=n.getFramebuffer(this.renderer)),r.bindFramebuffer(dn.FRAMEBUFFER,t),r.framebufferTexture2D(dn.FRAMEBUFFER,dn.COLOR_ATTACHMENT0,dn.TEXTURE_2D,this.textureGL,0),this.formatType){case qn.RGBA_FLOAT:e=new Float32Array(this.width*this.height*4);break;case qn.RGB_FLOAT:e=new Float32Array(this.width*this.height*3);break;case qn.RGBA_UNSIGNED_BYTE:e=new Uint8Array(this.width*this.height*4);break;case qn.RGB_UNSIGNED_BYTE:e=new Uint8Array(this.width*this.height*3);break;case qn.LUMINANCE_UNSIGNED_BYTE:e=new Uint8Array(this.width*this.height);break;default:throw new Error("can not yet get data for format type: "+this.formatType)}return r.readPixels(0,0,this.width,this.height,this.format,this.type,e),r.bindFramebuffer(r.FRAMEBUFFER,null),e}},{key:"getPixel",value:function(t,e){var r=this.renderer.context,i=n.getFramebuffer(this.renderer);r.bindFramebuffer(dn.FRAMEBUFFER,i),r.framebufferTexture2D(dn.FRAMEBUFFER,dn.COLOR_ATTACHMENT0,dn.TEXTURE_2D,this.textureGL,0);var a=new Uint8Array(4);return r.readPixels(t,e,1,1,dn.RGBA,dn.UNSIGNED_BYTE,a),r.bindFramebuffer(r.FRAMEBUFFER,null),a}},{key:"setImage",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.isDestructed){if(this.useMips&&!this.renderer.isWebgl2&&(!Fe.isPowerOfTwo(t.width)||!Fe.isPowerOfTwo(t.height))&&!(t instanceof ImageData)){var i=Fe.nextPowerOfTwo(t.width),a=Fe.nextPowerOfTwo(t.height);console.warn("Expensive operation: setImage - resize image to dimensions of power of two "+i+", "+a),t=Zn.resizeImage(t,i,a)}this.flipY=e;var o=this.renderer.context;this.bind(),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,e?1:0),o.pixelStorei(dn.UNPACK_COLORSPACE_CONVERSION_WEBGL,dn.NONE),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r?1:0),o.texImage2D(dn.TEXTURE_2D,0,this._internalFormat,this.format,this.type,t),t instanceof HTMLVideoElement?this._size.setValues(t.videoWidth,t.videoHeight):(this._size.setValues(t.width,t.height),n.textureBytesLoaded+=this.width*this.height*qn.getBytesPerPixel(this.formatType)),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,0),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0),this.mipsDirty=!0,this.generateMipsIfNeeded()}}},{key:"destruct",value:function(){n._framebuffers[this.renderer.id]&&(this.renderer.context.deleteFramebuffer(n._framebuffers[this.renderer.id]),n._framebuffers[this.renderer.id]=null);we()(H()(n.prototype),"destruct",this).call(this)}},{key:"width",get:function(){return this._size.x}},{key:"height",get:function(){return this._size.y}},{key:"size",get:function(){return this._size.clone()}},{key:"aspectRatio",get:function(){return this.width/this.height}},{key:"channelCount",get:function(){switch(this.format){case dn.RGBA:return 4;case dn.RGB:return 3;case bn.RG:return 2;case dn.LUMINANCE:case bn.RED:return 1;default:return Se.ENABLED&&console.warn("unhandled format",this.format),4}}}],[{key:"getFramebuffer",value:function(t){return n._framebuffers[t.id]||(n._framebuffers[t.id]=t.context.createFramebuffer()),n._framebuffers[t.id]}},{key:"logImageTextureMemoryUsage",value:function(){Se.log("ImageTextureMemoryUsage: "+n.textureBytesLoaded/1048576+" MB")}}]),n}(Kn);function tr(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}Jn.textureBytesLoaded=0,Jn._framebuffers={};var er=function(t){U()(n,t);var e=tr(n);function n(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:qn.DEPTH_UINTSHORT;return N()(this,n),(r=e.call(this,t,o,!1,!1,!0)).setSize(i,a),r}return n}(Jn);function nr(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var rr=function(t){U()(n,t);var e=nr(n);function n(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:qn.RGBA_UNSIGNED_BYTE,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=arguments.length>8&&void 0!==arguments[8]&&arguments[8],f=arguments.length>9&&void 0!==arguments[9]&&arguments[9];N()(this,n),(r=e.call(this,t,o,!1,s,l)).renderBuffer=null,r.colorFramebuffer=null,r.scaleToCanvas=!1,r.sizeMultiplier=1,r.frameBufferComplete=!1,r._antiAlias=!1,r.aaSamples=4,r.setSize(i,a);var h=r.renderer.context;return r.frameBuffer=h.createFramebuffer(),h.bindFramebuffer(h.FRAMEBUFFER,r.frameBuffer),h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,r.textureGL,0),f&&r.renderer.isWebgl2&&(r._antiAlias=!0,r.addMultisampleRenderBuffer()),u&&c?r.depthStencilBuffer=r.createDepthStencilBuffer(i,a):u?r.depthBuffer=r.createDepthBuffer(i,a):c&&(r.stencilBuffer=r.createStencilBuffer(i,a)),r.frameBufferComplete=r.testBuffer(),h.bindFramebuffer(h.FRAMEBUFFER,null),r}return F()(n,[{key:"addMultisampleRenderBuffer",value:function(){if(this.renderer.isWebgl2){var t=this.renderer.context;this.colorFramebuffer=t.createFramebuffer(),this.renderBuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.renderBuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,this.aaSamples,this._internalFormat,this.width,this.height),t.bindRenderbuffer(t.RENDERBUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,this.renderBuffer),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,this.colorFramebuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.textureGL,0),t.bindFramebuffer(t.FRAMEBUFFER,null)}}},{key:"resolveMultisampleBuffer",value:function(){if(this.renderer.isWebgl2&&this.renderBuffer){var t=this.renderer.context;t.bindFramebuffer(t.READ_FRAMEBUFFER,this.frameBuffer),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,this.colorFramebuffer),t.clearBufferfv(t.COLOR,0,[0,0,0,1]),t.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,t.COLOR_BUFFER_BIT,t.NEAREST),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,null)}}},{key:"testBuffer",value:function(){var t=this.renderer.context;t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer);var e=t.checkFramebufferStatus(t.FRAMEBUFFER);switch(e){case t.FRAMEBUFFER_COMPLETE:return!0;case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return console.log("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT",this.formatType),!1;case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return console.log("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",this.formatType),!1;case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return console.log("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS",this.formatType),!1;case t.FRAMEBUFFER_UNSUPPORTED:return console.log("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED",this.formatType),!1;default:return console.log("Incomplete framebuffer: "+e,this.formatType),!1}}},{key:"setTexture3DSlice",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.renderer.context;r.bindFramebuffer(r.FRAMEBUFFER,this.frameBuffer),r.framebufferTextureLayer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,t.textureGL,n,e)}},{key:"addDepthTexture",value:function(){this.renderer.extensionManager.depth_texture?this.setDepthTexture(new er(this.renderer,this.width,this.height)):console.log("addDepthTexture: extension not supported")}},{key:"setDepthTexture",value:function(t){t.setSize(this.width,this.height),this.depthTexture=t;var e=this.renderer.context;e.bindFramebuffer(e.FRAMEBUFFER,this.frameBuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,this.depthTexture.textureGL,0),e.bindFramebuffer(e.FRAMEBUFFER,null)}},{key:"initDepthBuffer",value:function(t,e,n){var r=this.renderer.context;(r.bindFramebuffer(r.FRAMEBUFFER,this.frameBuffer),r.bindRenderbuffer(r.RENDERBUFFER,t),this._antiAlias&&this.renderer.isWebgl2)?this.renderer.context.renderbufferStorageMultisample(r.RENDERBUFFER,this.aaSamples,r.DEPTH_COMPONENT16,e,n):r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_COMPONENT16,e,n);r.bindRenderbuffer(dn.RENDERBUFFER,null)}},{key:"initStencilBuffer",value:function(t,e,n){var r=this.renderer.context;if(r.bindRenderbuffer(r.RENDERBUFFER,t),this._antiAlias&&this.renderer.isWebgl2){var i=this.renderer.context;i.renderbufferStorageMultisample(r.RENDERBUFFER,this.aaSamples,i.STENCIL_INDEX8,e,n)}else r.renderbufferStorage(r.RENDERBUFFER,r.STENCIL_INDEX8,e,n);r.bindRenderbuffer(dn.RENDERBUFFER,null)}},{key:"initDepthStencilBuffer",value:function(t,e,n){var r=this.renderer.context;if(r.bindFramebuffer(r.FRAMEBUFFER,this.frameBuffer),r.bindRenderbuffer(r.RENDERBUFFER,t),this._antiAlias&&this.renderer.isWebgl2){var i=this.renderer.context;i.renderbufferStorageMultisample(r.RENDERBUFFER,this.aaSamples,i.DEPTH24_STENCIL8,e,n)}else r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,e,n);r.bindRenderbuffer(dn.RENDERBUFFER,null)}},{key:"createDepthBuffer",value:function(t,e){var n=this.renderer.context,r=n.createRenderbuffer();return this.initDepthBuffer(r,t,e),n.bindRenderbuffer(n.RENDERBUFFER,r),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,r),n.bindRenderbuffer(dn.RENDERBUFFER,null),r}},{key:"createDepthStencilBuffer",value:function(t,e){var n=this.renderer.context,r=n.createRenderbuffer();return this.initDepthStencilBuffer(r,t,e),n.bindRenderbuffer(n.RENDERBUFFER,r),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,r),n.bindRenderbuffer(dn.RENDERBUFFER,null),r}},{key:"createStencilBuffer",value:function(t,e){var n=this.renderer.context,r=n.createRenderbuffer();return this.initStencilBuffer(r,t,e),n.bindRenderbuffer(n.RENDERBUFFER,r),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.STENCIL_ATTACHMENT,n.RENDERBUFFER,r),n.bindRenderbuffer(dn.RENDERBUFFER,null),r}},{key:"setAsTarget",value:function(){var t=this.renderer.context;t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),this.depthBuffer||this.depthTexture||this.depthStencilBuffer?this.renderer.renderState.setDepthMask(!0):this.renderer.renderState.setDepthMask(!1),this.mipsDirty=!0}},{key:"setSize",value:function(t,e){if(t!==this.width||e!==this.height){if(this.depthStencilBuffer&&this.initDepthStencilBuffer(this.depthStencilBuffer,t,e),this.depthBuffer&&this.initDepthBuffer(this.depthBuffer,t,e),this.stencilBuffer&&this.initStencilBuffer(this.stencilBuffer,t,e),this.renderBuffer){var r=this.renderer.context;r.bindRenderbuffer(r.RENDERBUFFER,this.renderBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,this.aaSamples,this._internalFormat,t,e),r.bindRenderbuffer(dn.RENDERBUFFER,null)}this.depthTexture&&this.depthTexture.setSize(t,e),we()(H()(n.prototype),"setSize",this).call(this,t,e)}}},{key:"getData",value:function(){return we()(H()(n.prototype),"getData",this).call(this,this.frameBuffer)}},{key:"getDataRef",value:function(t){var e=this.renderer.context;e.bindFramebuffer(dn.FRAMEBUFFER,this.frameBuffer),e.readPixels(0,0,this.width,this.height,this.format,this.type,t),e.bindFramebuffer(e.FRAMEBUFFER,null)}},{key:"getPixelU8",value:function(t,e){var n=this.renderer.context;n.bindFramebuffer(dn.FRAMEBUFFER,this.frameBuffer);var r=new Uint8Array(4);return n.readPixels(t,e,1,1,dn.RGBA,dn.UNSIGNED_BYTE,r),n.bindFramebuffer(n.FRAMEBUFFER,null),r}},{key:"getPixel",value:function(t,e){var n,r=this.renderer.context;switch(r.bindFramebuffer(dn.FRAMEBUFFER,this.frameBuffer),this.formatType){case qn.RGBA_FLOAT:n=new Float32Array(4);break;case qn.RGBA_UNSIGNED_BYTE:n=new Uint8Array(4);break;case qn.LUMINANCE_UNSIGNED_BYTE:n=new Uint8Array(1);break;case qn.LUMINANCE_FLOAT:n=new Float32Array(1);break;default:throw new Error("Can not yet get data for format type: "+this.formatType)}return r.readPixels(t,e,1,1,this.format,this.type,n),r.bindFramebuffer(r.FRAMEBUFFER,null),n}},{key:"destruct",value:function(){var t=this.renderer.context;this.frameBuffer&&(t.deleteFramebuffer(this.frameBuffer),delete this.frameBuffer),this.colorFramebuffer&&(t.deleteFramebuffer(this.colorFramebuffer),this.colorFramebuffer=null),this.depthStencilBuffer&&(t.deleteRenderbuffer(this.depthStencilBuffer),delete this.depthStencilBuffer),this.depthBuffer&&(t.deleteRenderbuffer(this.depthBuffer),delete this.depthBuffer),this.stencilBuffer&&(t.deleteRenderbuffer(this.stencilBuffer),delete this.stencilBuffer),this.renderBuffer&&(t.deleteRenderbuffer(this.renderBuffer),this.renderBuffer=null),this.depthTexture&&(this.depthTexture.destruct(),delete this.depthTexture),we()(H()(n.prototype),"destruct",this).call(this)}}]),n}(Jn),ir=n(187),ar=n.n(ir),or=function(){function t(){N()(this,t),this.m=new Array(16);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];16===n.length?this.m=[].concat(n):t.identity(this)}return F()(t,[{key:"clone",value:function(){return t.clone(this)}},{key:"setValues",value:function(e,n,r,i,a,o,s,l,u,c,f,h,d,v,p,m){t.setValues(this,e,n,r,i,a,o,s,l,u,c,f,h,d,v,p,m)}}],[{key:"clone",value:function(e){return ar()(t,rt()(e.m))}},{key:"copy",value:function(t,e){return t.m=rt()(e.m),t}},{key:"fromValues",value:function(e,n,r,i,a,o,s,l,u,c,f,h,d,v,p,m){return new t(e,n,r,i,a,o,s,l,u,c,f,h,d,v,p,m)}},{key:"setValues",value:function(t,e,n,r,i,a,o,s,l,u,c,f,h,d,v,p,m){var y=t.m;return y[0]=e,y[1]=n,y[2]=r,y[3]=i,y[4]=a,y[5]=o,y[6]=s,y[7]=l,y[8]=u,y[9]=c,y[10]=f,y[11]=h,y[12]=d,y[13]=v,y[14]=p,y[15]=m,y}},{key:"identity",value:function(t){var e=t.m;return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{key:"transpose",value:function(t,e){var n=t.m,r=e.m;if(n===r){var i=r[1],a=r[2],o=r[3],s=r[6],l=r[7],u=r[11];n[1]=r[4],n[2]=r[8],n[3]=r[12],n[4]=i,n[6]=r[9],n[7]=r[13],n[8]=a,n[9]=s,n[11]=r[14],n[12]=o,n[13]=l,n[14]=u}else n[0]=r[0],n[1]=r[4],n[2]=r[8],n[3]=r[12],n[4]=r[1],n[5]=r[5],n[6]=r[9],n[7]=r[13],n[8]=r[2],n[9]=r[6],n[10]=r[10],n[11]=r[14],n[12]=r[3],n[13]=r[7],n[14]=r[11],n[15]=r[15];return n}},{key:"invert",value:function(t,e){var n=t.m,r=e.m,i=r[0],a=r[1],o=r[2],s=r[3],l=r[4],u=r[5],c=r[6],f=r[7],h=r[8],d=r[9],v=r[10],p=r[11],m=r[12],y=r[13],g=r[14],_=r[15],E=i*u-a*l,T=i*c-o*l,A=i*f-s*l,R=a*c-o*u,b=a*f-s*u,w=o*f-s*c,S=h*y-d*m,x=h*g-v*m,k=h*_-p*m,M=d*g-v*y,C=d*_-p*y,I=v*_-p*g,P=E*I-T*C+A*M+R*k-b*x+w*S;return P?(P=1/P,n[0]=(u*I-c*C+f*M)*P,n[1]=(o*C-a*I-s*M)*P,n[2]=(y*w-g*b+_*R)*P,n[3]=(v*b-d*w-p*R)*P,n[4]=(c*k-l*I-f*x)*P,n[5]=(i*I-o*k+s*x)*P,n[6]=(g*A-m*w-_*T)*P,n[7]=(h*w-v*A+p*T)*P,n[8]=(l*C-u*k+f*S)*P,n[9]=(a*k-i*C-s*S)*P,n[10]=(m*b-y*A+_*E)*P,n[11]=(d*A-h*b-p*E)*P,n[12]=(u*x-l*M-c*S)*P,n[13]=(i*M-a*x+o*S)*P,n[14]=(y*T-m*R-g*E)*P,n[15]=(h*R-d*T+v*E)*P,n):null}},{key:"adjoint",value:function(t,e){var n=t.m,r=e.m,i=r[0],a=r[1],o=r[2],s=r[3],l=r[4],u=r[5],c=r[6],f=r[7],h=r[8],d=r[9],v=r[10],p=r[11],m=r[12],y=r[13],g=r[14],_=r[15],E=i*u-a*l,T=i*c-o*l,A=i*f-s*l,R=a*c-o*u,b=a*f-s*u,w=o*f-s*c,S=h*y-d*m,x=h*g-v*m,k=h*_-p*m,M=d*g-v*y,C=d*_-p*y,I=v*_-p*g;return n[0]=u*I-c*C+f*M,n[1]=o*C-a*I-s*M,n[2]=y*w-g*b+_*R,n[3]=v*b-d*w-p*R,n[4]=c*k-l*I-f*x,n[5]=i*I-o*k+s*x,n[6]=g*A-m*w-_*T,n[7]=h*w-v*A+p*T,n[8]=l*C-u*k+f*S,n[9]=a*k-i*C-s*S,n[10]=m*b-y*A+_*E,n[11]=d*A-h*b-p*E,n[12]=u*x-l*M-c*S,n[13]=i*M-a*x+o*S,n[14]=y*T-m*R-g*E,n[15]=h*R-d*T+v*E,n}},{key:"determinant",value:function(t){var e=t.m,n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],f=e[9],h=e[10],d=e[11],v=e[12],p=e[13],m=e[14],y=n*s-r*o,g=n*l-i*o,_=r*l-i*s,E=c*p-f*v,T=c*m-h*v,A=f*m-h*p;return u*(n*A-r*T+i*E)-a*(o*A-s*T+l*E)+e[15]*(c*_-f*g+h*y)-d*(v*_-p*g+m*y)}},{key:"multiply",value:function(t,e,n){var r=t.m,i=e.m,a=n.m,o=i[0],s=i[1],l=i[2],u=i[3],c=i[4],f=i[5],h=i[6],d=i[7],v=i[8],p=i[9],m=i[10],y=i[11],g=i[12],_=i[13],E=i[14],T=i[15],A=a[0],R=a[1],b=a[2],w=a[3];return r[0]=A*o+R*c+b*v+w*g,r[1]=A*s+R*f+b*p+w*_,r[2]=A*l+R*h+b*m+w*E,r[3]=A*u+R*d+b*y+w*T,A=a[4],R=a[5],b=a[6],w=a[7],r[4]=A*o+R*c+b*v+w*g,r[5]=A*s+R*f+b*p+w*_,r[6]=A*l+R*h+b*m+w*E,r[7]=A*u+R*d+b*y+w*T,A=a[8],R=a[9],b=a[10],w=a[11],r[8]=A*o+R*c+b*v+w*g,r[9]=A*s+R*f+b*p+w*_,r[10]=A*l+R*h+b*m+w*E,r[11]=A*u+R*d+b*y+w*T,A=a[12],R=a[13],b=a[14],w=a[15],r[12]=A*o+R*c+b*v+w*g,r[13]=A*s+R*f+b*p+w*_,r[14]=A*l+R*h+b*m+w*E,r[15]=A*u+R*d+b*y+w*T,r}},{key:"translate",value:function(t,e,n){var r,i,a,o,s,l,u,c,f,h,d,v,p=t.m,m=e.m,y=n.x,g=n.y,_=n.z;return m===p?(p[12]=m[0]*y+m[4]*g+m[8]*_+m[12],p[13]=m[1]*y+m[5]*g+m[9]*_+m[13],p[14]=m[2]*y+m[6]*g+m[10]*_+m[14],p[15]=m[3]*y+m[7]*g+m[11]*_+m[15]):(r=m[0],i=m[1],a=m[2],o=m[3],s=m[4],l=m[5],u=m[6],c=m[7],f=m[8],h=m[9],d=m[10],v=m[11],p[0]=r,p[1]=i,p[2]=a,p[3]=o,p[4]=s,p[5]=l,p[6]=u,p[7]=c,p[8]=f,p[9]=h,p[10]=d,p[11]=v,p[12]=r*y+s*g+f*_+m[12],p[13]=i*y+l*g+h*_+m[13],p[14]=a*y+u*g+d*_+m[14],p[15]=o*y+c*g+v*_+m[15]),p}},{key:"scale",value:function(t,e,n){var r=t.m,i=e.m,a=n.x,o=n.y,s=n.z;return r[0]=i[0]*a,r[1]=i[1]*a,r[2]=i[2]*a,r[3]=i[3]*a,r[4]=i[4]*o,r[5]=i[5]*o,r[6]=i[6]*o,r[7]=i[7]*o,r[8]=i[8]*s,r[9]=i[9]*s,r[10]=i[10]*s,r[11]=i[11]*s,r[12]=i[12],r[13]=i[13],r[14]=i[14],r[15]=i[15],r}},{key:"rotate",value:function(e,n,r,i){var a,o,s,l,u,c,f,h,d,v,p,m,y,g,_,E,T,A,R,b,w,S,x,k,M=e.m,C=n.m,I=i.x,P=i.y,D=i.z,O=i.length();return O<t.EPSILON?null:(I*=O=1/O,P*=O,D*=O,a=Math.sin(r),s=1-(o=Math.cos(r)),l=C[0],u=C[1],c=C[2],f=C[3],h=C[4],d=C[5],v=C[6],p=C[7],m=C[8],y=C[9],g=C[10],_=C[11],E=I*I*s+o,T=P*I*s+D*a,A=D*I*s-P*a,R=I*P*s-D*a,b=P*P*s+o,w=D*P*s+I*a,S=I*D*s+P*a,x=P*D*s-I*a,k=D*D*s+o,M[0]=l*E+h*T+m*A,M[1]=u*E+d*T+y*A,M[2]=c*E+v*T+g*A,M[3]=f*E+p*T+_*A,M[4]=l*R+h*b+m*w,M[5]=u*R+d*b+y*w,M[6]=c*R+v*b+g*w,M[7]=f*R+p*b+_*w,M[8]=l*S+h*x+m*k,M[9]=u*S+d*x+y*k,M[10]=c*S+v*x+g*k,M[11]=f*S+p*x+_*k,C!==M&&(M[12]=C[12],M[13]=C[13],M[14]=C[14],M[15]=C[15]),M)}},{key:"rotateX",value:function(t,e,n){var r=t.m,i=e.m,a=Math.sin(n),o=Math.cos(n),s=i[4],l=i[5],u=i[6],c=i[7],f=i[8],h=i[9],d=i[10],v=i[11];return i!==r&&(r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],r[12]=i[12],r[13]=i[13],r[14]=i[14],r[15]=i[15]),r[4]=s*o+f*a,r[5]=l*o+h*a,r[6]=u*o+d*a,r[7]=c*o+v*a,r[8]=f*o-s*a,r[9]=h*o-l*a,r[10]=d*o-u*a,r[11]=v*o-c*a,r}},{key:"rotateY",value:function(t,e,n){var r=t.m,i=e.m,a=Math.sin(n),o=Math.cos(n),s=i[0],l=i[1],u=i[2],c=i[3],f=i[8],h=i[9],d=i[10],v=i[11];return i!==r&&(r[4]=i[4],r[5]=i[5],r[6]=i[6],r[7]=i[7],r[12]=i[12],r[13]=i[13],r[14]=i[14],r[15]=i[15]),r[0]=s*o-f*a,r[1]=l*o-h*a,r[2]=u*o-d*a,r[3]=c*o-v*a,r[8]=s*a+f*o,r[9]=l*a+h*o,r[10]=u*a+d*o,r[11]=c*a+v*o,r}},{key:"rotateZ",value:function(t,e,n){var r=t.m,i=e.m,a=Math.sin(n),o=Math.cos(n),s=i[0],l=i[1],u=i[2],c=i[3],f=i[4],h=i[5],d=i[6],v=i[7];return i!==r&&(r[8]=i[8],r[9]=i[9],r[10]=i[10],r[11]=i[11],r[12]=i[12],r[13]=i[13],r[14]=i[14],r[15]=i[15]),r[0]=s*o+f*a,r[1]=l*o+h*a,r[2]=u*o+d*a,r[3]=c*o+v*a,r[4]=f*o-s*a,r[5]=h*o-l*a,r[6]=d*o-u*a,r[7]=v*o-c*a,r}},{key:"fromTranslation",value:function(t,e){var n=t.m;return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,n}},{key:"fromScaling",value:function(t,e){var n=t.m;return n[0]=e.x,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=e.y,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=e.z,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}},{key:"fromRotation",value:function(e,n,r){var i,a,o,s=e.m,l=r.x,u=r.y,c=r.z,f=r.length();return f<t.EPSILON?null:(l*=f=1/f,u*=f,c*=f,i=Math.sin(n),o=1-(a=Math.cos(n)),s[0]=l*l*o+a,s[1]=u*l*o+c*i,s[2]=c*l*o-u*i,s[3]=0,s[4]=l*u*o-c*i,s[5]=u*u*o+a,s[6]=c*u*o+l*i,s[7]=0,s[8]=l*c*o+u*i,s[9]=u*c*o-l*i,s[10]=c*c*o+a,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s)}},{key:"fromXRotation",value:function(t,e){var n=t.m,r=Math.sin(e),i=Math.cos(e);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=i,n[6]=r,n[7]=0,n[8]=0,n[9]=-r,n[10]=i,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}},{key:"fromYRotation",value:function(t,e){var n=t.m,r=Math.sin(e),i=Math.cos(e);return n[0]=i,n[1]=0,n[2]=-r,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=r,n[9]=0,n[10]=i,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}},{key:"fromZRotation",value:function(t,e){var n=t.m,r=Math.sin(e),i=Math.cos(e);return n[0]=i,n[1]=r,n[2]=0,n[3]=0,n[4]=-r,n[5]=i,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}},{key:"fromRotationTranslation",value:function(t,e,n){var r=t.m,i=e.x,a=e.y,o=e.z,s=e.w,l=i+i,u=a+a,c=o+o,f=i*l,h=i*u,d=i*c,v=a*u,p=a*c,m=o*c,y=s*l,g=s*u,_=s*c;return r[0]=1-(v+m),r[1]=h+_,r[2]=d-g,r[3]=0,r[4]=h-_,r[5]=1-(f+m),r[6]=p+y,r[7]=0,r[8]=d+g,r[9]=p-y,r[10]=1-(f+v),r[11]=0,r[12]=n.x,r[13]=n.y,r[14]=n.z,r[15]=1,r}},{key:"getTranslation",value:function(t,e){var n=e.m;return t.x=n[12],t.y=n[13],t.z=n[14],t}},{key:"getScaling",value:function(t,e){var n=e.m,r=n[0],i=n[1],a=n[2],o=n[4],s=n[5],l=n[6],u=n[8],c=n[9],f=n[10];return t.x=Math.hypot(r,i,a),t.y=Math.hypot(o,s,l),t.z=Math.hypot(u,c,f),t}},{key:"getRotation",value:function(e,n){var r=n.m,i=new Oe;t.getScaling(i,n);var a=1/i.x,o=1/i.y,s=1/i.z,l=r[0]*a,u=r[1]*o,c=r[2]*s,f=r[4]*a,h=r[5]*o,d=r[6]*s,v=r[8]*a,p=r[9]*o,m=r[10]*s,y=l+h+m,g=0;return y>0?(g=2*Math.sqrt(y+1),e.w=.25*g,e.x=(d-p)/g,e.y=(v-c)/g,e.z=(u-f)/g):l>h&&l>m?(g=2*Math.sqrt(1+l-h-m),e.w=(d-p)/g,e.x=.25*g,e.y=(u+f)/g,e.z=(v+c)/g):h>m?(g=2*Math.sqrt(1+h-l-m),e.w=(v-c)/g,e.x=(u+f)/g,e.y=.25*g,e.z=(d+p)/g):(g=2*Math.sqrt(1+m-l-h),e.w=(u-f)/g,e.x=(v+c)/g,e.y=(d+p)/g,e.z=.25*g),e}},{key:"fromRotationTranslationScale",value:function(t,e,n,r){var i=t.m,a=e.x,o=e.y,s=e.z,l=e.w,u=a+a,c=o+o,f=s+s,h=a*u,d=a*c,v=a*f,p=o*c,m=o*f,y=s*f,g=l*u,_=l*c,E=l*f,T=r.x,A=r.y,R=r.z;return i[0]=(1-(p+y))*T,i[1]=(d+E)*T,i[2]=(v-_)*T,i[3]=0,i[4]=(d-E)*A,i[5]=(1-(h+y))*A,i[6]=(m+g)*A,i[7]=0,i[8]=(v+_)*R,i[9]=(m-g)*R,i[10]=(1-(h+p))*R,i[11]=0,i[12]=n.x,i[13]=n.y,i[14]=n.z,i[15]=1,i}},{key:"fromRotationTranslationScaleOrigin",value:function(t,e,n,r,i){var a=t.m,o=e.x,s=e.y,l=e.z,u=e.w,c=o+o,f=s+s,h=l+l,d=o*c,v=o*f,p=o*h,m=s*f,y=s*h,g=l*h,_=u*c,E=u*f,T=u*h,A=r.x,R=r.y,b=r.z,w=i.x,S=i.y,x=i.z,k=(1-(m+g))*A,M=(v+T)*A,C=(p-E)*A,I=(v-T)*R,P=(1-(d+g))*R,D=(y+_)*R,O=(p+E)*b,N=(y-_)*b,L=(1-(d+m))*b;return a[0]=k,a[1]=M,a[2]=C,a[3]=0,a[4]=I,a[5]=P,a[6]=D,a[7]=0,a[8]=O,a[9]=N,a[10]=L,a[11]=0,a[12]=n.x+w-(k*w+I*S+O*x),a[13]=n.y+S-(M*w+P*S+N*x),a[14]=n.z+x-(C*w+D*S+L*x),a[15]=1,a}},{key:"fromQuat",value:function(t,e){var n=t.m,r=e.x,i=e.y,a=e.z,o=e.w,s=r+r,l=i+i,u=a+a,c=r*s,f=i*s,h=i*l,d=a*s,v=a*l,p=a*u,m=o*s,y=o*l,g=o*u;return n[0]=1-h-p,n[1]=f+g,n[2]=d-y,n[3]=0,n[4]=f-g,n[5]=1-c-p,n[6]=v+m,n[7]=0,n[8]=d+y,n[9]=v-m,n[10]=1-c-h,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}},{key:"frustum",value:function(t,e,n,r,i,a,o){var s=t.m,l=1/(n-e),u=1/(i-r),c=1/(a-o);return s[0]=2*a*l,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=2*a*u,s[6]=0,s[7]=0,s[8]=(n+e)*l,s[9]=(i+r)*u,s[10]=(o+a)*c,s[11]=-1,s[12]=0,s[13]=0,s[14]=o*a*2*c,s[15]=0,s}},{key:"perspective",value:function(t,e,n,r,i){var a,o=t.m,s=1/Math.tan(e/2);return o[0]=s/n,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=s,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=-1,o[12]=0,o[13]=0,o[15]=0,null!=i&&i!==1/0?(a=1/(r-i),o[10]=(i+r)*a,o[14]=2*i*r*a):(o[10]=-1,o[14]=-2*r),o}},{key:"ortho",value:function(t,e,n,r,i,a,o){var s=t.m,l=1/(e-n),u=1/(r-i),c=1/(a-o);return s[0]=-2*l,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*u,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*c,s[11]=0,s[12]=(e+n)*l,s[13]=(i+r)*u,s[14]=(o+a)*c,s[15]=1,s}},{key:"lookAt",value:function(e,n,r,i){var a,o,s,l,u,c,f,h,d,v,p=e.m,m=n.x,y=n.y,g=n.z,_=i.x,E=i.y,T=i.z,A=r.x,R=r.y,b=r.z;return Math.abs(m-A)<t.EPSILON&&Math.abs(y-R)<t.EPSILON&&Math.abs(g-b)<t.EPSILON?t.identity(e):(f=m-A,h=y-R,d=g-b,a=E*(d*=v=1/Math.hypot(f,h,d))-T*(h*=v),o=T*(f*=v)-_*d,s=_*h-E*f,(v=Math.hypot(a,o,s))?(a*=v=1/v,o*=v,s*=v):(a=0,o=0,s=0),l=h*s-d*o,u=d*a-f*s,c=f*o-h*a,(v=Math.hypot(l,u,c))?(l*=v=1/v,u*=v,c*=v):(l=0,u=0,c=0),p[0]=a,p[1]=l,p[2]=f,p[3]=0,p[4]=o,p[5]=u,p[6]=h,p[7]=0,p[8]=s,p[9]=c,p[10]=d,p[11]=0,p[12]=-(a*m+o*y+s*g),p[13]=-(l*m+u*y+c*g),p[14]=-(f*m+h*y+d*g),p[15]=1,p)}},{key:"targetTo",value:function(t,e,n,r){var i=t.m,a=e.x,o=e.y,s=e.z,l=r.x,u=r.y,c=r.z,f=a-n.x,h=o-n.y,d=s-n.z,v=f*f+h*h+d*d;v>0&&(f*=v=1/Math.sqrt(v),h*=v,d*=v);var p=u*d-c*h,m=c*f-l*d,y=l*h-u*f;return(v=p*p+m*m+y*y)>0&&(p*=v=1/Math.sqrt(v),m*=v,y*=v),i[0]=p,i[1]=m,i[2]=y,i[3]=0,i[4]=h*y-d*m,i[5]=d*p-f*y,i[6]=f*m-h*p,i[7]=0,i[8]=f,i[9]=h,i[10]=d,i[11]=0,i[12]=a,i[13]=o,i[14]=s,i[15]=1,i}},{key:"add",value:function(t,e,n){var r=t.m,i=e.m,a=n.m;return r[0]=i[0]+a[0],r[1]=i[1]+a[1],r[2]=i[2]+a[2],r[3]=i[3]+a[3],r[4]=i[4]+a[4],r[5]=i[5]+a[5],r[6]=i[6]+a[6],r[7]=i[7]+a[7],r[8]=i[8]+a[8],r[9]=i[9]+a[9],r[10]=i[10]+a[10],r[11]=i[11]+a[11],r[12]=i[12]+a[12],r[13]=i[13]+a[13],r[14]=i[14]+a[14],r[15]=i[15]+a[15],r}},{key:"subtract",value:function(t,e,n){var r=t.m,i=e.m,a=n.m;return r[0]=i[0]-a[0],r[1]=i[1]-a[1],r[2]=i[2]-a[2],r[3]=i[3]-a[3],r[4]=i[4]-a[4],r[5]=i[5]-a[5],r[6]=i[6]-a[6],r[7]=i[7]-a[7],r[8]=i[8]-a[8],r[9]=i[9]-a[9],r[10]=i[10]-a[10],r[11]=i[11]-a[11],r[12]=i[12]-a[12],r[13]=i[13]-a[13],r[14]=i[14]-a[14],r[15]=i[15]-a[15],r}},{key:"multiplyScalar",value:function(t,e,n){var r=t.m,i=e.m;return r[0]=i[0]*n,r[1]=i[1]*n,r[2]=i[2]*n,r[3]=i[3]*n,r[4]=i[4]*n,r[5]=i[5]*n,r[6]=i[6]*n,r[7]=i[7]*n,r[8]=i[8]*n,r[9]=i[9]*n,r[10]=i[10]*n,r[11]=i[11]*n,r[12]=i[12]*n,r[13]=i[13]*n,r[14]=i[14]*n,r[15]=i[15]*n,r}}]),t}();or.EPSILON=1e-9;var sr=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;N()(this,t),this.frustumHeight=1,this._projectionMatrix=new or,this._dirty=!0,this._tmpMat4=new or,this._tmpV4=new un,this._frustumCorner=new Oe,this._jitter=new vn,this._jitterFrame=0,this._fov=n,this.frustumHeight=2*Math.tan(.5*this._fov),this._nearPlane=r,this._farPlane=i,this._aspect=1,this._changeCallback=e,this.dirty=!0,this.getFrustumCornerRef(this._frustumCorner)}return F()(t,[{key:"updateMatrix",value:function(){this.dirty&&(or.perspective(this._projectionMatrix,this._fov,this._aspect,this._nearPlane,this._farPlane),this.dirty=!1,this.getFrustumCornerRef(this._frustumCorner))}},{key:"getFrustumCornerRef",value:function(t){var e=.5*this.frustumHeight,n=e*this._aspect;return t.setValues(n,e,1),t}},{key:"getHaltonSequence",value:function(t,e){for(var n=0,r=1,i=t;i>0;)n+=(r/=e)*(i%e),i=Math.floor(i/e);return n}},{key:"jitter",value:function(t){this._jitter.setValues(this.getHaltonSequence(this._jitterFrame%51,2)-.5,this.getHaltonSequence(this._jitterFrame%31,3)-.5),this._jitterFrame++,or.copy(this._projectionMatrix,this.getJitteredMatrix(this._jitter,t,this._tmpV4)),this.getFrustumCornerRef(this._frustumCorner),this.dirty=!1}},{key:"getJitteredMatrix",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=Math.tan(.5*this.FOV),i=r*(e.x/e.y),a=i/(.5*e.x),o=r/(.5*e.y),s=a*t.x,l=o*t.y;void 0!==n&&n.setValues(i/e.x,r/e.y,s/e.x,l/e.y);var u=this.farPlane,c=this.nearPlane,f=s-i,h=s+i,d=l-r,v=l+r,p=2*c/(h*c-f*c),m=2*c/(v*c-d*c),y=(h*c+f*c)/(h*c-f*c),g=(v*c+d*c)/(v*c-d*c),_=-(u+c)/(u-c),E=-2*u*c/(u-c),T=-1;return this._tmpMat4.setValues(p,0,0,0,0,m,0,0,y,g,_,T,0,0,E,0),this._tmpMat4}},{key:"getJitter",value:function(){return this._jitter}},{key:"setMatrix",value:function(t){or.copy(this._projectionMatrix,t),this.dirty=!1}},{key:"dirty",set:function(t){this._dirty!=t&&(this._dirty=t,t&&this._changeCallback())},get:function(){return this._dirty}},{key:"matrix",get:function(){return this.updateMatrix(),this._projectionMatrix}},{key:"aspectRatio",set:function(t){t!==this._aspect&&(this._aspect=t,this.dirty=!0)},get:function(){return this._aspect}},{key:"farPlane",set:function(t){t!==this._farPlane&&(this._farPlane=t,this.dirty=!0)},get:function(){return this._farPlane}},{key:"nearPlane",set:function(t){t!==this._nearPlane&&(this._nearPlane=t,this.dirty=!0)},get:function(){return this._nearPlane}},{key:"FOV",set:function(t){t!==this._fov&&(this._fov=t,this.frustumHeight=2*Math.tan(.5*this._fov),this.dirty=!0)},get:function(){return this._fov}},{key:"frustumCorner",get:function(){return this.dirty&&this.updateMatrix(),this._frustumCorner}}]),t}(),lr=function(){function t(){N()(this,t),this.m=new Array(9);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];9===n.length?this.m=[].concat(n):t.identity(this)}return F()(t,[{key:"clone",value:function(){return t.clone(this)}}],[{key:"clone",value:function(e){return ar()(t,rt()(e.m))}},{key:"copy",value:function(t,e){return t.m=rt()(e.m),t}},{key:"fromValues",value:function(e,n,r,i,a,o,s,l,u){return new t(e,n,r,i,a,o,s,l,u)}},{key:"setValues",value:function(t,e,n,r,i,a,o,s,l,u){var c=t.m;return c[0]=e,c[1]=n,c[2]=r,c[3]=i,c[4]=a,c[5]=o,c[6]=s,c[7]=l,c[8]=u,c}},{key:"identity",value:function(t){var e=t.m;return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}},{key:"transpose",value:function(t,e){var n=t.m,r=e.m;if(n===r){var i=r[1],a=r[2],o=r[5];n[1]=r[3],n[2]=r[6],n[3]=i,n[5]=r[7],n[6]=a,n[7]=o}else n[0]=r[0],n[1]=r[3],n[2]=r[6],n[3]=r[1],n[4]=r[4],n[5]=r[7],n[6]=r[2],n[7]=r[5],n[8]=r[8];return n}},{key:"invert",value:function(t,e){var n=t.m,r=e.m,i=r[0],a=r[1],o=r[2],s=r[3],l=r[4],u=r[5],c=r[6],f=r[7],h=r[8],d=h*l-u*f,v=-h*s+u*c,p=f*s-l*c,m=i*d+a*v+o*p;return m?(m=1/m,n[0]=d*m,n[1]=(-h*a+o*f)*m,n[2]=(u*a-o*l)*m,n[3]=v*m,n[4]=(h*i-o*c)*m,n[5]=(-u*i+o*s)*m,n[6]=p*m,n[7]=(-f*i+a*c)*m,n[8]=(l*i-a*s)*m,n):null}},{key:"adjoint",value:function(t,e){var n=t.m,r=e.m,i=r[0],a=r[1],o=r[2],s=r[3],l=r[4],u=r[5],c=r[6],f=r[7],h=r[8];return n[0]=l*h-u*f,n[1]=o*f-a*h,n[2]=a*u-o*l,n[3]=u*c-s*h,n[4]=i*h-o*c,n[5]=o*s-i*u,n[6]=s*f-l*c,n[7]=a*c-i*f,n[8]=i*l-a*s,n}},{key:"determinant",value:function(t){var e=t.m,n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8];return n*(c*o-s*u)+r*(-c*a+s*l)+i*(u*a-o*l)}},{key:"multiply",value:function(t,e,n){var r=t.m,i=e.m,a=n.m,o=i[0],s=i[1],l=i[2],u=i[3],c=i[4],f=i[5],h=i[6],d=i[7],v=i[8],p=a[0],m=a[1],y=a[2],g=a[3],_=a[4],E=a[5],T=a[6],A=a[7],R=a[8];return r[0]=p*o+m*u+y*h,r[1]=p*s+m*c+y*d,r[2]=p*l+m*f+y*v,r[3]=g*o+_*u+E*h,r[4]=g*s+_*c+E*d,r[5]=g*l+_*f+E*v,r[6]=T*o+A*u+R*h,r[7]=T*s+A*c+R*d,r[8]=T*l+A*f+R*v,r}},{key:"fromQuat",value:function(t,e){var n=t.m,r=e.x,i=e.y,a=e.z,o=e.w,s=r+r,l=i+i,u=a+a,c=r*s,f=i*s,h=i*l,d=a*s,v=a*l,p=a*u,m=o*s,y=o*l,g=o*u;return n[0]=1-h-p,n[3]=f-g,n[6]=d+y,n[1]=f+g,n[4]=1-c-p,n[7]=v-m,n[2]=d-y,n[5]=v+m,n[8]=1-c-h,n}},{key:"add",value:function(t,e,n){var r=t.m,i=e.m,a=n.m;return r[0]=i[0]+a[0],r[1]=i[1]+a[1],r[2]=i[2]+a[2],r[3]=i[3]+a[3],r[4]=i[4]+a[4],r[5]=i[5]+a[5],r[6]=i[6]+a[6],r[7]=i[7]+a[7],r[8]=i[8]+a[8],r}},{key:"subtract",value:function(t,e,n){var r=t.m,i=e.m,a=n.m;return r[0]=i[0]-a[0],r[1]=i[1]-a[1],r[2]=i[2]-a[2],r[3]=i[3]-a[3],r[4]=i[4]-a[4],r[5]=i[5]-a[5],r[6]=i[6]-a[6],r[7]=i[7]-a[7],r[8]=i[8]-a[8],r}},{key:"multiplyScalar",value:function(t,e,n){var r=t.m,i=e.m;return r[0]=i[0]*n,r[1]=i[1]*n,r[2]=i[2]*n,r[3]=i[3]*n,r[4]=i[4]*n,r[5]=i[5]*n,r[6]=i[6]*n,r[7]=i[7]*n,r[8]=i[8]*n,r}},{key:"normalFromMat4",value:function(t,e){var n=t.m,r=e.m,i=r[0],a=r[1],o=r[2],s=r[3],l=r[4],u=r[5],c=r[6],f=r[7],h=r[8],d=r[9],v=r[10],p=r[11],m=r[12],y=r[13],g=r[14],_=r[15],E=i*u-a*l,T=i*c-o*l,A=i*f-s*l,R=a*c-o*u,b=a*f-s*u,w=o*f-s*c,S=h*y-d*m,x=h*g-v*m,k=h*_-p*m,M=d*g-v*y,C=d*_-p*y,I=v*_-p*g,P=E*I-T*C+A*M+R*k-b*x+w*S;return P?(P=1/P,n[0]=(u*I-c*C+f*M)*P,n[1]=(c*k-l*I-f*x)*P,n[2]=(l*C-u*k+f*S)*P,n[3]=(o*C-a*I-s*M)*P,n[4]=(i*I-o*k+s*x)*P,n[5]=(a*k-i*C-s*S)*P,n[6]=(y*w-g*b+_*R)*P,n[7]=(g*A-m*w-_*T)*P,n[8]=(m*b-y*A+_*E)*P,n):null}},{key:"fromMat4",value:function(t,e){var n=t.m,r=e.m;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[4],n[4]=r[5],n[5]=r[6],n[6]=r[8],n[7]=r[9],n[8]=r[10],n}}]),t}(),ur=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;N()(this,t),this.x=e,this.y=n,this.z=r,this.w=i}return F()(t,[{key:"clone",value:function(){return new t(this.x,this.y,this.z,this.w)}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this}},{key:"setValues",value:function(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.z+", "+this.w+")"}},{key:"dot",value:function(e){return t.dot(this,e)}},{key:"identity",value:function(){return this.x=0,this.y=0,this.z=0,this.w=1,this}},{key:"multiply",value:function(t){var e=this.x,n=this.y,r=this.z,i=this.w,a=t.x,o=t.y,s=t.z,l=t.w;return this.x=e*l+i*a+n*s-r*o,this.y=n*l+i*o+r*a-e*s,this.z=r*l+i*s+e*o-n*a,this.w=i*l-e*a-n*o-r*s,this}},{key:"invert",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=this.w,this}},{key:"rotateX",value:function(t){t*=.5;var e=this.x,n=this.y,r=this.z,i=this.w,a=Math.sin(t),o=Math.cos(t);return this.x=e*o+i*a,this.y=n*o+r*a,this.z=r*o-n*a,this.w=i*o-e*a,this}},{key:"rotateY",value:function(t){t*=.5;var e=this.x,n=this.y,r=this.z,i=this.w,a=Math.sin(t),o=Math.cos(t);return this.x=e*o-r*a,this.y=n*o+i*a,this.z=r*o+e*a,this.w=i*o-n*a,this}},{key:"rotateZ",value:function(t){t*=.5;var e=this.x,n=this.y,r=this.z,i=this.w,a=Math.sin(t),o=Math.cos(t);return this.x=e*o+n*a,this.y=n*o-e*a,this.z=r*o+i*a,this.w=i*o-r*a,this}},{key:"setAxisAngle",value:function(t,e){e*=.5;var n=Math.sin(e);return this.x=n*t.x,this.y=n*t.y,this.z=n*t.z,this.w=Math.cos(e),this}},{key:"rotateAxisAngle",value:function(e,n){var r=t.createFromAxisAngle(e,n),i=r.x,a=r.y,o=r.z,s=r.w,l=this.x,u=this.y,c=this.z,f=this.w;return this.x=i*f+s*l+a*c-o*u,this.y=a*f+s*u+o*l-i*c,this.z=o*f+s*c+i*u-a*l,this.w=s*f-i*l-a*u-o*c,this}},{key:"lookAt",value:function(t,e,n){var r=t.clone();r.subtract(e),r.normalize();var i=Oe.cross(n,r);i.normalize();var a=Oe.cross(r,i);a.normalize();var o=lr.fromValues(i.x,i.y,i.z,a.x,a.y,a.z,r.x,r.y,r.z);return this.fromMat3(o)}},{key:"fromMat3",value:function(t){var e,n=t.m,r=n[0]+n[4]+n[8];if(r>0)e=Math.sqrt(r+1),this.w=.5*e,e=.5/e,this.x=(n[5]-n[7])*e,this.y=(n[6]-n[2])*e,this.z=(n[1]-n[3])*e;else{var i=0;n[4]>n[0]&&(i=1),n[8]>n[3*i+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3,s=.5*(e=Math.sqrt(n[3*i+i]-n[3*a+a]-n[3*o+o]+1)),l=.5/e;this.w=(n[3*a+o]-n[3*o+a])*l;var u=(n[3*a+i]+n[3*i+a])*l,c=(n[3*o+i]+n[3*i+o])*l;this.x=0==i?s:0==a?u:c,this.y=1==i?s:1==a?u:c,this.z=2==i?s:2==a?u:c}return this}},{key:"normalize",value:function(){var t=this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w;return t>0&&(t=1/Math.sqrt(t)),this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}}],[{key:"dot",value:function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z+t.w*e.w}},{key:"lerp",value:function(e,n,r){var i=e.x,a=e.y,o=e.z,s=e.w,l=new t;return l.x=i+r*(n.x-i),l.y=a+r*(n.y-a),l.z=o+r*(n.z-o),l.w=s+r*(n.w-s),l}},{key:"closestSlerp",value:function(e,n,r){return e.dot(n)<0?t.slerp(e,t.invert(n),r):t.slerp(e,n,r)}},{key:"lookAt",value:function(e,n,r){var i=e.clone();i.subtract(n),i.normalize();var a=Oe.cross(r,i);a.normalize();var o=Oe.cross(i,a);o.normalize();var s=lr.fromValues(a.x,a.y,a.z,o.x,o.y,o.z,i.x,i.y,i.z);return t.fromMat3(s)}},{key:"createFromAxisAngle",value:function(e,n){var r=.5*n,i=Math.sin(r);return new t(e.x*i,e.y*i,e.z*i,Math.cos(r))}},{key:"getAxisAngle",value:function(e){var n=2*Math.acos(e.w),r=Math.sin(n/2),i=new Oe;return r>t.EPSILON?(i.x=e.x/r,i.y=e.y/r,i.z=e.z/r):(i.x=1,i.y=0,i.z=0),i}},{key:"getAngle",value:function(e,n){var r=t.dot(e,n);return Math.acos(2*r*r-1)}},{key:"multiply",value:function(e,n){var r=e.x,i=e.y,a=e.z,o=e.w,s=n.x,l=n.y,u=n.z,c=n.w,f=new t;return f.x=r*c+o*s+i*u-a*l,f.y=i*c+o*l+a*s-r*u,f.z=a*c+o*u+r*l-i*s,f.w=o*c-r*s-i*l-a*u,f}},{key:"calculateW",value:function(e){var n=e.x,r=e.y,i=e.z,a=new t;return a.x=n,a.y=r,a.z=i,a.w=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),a}},{key:"exp",value:function(e){var n=e.x,r=e.y,i=e.z,a=e.w,o=Math.sqrt(n*n+r*r+i*i),s=Math.exp(a),l=o>0?s*Math.sin(o)/o:0,u=new t;return u.x=n*l,u.y=r*l,u.z=i*l,u.w=s*Math.cos(o),u}},{key:"ln",value:function(e){var n=e.x,r=e.y,i=e.z,a=e.w,o=Math.sqrt(n*n+r*r+i*i),s=o>0?Math.atan2(o,a)/o:0,l=new t;return l.x=n*s,l.y=r*s,l.z=i*s,l.w=.5*Math.log(n*n+r*r+i*i+a*a),l}},{key:"scale",value:function(e,n){return new t(e.x*n,e.y*n,e.z*n,e.w*n)}},{key:"pow",value:function(e,n){var r=t.ln(e);return r=t.scale(r,n),t.exp(r)}},{key:"slerp",value:function(e,n,r){var i,a,o,s,l,u=e.x,c=e.y,f=e.z,h=e.w,d=n.x,v=n.y,p=n.z,m=n.w;(a=u*d+c*v+f*p+h*m)<0&&(a=-a,d=-d,v=-v,p=-p,m=-m),1-a>t.EPSILON?(i=Math.acos(a),o=Math.sin(i),s=Math.sin((1-r)*i)/o,l=Math.sin(r*i)/o):(s=1-r,l=r);var y=new t;return y.x=s*u+l*d,y.y=s*c+l*v,y.z=s*f+l*p,y.w=s*h+l*m,y}},{key:"random",value:function(){var e=Math.random(),n=Math.random(),r=Math.random(),i=Math.sqrt(1-e),a=Math.sqrt(e),o=new t;return o.x=i*Math.sin(2*Math.PI*n),o.y=i*Math.cos(2*Math.PI*n),o.z=a*Math.sin(2*Math.PI*r),o.w=a*Math.cos(2*Math.PI*r),o}},{key:"invert",value:function(e){var n=e.x,r=e.y,i=e.z,a=e.w,o=n*n+r*r+i*i+a*a,s=o?1/o:0,l=new t;return l.x=-n*s,l.y=-r*s,l.z=-i*s,l.w=a*s,l}},{key:"conjugate",value:function(e){var n=new t;return n.x=-e.x,n.y=-e.y,n.z=-e.z,n.w=e.w,n}},{key:"fromMat3",value:function(e){var n,r=e.m,i=r[0]+r[4]+r[8],a=new t;if(i>0)n=Math.sqrt(i+1),a.w=.5*n,n=.5/n,a.x=(r[5]-r[7])*n,a.y=(r[6]-r[2])*n,a.z=(r[1]-r[3])*n;else{var o=0;r[4]>r[0]&&(o=1),r[8]>r[3*o+o]&&(o=2);var s=(o+1)%3,l=(o+2)%3,u=.5*(n=Math.sqrt(r[3*o+o]-r[3*s+s]-r[3*l+l]+1)),c=.5/n;a.w=(r[3*s+l]-r[3*l+s])*c;var f=(r[3*s+o]+r[3*o+s])*c,h=(r[3*l+o]+r[3*o+l])*c;a.x=0==o?u:0==s?f:h,a.y=1==o?u:1==s?f:h,a.z=2==o?u:2==s?f:h}return a}},{key:"fromEuler",value:function(e,n,r){e*=.5,n*=.5,r*=.5;var i=Math.sin(e),a=Math.cos(e),o=Math.sin(n),s=Math.cos(n),l=Math.sin(r),u=Math.cos(r),c=new t;return c.x=i*s*u-a*o*l,c.y=a*o*u+i*s*l,c.z=a*s*l-i*o*u,c.w=a*s*u+i*o*l,c}}]),t}();ur.EPSILON=1e-9,ur.IDENTITY=new ur,ur.ZERO=new ur(0,0,0,0),ur.tInvB=new ur;var cr=function(){function t(){N()(this,t),this.name="unNamed",this.id=-1,this.autoUpdate=!0,this._rotation=new ur,this._position=new Oe,this._scale=new Oe(1,1,1),this._parent=null,this._matrix=new or,this._localMatrix=new or,this._changeCallback=[],this._children=[],this._tempMat4=new or,this._tempMat3=new lr,this._dirty=!0,this._signalDirtyDown=!1}return F()(t,[{key:"identity",value:function(){this._position.setValues(0,0,0),this._rotation.identity(),this._scale.setValues(1,1,1)}},{key:"setParent",value:function(t){this._parent!==t&&(this._parent&&this._parent.removeChild(this),this._parent=t,t&&t.addChild(this),this.setDirty())}},{key:"getParent",value:function(){return this._parent}},{key:"addChild",value:function(t){this._children.indexOf(t)<0&&(this._children.push(t),t.setParent(this))}},{key:"removeChild",value:function(t){var e=this._children.indexOf(t);e>-1&&(this._children.splice(e,1),t.setParent(null))}},{key:"getChildren",value:function(){return this._children}},{key:"addChangeCallBack",value:function(t){this._changeCallback.push(t)}},{key:"setDirty",value:function(){this._dirty||(this._dirty=!0,this.signalDirtyDown())}},{key:"setParentDirty",value:function(){this.signalDirtyDown()}},{key:"signalDirtyDown",value:function(){if(!this._signalDirtyDown){this._signalDirtyDown=!0;for(var t=this._changeCallback.length-1;t>=0;t--)this._changeCallback[t].call(this);for(var e=this._children.length-1;e>=0;e--)this._children[e].setParentDirty()}}},{key:"clone",value:function(){return(new t).copy(this)}},{key:"copy",value:function(t){return this._scale.copy(t._scale),this._rotation.copy(t._rotation),this._position.copy(t._position),this._dirty=!0,this}},{key:"updateMatrix",value:function(){(this._dirty||this._signalDirtyDown)&&(this.autoUpdate&&(this._dirty&&or.fromRotationTranslationScale(this._localMatrix,this._rotation,this._position,this._scale),this._parent?or.multiply(this._matrix,this._parent.worldMatrix,this._localMatrix):this._dirty&&or.copy(this._matrix,this._localMatrix)),this._dirty=!1,this._signalDirtyDown=!1)}},{key:"lookAt",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Oe.UP;this.position=t,this.lookAtFromCurrentPos(e,n)}},{key:"lookAtFromCurrentPos",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Oe.UP;this._rotation=ur.lookAt(this._position,t,e),this.setDirty()}},{key:"setPositionRotationScale",value:function(t,e,n){this._position.copy(t),this._rotation.copy(e),this._scale.copy(n),this.setDirty()}},{key:"setPositionValues",value:function(t,e,n){this._position.setValues(t,e,n),this.setDirty()}},{key:"setScaleValues",value:function(t,e,n){this._scale.setValues(t,e,n),this.setDirty()}},{key:"translateX",value:function(t){this._position.x+=t,this.setDirty()}},{key:"translateY",value:function(t){this._position.y+=t,this.setDirty()}},{key:"translateZ",value:function(t){this._position.z+=t,this.setDirty()}},{key:"translate",value:function(t){this._position.add(t),this.setDirty()}},{key:"translateValues",value:function(t,e,n){this._position.x+=t,this._position.y+=e,this._position.z+=n,this.setDirty()}},{key:"rotateEulerValues",value:function(t,e,n){return this._rotation.rotateY(e),this._rotation.rotateX(t),this._rotation.rotateZ(n),this.setDirty(),this._rotation}},{key:"rotateEuler",value:function(t){return this.rotateEulerValues(t.x,t.y,t.z)}},{key:"setEulerValues",value:function(t,e,n){return this._rotation.identity(),this.rotateEulerValues(t,e,n)}},{key:"rotateAxisAngle",value:function(t,e){return this._rotation.rotateAxisAngle(t,e),this.setDirty(),this._rotation}},{key:"rotateX",value:function(t){this._rotation.rotateX(t),this.setDirty()}},{key:"rotateY",value:function(t){this._rotation.rotateY(t),this.setDirty()}},{key:"rotateZ",value:function(t){this._rotation.rotateZ(t),this.setDirty()}},{key:"setDirection",value:function(t,e){var n=Oe.cross(e,t);n.normalize();var r=Oe.cross(t,n);r.normalize(),lr.setValues(this._tempMat3,n.x,n.y,n.z,r.x,r.y,r.z,t.x,t.y,t.z),this.rotationMatrixMat3=this._tempMat3}},{key:"worldMatrix",get:function(){return this.updateMatrix(),this._matrix}},{key:"localMatrix",get:function(){return this.updateMatrix(),this._localMatrix}},{key:"position",get:function(){return this._position.clone()},set:function(t){this._position.copy(t),this.setDirty()}},{key:"worldPosition",get:function(){return this.updateMatrix(),(new Oe).transform(this._matrix)}},{key:"scale",get:function(){return this._scale.clone()},set:function(t){this._scale.copy(t),this.setDirty()}},{key:"scaleScalar",set:function(t){this._scale.setValues(t,t,t),this.setDirty()}},{key:"rotation",get:function(){return this._rotation.clone()},set:function(t){this._rotation.copy(t),this.setDirty()}},{key:"rotationMatrixMat4",get:function(){return or.fromQuat(this._tempMat4,this._rotation),this._tempMat4}},{key:"worldRotationMatrixMat3",get:function(){var t=this.rotationMatrixMat3;return this._parent&&lr.multiply(t,this._parent.worldRotationMatrixMat3,t),t}},{key:"rotationMatrixMat3",get:function(){return lr.fromQuat(this._tempMat3,this._rotation),this._tempMat3},set:function(t){this._rotation.fromMat3(t),this.setDirty()}},{key:"worldRotationMatrixMat4",get:function(){var t=this.rotationMatrixMat4;return this._parent&&or.multiply(t,this._parent.rotationMatrixMat4,t),t}},{key:"euler",set:function(t){this._rotation.identity(),this.rotateEulerValues(t.x,t.y,t.z)},get:function(){return lr.fromQuat(this._tempMat3,this._rotation),t.getEulerYXZ(this._tempMat3)}},{key:"eulerX",set:function(t){this._rotation.identity(),this.rotateX(t)}},{key:"eulerY",set:function(t){this._rotation.identity(),this.rotateY(t)}},{key:"eulerZ",set:function(t){this._rotation.identity(),this.rotateZ(t)}},{key:"eulerXY",set:function(t){this.setEulerValues(t.x,t.y,0)}},{key:"forward",get:function(){var t=this.rotationMatrixMat3.m;return new Oe(t[6],t[7],t[8])}},{key:"worldForward",get:function(){var t=this.worldRotationMatrixMat3.m;return new Oe(t[6],t[7],t[8])}},{key:"right",get:function(){var t=this.rotationMatrixMat3.m;return new Oe(t[0],t[1],t[2])}},{key:"worldRight",get:function(){var t=this.worldRotationMatrixMat3.m;return new Oe(t[0],t[1],t[2])}},{key:"up",get:function(){var t=this.rotationMatrixMat3.m;return new Oe(t[3],t[4],t[5])}},{key:"worldUp",get:function(){var t=this.worldRotationMatrixMat3.m;return new Oe(t[3],t[4],t[5])}},{key:"direction",get:function(){return new Oe(0,0,1).transformMat3(this.worldRotationMatrixMat3)}}],[{key:"getEulerYXZ",value:function(t){var e,n,r,i=t.m;return i[7]<-1+this.singularityRange?(e=Math.PI/2,n=Math.atan2(i[3],i[0]),r=0):i[7]>1-this.singularityRange?(e=-Math.PI/2,n=-Math.atan2(i[3],i[0]),r=0):(e=Math.asin(-i[7]),n=Math.atan2(i[6],i[8]),r=Math.atan2(i[1],i[4])),new Oe(e,n,r)}}]),t}();cr.singularityRange=1e-4;var fr=function(){function t(e){var n=this;N()(this,t),this.transform=new cr,this._dirty=!0,this._viewMatrix=new or,this._rotationMatrix=new or,this.transform.addChangeCallBack((function(){n.dirty=!0})),this._changeCallback=e}return F()(t,[{key:"updateMatrix",value:function(){this.dirty&&(or.invert(this._viewMatrix,this.transform.worldMatrix),this.dirty=!1)}},{key:"worldPosition",get:function(){return this.transform.worldPosition}},{key:"dirty",set:function(t){this._dirty!=t&&(this._dirty=t,t&&this._changeCallback())},get:function(){return this._dirty}},{key:"matrix",get:function(){return this.updateMatrix(),this._viewMatrix}},{key:"worldRotationMatrix",get:function(){return or.invert(this._rotationMatrix,this.transform.worldRotationMatrixMat4),this._rotationMatrix}}]),t}(),hr=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.01,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;N()(this,t),this.dirty=!0,this._viewProjection=new or,this.tViewProjInv=new or,this.projection=new sr((function(){e.dirty=!0}),n,r,i),this.view=new fr((function(){e.dirty=!0}))}return F()(t,[{key:"lookAt",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Oe.UP;this.view.transform.lookAt(t,e,n)}},{key:"updateViewProjection",value:function(){this.dirty&&(or.multiply(this._viewProjection,this.projection.matrix,this.view.matrix),this.dirty=!1)}},{key:"worldToScreenPoint",value:function(t){var e=new un;return e.x=t.x,e.y=t.y,e.z=t.z,e.w=1,e.transform(this.viewProjection),e.w=Math.max(e.w,.1),e.x/=e.w,e.y/=e.w,e.x=.5*e.x+.5,e.y=-.5*e.y+.5,e}},{key:"screenToWorldPoint",value:function(t){or.invert(this.tViewProjInv,this.viewProjection);var e=2*t.x-1,n=-2*t.y+1;return new Oe(e,n,1).transform(this.tViewProjInv)}},{key:"getDepth",value:function(t){return new un(t.x,t.y,t.z,1).transform(this.viewProjection).z}},{key:"worldPosition",get:function(){return this.view.worldPosition}},{key:"position",set:function(t){this.view.transform.position=t}},{key:"viewProjection",get:function(){return this.updateViewProjection(),this._viewProjection}},{key:"projectionMatrix",get:function(){return this.projection.matrix}},{key:"viewMatrix",get:function(){return this.view.matrix}}]),t}(),dr=function t(){N()(this,t)};dr.BACKSPACE=8,dr.TAB=9,dr.ENTER=13,dr.SHIFT=16,dr.CTRL=17,dr.ALT=18,dr.PAUSE=19,dr.CAPS_LOCK=20,dr.ESCAPE=27,dr.SPACE=32,dr.PAGE_UP=33,dr.PAGE_DOWN=34,dr.END=35,dr.HOME=36,dr.LEFT_ARROW=37,dr.UP_ARROW=38,dr.RIGHT_ARROW=39,dr.DOWN_ARROW=40,dr.INSERT=45,dr.DELETE=46,dr.KEY_0=48,dr.KEY_1=49,dr.KEY_2=50,dr.KEY_3=51,dr.KEY_4=52,dr.KEY_5=53,dr.KEY_6=54,dr.KEY_7=55,dr.KEY_8=56,dr.KEY_9=57,dr.KEY_A=65,dr.KEY_B=66,dr.KEY_C=67,dr.KEY_D=68,dr.KEY_E=69,dr.KEY_F=70,dr.KEY_G=71,dr.KEY_H=72,dr.KEY_I=73,dr.KEY_J=74,dr.KEY_K=75,dr.KEY_L=76,dr.KEY_M=77,dr.KEY_N=78,dr.KEY_O=79,dr.KEY_P=80,dr.KEY_Q=81,dr.KEY_R=82,dr.KEY_S=83,dr.KEY_T=84,dr.KEY_U=85,dr.KEY_V=86,dr.KEY_W=87,dr.KEY_X=88,dr.KEY_Y=89,dr.KEY_Z=90,dr.LEFT_META=91,dr.RIGHT_META=92,dr.SELECT=93,dr.NUMPAD_0=96,dr.NUMPAD_1=97,dr.NUMPAD_2=98,dr.NUMPAD_3=99,dr.NUMPAD_4=100,dr.NUMPAD_5=101,dr.NUMPAD_6=102,dr.NUMPAD_7=103,dr.NUMPAD_8=104,dr.NUMPAD_9=105,dr.MULTIPLY=106,dr.ADD=107,dr.SUBTRACT=109,dr.DECIMAL=110,dr.DIVIDE=111,dr.F1=112,dr.F2=113,dr.F3=114,dr.F4=115,dr.F5=116,dr.F6=117,dr.F7=118,dr.F8=119,dr.F9=120,dr.F10=121,dr.F11=122,dr.F12=123,dr.NUM_LOCK=144,dr.SCROLL_LOCK=145,dr.SEMICOLON=186,dr.EQUALS=187,dr.COMMA=188,dr.DASH=189,dr.PERIOD=190,dr.FORWARD_SLASH=191,dr.GRAVE_ACCENT=192,dr.OPEN_BRACKET=219,dr.BACK_SLASH=220,dr.CLOSE_BRACKET=221,dr.SINGLE_QUOTE=222;var vr=dr,pr=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;N()(this,t),t._instance&&console.log("!-use getInstance!"),n.addEventListener("keydown",(function(n){var r=n.keyCode||n.which;if(t._keyState[r]=!0,t._keyHitCallbacks[r])for(var i=0;i<t._keyHitCallbacks[r].length;i++)t._keyHitCallbacks[r][i].call(e)}),!1),n.addEventListener("keyup",(function(e){var n=e.keyCode||e.which;t._keyState[n]=!1}),!1)}return F()(t,[{key:"getCharDown",value:function(e){return t._keyState[e.charCodeAt(0)]}},{key:"getKeyCodeDown",value:function(e){return t._keyState[e]}},{key:"addKeyHitEvent",value:function(e,n){t._keyHitCallbacks[e]||(t._keyHitCallbacks[e]=[]),t._keyHitCallbacks[e].push(n)}}],[{key:"getInstance",value:function(){return t._instance||(t._instance=new t),t._instance}}]),t}();pr._keyState=[],pr._keyHitCallbacks=[];var mr=pr;function yr(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var gr=function(t){U()(n,t);var e=yr(n);function n(t,r){var i,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return N()(this,n),(i=e.call(this,r)).mouseDown=!1,i._eulerSpeed=new vn,i._rotating=!1,i._rotatingLerp=0,i._rotatingLerpPrev=0,i._rotationLimit=new vn(1.4,-1),i._rotationSpeedMultiplier=1,i.renderer=t,i.mouseListener=t.mouseListener,i._clampEuler=a,i}return F()(n,[{key:"update",value:function(t){var e=this.mouseDown;this.mouseDown=this.mouseListener.mouseDown;var r=t.projection.FOV,i=.5/Math.tan(.5*r),a=2*Math.atan2(.5*this.renderer.aspectRatio,i),o=this.mouseSpeed;if(o.length()>n.MOUSE_MOVEMENT_CANCEL_TRIGGER&&this.mouseListener.cancelClick(),this.mouseDown&&e){var s=this._rotationSpeedMultiplier;this._eulerSpeed.setValues(s*o.y*r*this._mouseInverseValue,s*o.x*a*this._mouseInverseValue),this._rotating=this._eulerSpeed.length()>0,this._rotatingLerp=this._rotating?.5:0,this._rotatingLerpPrev=this._rotatingLerp,this.rotateBy(this._eulerSpeed),this._eulerSpeed.setValues(Math.min(n.MAX_ROTATE_SPEED,Math.abs(this._eulerSpeed.x))*Math.sign(this._eulerSpeed.x),Math.min(n.MAX_ROTATE_SPEED,Math.abs(this._eulerSpeed.y))*Math.sign(this._eulerSpeed.y))}else this._rotatingLerp=Fe.clamp01(this._rotatingLerp-Un.instance.deltaTime),this._rotating=this._rotatingLerp>0,this._rotating&&(this._eulerSpeed.multiplyScalar(1-(this._rotatingLerpPrev-this._rotatingLerp)/this._rotatingLerpPrev),this.rotateBy(this._eulerSpeed)),this._rotatingLerpPrev=this._rotatingLerp}},{key:"resetSpeed",value:function(){this.mouseDown=!1,this._eulerSpeed.setValues(0,0)}},{key:"rotateBy",value:function(t){this._eulerXY.add(t),this._clampEuler&&(this._rotationLimit.x>=0&&(this._eulerXY.x=Fe.clamp(this._eulerXY.x,-this._rotationLimit.x,this._rotationLimit.x)),this._rotationLimit.y>=0&&(this._eulerXY.y=Fe.clamp(this._eulerXY.y,-this._rotationLimit.y,this._rotationLimit.y))),this._transform.eulerXY=this._eulerXY}},{key:"rotationSpeedMultiplier",set:function(t){this._rotationSpeedMultiplier=t}},{key:"rotationLimit",set:function(t){this._rotationLimit.copy(t)}},{key:"rotating",get:function(){return this._rotating}},{key:"mouseSpeed",get:function(){return this.mouseListener.mouseDown?this.mouseListener.normalizedVelocity:new vn}}]),n}(function(){function t(e){N()(this,t),this._eulerXY=new vn,this._transform=new cr,this._mouseInverseValue=1,this._mouseInverseValue=e?-1:1}return F()(t,[{key:"getTransform",value:function(){return this._transform}},{key:"update",value:function(t){}},{key:"setEulerValues",value:function(t,e){this._eulerXY.setValues(t,e),this._transform.eulerXY=this._eulerXY}},{key:"setMouseInverted",value:function(t){this._mouseInverseValue=t?-1:1}},{key:"getMouseInverted",value:function(){return this._mouseInverseValue<0}},{key:"eulerXY",get:function(){return this._eulerXY},set:function(t){this._eulerXY.copy(t),this._transform.eulerXY=t}},{key:"rotation",set:function(t){this._transform.rotation=t;var e=this._transform.euler;this._eulerXY.setValues(e.x,e.y)},get:function(){return this._transform.rotation}}]),t}());function _r(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}gr.MOUSE_MOVEMENT_CANCEL_TRIGGER=.0025,gr.MAX_ROTATE_SPEED=.175;var Er=function(t){U()(n,t);var e=_r(n);function n(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];return N()(this,n),(r=e.call(this,i,a,o))._translateSpeed=new Oe,r._right=new Oe,r._translateSpeedModifier=10,r._dampingModifier=1,r._renderer=t,r._invertMouse=s,r._keyListener=mr.getInstance(),r._mouseListener=t.mouseListener,r._rotationController=new gr(t,s),r}return F()(n,[{key:"lookAt",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Oe.UP;we()(H()(n.prototype),"lookAt",this).call(this,t,e,r),this._rotationController.rotation=this.view.transform.rotation}},{key:"resetSpeed",value:function(){this._translateSpeed.setValues(0,0,0),this._rotationController.resetSpeed()}},{key:"forward",value:function(t){var e=this.view.transform.forward;e.multiplyScalar(this._translateSpeedModifier*t*Un.instance.deltaTime),this._translateSpeed.add(e)}},{key:"sideWays",value:function(t){this._right=this.view.transform.right,this._right.multiplyScalar(-this._translateSpeedModifier*t*Un.instance.deltaTime),this._translateSpeed.add(this._right)}},{key:"rotateBy",value:function(t){this._rotationController.rotateBy(t),this.view.transform.rotation=this._rotationController.rotation}},{key:"update",value:function(){this.projection.aspectRatio=this._renderer.aspectRatio,this._keyListener.getKeyCodeDown(vr.LEFT_ARROW)&&this.sideWays(1),this._keyListener.getKeyCodeDown(vr.RIGHT_ARROW)&&this.sideWays(-1),this._keyListener.getKeyCodeDown(vr.UP_ARROW)&&this.forward(-1),this._keyListener.getKeyCodeDown(vr.DOWN_ARROW)&&this.forward(1),this._keyListener.getKeyCodeDown(vr.KEY_A)&&this.sideWays(1),this._keyListener.getKeyCodeDown(vr.KEY_D)&&this.sideWays(-1),this._keyListener.getKeyCodeDown(vr.KEY_W)&&this.forward(-1),this._keyListener.getKeyCodeDown(vr.KEY_S)&&this.forward(1),this.view.transform.translate(this._translateSpeed),this._translateSpeed.multiplyScalar(Math.pow(.95,this._dampingModifier)),this._rotationController.update(this),this.view.transform.rotation=this._rotationController.rotation}},{key:"getMouseDown",value:function(){return this._mouseListener.mouseDown}},{key:"getMouseSpeed",value:function(){return this._mouseListener.mouseDown?this._mouseListener.normalizedVelocity:new vn}},{key:"setTranslateSpeed",value:function(t){this._translateSpeedModifier=t}},{key:"getTranslateSpeed",value:function(){return this._translateSpeedModifier}},{key:"setDamping",value:function(t){this._dampingModifier=t}},{key:"eulerXY",set:function(t){this._rotationController.eulerXY=t}}]),n}(hr);function Tr(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Ar=function(t){U()(n,t);var e=Tr(n);function n(t,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],l=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],u=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:qn.RGBA_UNSIGNED_BYTE,f=arguments.length>8&&void 0!==arguments[8]&&arguments[8];return N()(this,n),(a=e.call(this,t,c,o,s,l))._premultiply=!1,a.loaded=!1,a.flipY=u,a.url=i,a.name=i,a._premultiply=f,r.add(Ke()(a)),a}return F()(n,[{key:"load",value:function(t){var e=this;Pn.loadImage(this.url,(function(n){e.setImage(n,e.flipY,e._premultiply),e.loaded=!0,e.image=n,t.call(e)}))}}]),n}(Jn);function Rr(t){var e=b("configManager");return"".concat(e.getVariable(E.VERSIONED_STATIC_ROOT),"webgl/").concat(t)}var br=function(){function t(){N()(this,t)}return F()(t,null,[{key:"getStaticDir",value:function(){return b("configManager").getVariable(E.VERSIONED_STATIC_ROOT)}},{key:"getFileName",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.includes("water_texture_02")&&(n=!1),t.useAvif?Rr(e+".avif"):t.useWebp?Rr(e+".webp"):Rr(n?e+".png":e+".jpg")}},{key:"checkImageFormatSupported",value:function(t){return new Promise((function(e){var n=new Image;n.onload=function(){return e(n.width>0&&n.height>0)},n.onerror=function(){return e(!1)};try{n.src=t}catch(r){e(!1)}}))}},{key:"checkWebpSupported",value:function(){return t.checkImageFormatSupported("data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA")}},{key:"checkAvifSupported",value:function(){return new Promise((function(t){t(!1)}))}}]),t}();function wr(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}br.useWebp=!1,br.useAvif=!1;var Sr=function t(){N()(this,t),this.velocity=(new Oe).randomizeSphere(),this.position=(new Oe).randomizeSphere(),this.random=Math.random()},xr=function(t){U()(n,t);var e=wr(n);function n(t,r,i){var a;return N()(this,n),(a=e.call(this))._count=24,a._birds=[],a._predator=new Sr,a._positionData=new Float32Array(3*a._count),a._velocityData=new Float32Array(3*a._count),a._t0=new Oe,a._t1=new Oe,a._renderer=t,a._mesh=a.createQuads(t,a._count+1),a._material=new kn(t,r,"flockingBirds"),a._material.addShaderDefines(["COUNT",a._count]),a._material.alphaToCoverage=!0,a._material.setCullingDisabled(),a._texture=new Ar(t,r,br.getFileName("effects/swallow",!1),!0,!0,!1,!0,qn.LUMINANCE_UNSIGNED_BYTE),a.center=i,a.createBirds(),a}return F()(n,[{key:"createQuads",value:function(t,e){for(var n=4*e,r=new Float32Array(4*n),i=new Uint16Array(6*n),a=0,o=0,s=0;s<e;s++){for(var l=Math.random(),u=0;u<2;u++)for(var c=0;c<2;c++)r[a++]=c,r[a++]=u,r[a++]=l,r[a++]=s;i[o++]=4*s+0,i[o++]=4*s+1,i[o++]=4*s+2,i[o++]=4*s+2,i[o++]=4*s+1,i[o++]=4*s+3}var f=new Bn(t);return f.setAttribute("aPos",4,r),f.setIndices(i),f}},{key:"init",value:function(t){var e=t.addGroup("FlockingBirds",this._material);this._enabled=e.addParamBool("enabled",!0),e.addShaderParamFloat("uLength",.18,0,1),e.addShaderParamFloat("uWidth",.1,0,.2),this._alignDistance=e.addParamFloat("alignDistance",1,0,2),this._alignResponse=e.addParamFloat("alignResponse",.05,0,.1),this._spacingDistance=e.addParamFloat("spacingDistance",1,0,2),this._spacingResponse=e.addParamFloat("spacingResponse",.01,0,.1),this._cohesionResponse=e.addParamFloat("cohesionResponse",.03,0,.1),this.centerBias=e.addParamFloat("centerBias",.01,0,.1),this._velocity=e.addParamFloat("velocity",3,0,10),this._velocityRandomness=e.addParamFloat("velocityRandomness",.5,0,1),this._avoidPredatorResponse=e.addParamFloat("avoidPredatorResponse",.2),this._avoidPredatorDistance=e.addParamFloat("avoidPredatorDistance",2),this._material.setTexture("uTexture",this._texture)}},{key:"createBirds",value:function(){for(var t=0;t<this._count;t++){var e=new Sr;e.position.add(this.center),this._birds.push(e)}}},{key:"setData",value:function(){for(var t=0,e=0,n=0;n<this._count;n++){var r=this._birds[n];this._positionData[t++]=r.position.x,this._positionData[t++]=r.position.y,this._positionData[t++]=r.position.z,this._velocityData[e++]=r.velocity.x,this._velocityData[e++]=r.velocity.y,this._velocityData[e++]=r.velocity.z}this._material.setVector3Array("uPositions",this._positionData),this._material.setVector3Array("uVelocities",this._velocityData)}},{key:"align",value:function(){for(var t=this._alignDistance.value,e=this._alignResponse.value,n=this._t1,r=this._t0,i=0;i<this._count;i++){var a=this._birds[i];r.setValues(0,0,0);for(var o=0,s=0;s<this._count;s++)if(i!=s){var l=this._birds[s],u=Oe.distance(a.position,l.position),c=Fe.smoothStep(t,.5*t,u);c>0&&(n.copy(l.velocity),n.multiplyScalar(c),r.add(n),o+=c)}o>0&&(r.multiplyScalar(1/o),a.velocity=Oe.lerp(a.velocity,r,e))}}},{key:"getFlockCenter",value:function(t){t.setValues(0,0,0);for(var e=0;e<this._count;e++){var n=this._birds[e];t.add(n.position)}t.multiplyScalar(1/this._count)}},{key:"keepTogether",value:function(){var t=this._cohesionResponse.value,e=this._t0;this.getFlockCenter(e);for(var n=this._t1,r=0;r<this._count;r++){var i=this._birds[r];(n=Oe.subtract(e,i.position)).multiplyScalar(t),i.velocity.add(n)}}},{key:"separate",value:function(){for(var t=this._spacingDistance.value,e=this._spacingResponse.value,n=this._t0,r=0;r<this._count;r++)for(var i=this._birds[r],a=0;a<this._count;a++)if(r!=a){var o=this._birds[a],s=(n=Oe.subtract(i.position,o.position)).length(),l=Fe.smoothStep(t,.5*t,s);l>0&&(n.normalize(),n.multiplyScalar(l*e),i.velocity.add(n))}}},{key:"toGoal",value:function(){for(var t=this.centerBias.value,e=this._t1,n=0;n<this._count;n++){var r=this._birds[n];(e=Oe.subtract(this.center,r.position)).multiplyScalar(t),r.velocity.add(e)}}},{key:"move",value:function(){for(var t=Un.instance.deltaTime,e=this._t0,n=this._velocity.value,r=this._velocityRandomness.value,i=0;i<this._count;i++){var a=this._birds[i];if(a.velocity.length()>0){a.velocity.normalize();var o=Fe.lerp(1,2*a.random,r)*n;a.velocity.multiplyScalar(o)}e.copy(a.velocity),e.multiplyScalar(t),a.position.add(e)}}},{key:"updatePredator",value:function(){var t=this._t0;this.getFlockCenter(t);var e=this._t1,n=this._predator;(e=Oe.subtract(t,n.position)).multiplyScalar(.1),n.velocity.add(e),n.velocity.normalize(),n.velocity.multiplyScalar(2*this._velocity.value);var r=Un.instance.deltaTime,i=this._t0;i.copy(n.velocity),i.multiplyScalar(r),n.position.add(i)}},{key:"avoidPredator",value:function(){for(var t=this._avoidPredatorResponse.value,e=this._avoidPredatorDistance.value,n=this._predator.position,r=this._t0,i=0;i<this._count;i++){var a=this._birds[i],o=(r=Oe.subtract(a.position,n)).length(),s=Fe.smoothStep(e,.5*e,o);r.normalize(),r.multiplyScalar(s*t),a.velocity.add(r)}}},{key:"updateBirds",value:function(){this.toGoal(),this.align(),this.keepTogether(),this.separate(),this.updatePredator(),this.avoidPredator(),this.move()}},{key:"draw",value:function(t){this._enabled.value&&(this.updateBirds(),this.setData(),this._material.setMatrix("uViewProjection",t.viewProjection),this._material.setVector3("uCameraPos",t.worldPosition),this._material.setFloat("uAspectRatio",this._renderer.aspectRatio),this._material.setVector3("uPredator",this._predator.position),this._material.setVector3("uPredatorVelocity",this._predator.velocity),this._renderer.draw(this._mesh,this._material))}},{key:"setCenter",value:function(t){this.center.copy(t)}},{key:"destruct",value:function(){var t,e,r;this.isDestructed||(null===(t=this._mesh)||void 0===t||t.destruct(),null===(e=this._material)||void 0===e||e.destruct(),null===(r=this._texture)||void 0===r||r.destruct(),we()(H()(n.prototype),"destruct",this).call(this))}}]),n}(xe);function kr(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return Mr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Mr(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Mr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Cr=function(){function t(){N()(this,t)}return F()(t,null,[{key:"toVector3Array",value:function(t){for(var e=t.length/3,n=[],r=0,i=0;i<e;i++)n.push(new Oe(t[r++],t[r++],t[r++]));return n}},{key:"toFloat32Array",value:function(t){for(var e=t.length,n=new Float32Array(3*e),r=0,i=0;i<e;i++)n[r++]=t[i].x,n[r++]=t[i].y,n[r++]=t[i].z;return n}},{key:"toFloat32ArrayVec4",value:function(t){for(var e=t.length,n=new Float32Array(4*e),r=0,i=0;i<e;i++)n[r++]=t[i].x,n[r++]=t[i].y,n[r++]=t[i].z,n[r++]=t[i].w;return n}},{key:"toFloat32ArrayVec2",value:function(t){for(var e=t.length,n=new Float32Array(2*e),r=0,i=0;i<e;i++)n[r++]=t[i].x,n[r++]=t[i].y;return n}},{key:"toVector2Array",value:function(t){for(var e=t.length/2,n=[],r=0,i=0;i<e;i++)n.push(new vn(t[r++],t[r++]));return n}},{key:"getLocalDimensions",value:function(t){var e=new Oe(0,0,0),n=t.getData("aPos");if(!n)throw new ReferenceError("Could not get local dimensions: mesh data not found");for(var r=0;r<3*t.getNumVertices();r+=3)Math.abs(n[r])>e.x&&(e.x=Math.abs(n[r])),Math.abs(n[r+1])>e.y&&(e.y=Math.abs(n[r+1])),Math.abs(n[r+2])>e.z&&(e.z=Math.abs(n[r+2]));return e}},{key:"makeIndexed",value:function(e){Se.log("makeIndexed ",e.attributes);for(var n=e.getNumVertices(),r=0,i=0;i<e.attributes.length;i++)r+=e.attributes[i].stride;var a=0,o=e.getNumVertices(),s=new Float32Array(r*o),l=[],u=new Float32Array(r);for(i=0;i<o;i++){for(var c=0,f=0;f<e.attributes.length;f++)for(var h=e.attributes[f],d=0;d<h.stride;d++)u[c++]=h.data[i*h.stride+d];var v=t.getIndexOfSubBuffer(s,u,a/r);if(v>=0)l[i]=v;else{l[i]=a/r;for(d=0;d<r;d++)s[a++]=u[d]}}(o=a/r)<Math.pow(2,16)?e.setIndices(new Uint16Array(l)):e.setIndices32(new Uint32Array(l)),s=new Float32Array(s.buffer,0,a);var p=[];for(a=0,i=0;i<e.attributes.length;i++)p[i]=new Float32Array(o*e.attributes[i].stride);for(i=0;i<o;i++)for(f=0;f<e.attributes.length;f++){var m=e.attributes[f].stride;for(d=0;d<m;d++)p[f][i*m+d]=s[a++]}for(i=0;i<e.attributes.length;i++)e.setAttribute(e.attributes[i].name,e.attributes[i].stride,p[i],!0);Se.log("generated indices, reduced amount of vertices from "+n+" to "+o)}},{key:"getIndexOfSubBuffer",value:function(t,e,n){for(var r=e.length,i=0;i<n;i++){for(var a=!0,o=0;o<r;o++)e[o]!=t[r*i+o]&&(a=!1,o=1e3);if(a)return i}return-1}},{key:"addTangents",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.getUV0(),r=t.getNormals(),i=t.getPositions(),a=t.indices;if(null==n)return!1;if(null==i)return!1;if(null==a)return!1;if(null==r)return!1;var o=i.length/3,s=new Float32Array(4*o),l=new Float32Array(3*o),u=new Float32Array(3*o),c=new Float32Array(3),f=new Float32Array(3);function h(t,e,r){if(null!=i&&null!=n){var a=i[3*e]-i[3*t],o=i[3*r]-i[3*t],s=i[3*e+1]-i[3*t+1],h=i[3*r+1]-i[3*t+1],d=i[3*e+2]-i[3*t+2],v=i[3*r+2]-i[3*t+2],p=n[2*e]-n[2*t],m=n[2*r]-n[2*t],y=n[2*e+1]-n[2*t+1],g=n[2*r+1]-n[2*t+1],_=1/(p*g-m*y);!isNaN(_)&&_&&isFinite(_)||(_=1),c[0]=(g*a-y*o)*_,c[1]=(g*s-y*h)*_,c[2]=(g*d-y*v)*_,f[0]=(p*o-m*a)*_,f[1]=(p*h-m*s)*_,f[2]=(p*v-m*d)*_;for(var E=0;E<3;++E)l[3*t+E]+=c[E],l[3*e+E]+=c[E],l[3*r+E]+=c[E],u[3*t+E]+=f[E],u[3*e+E]+=f[E],u[3*r+E]+=f[E]}}for(var d=a.length,v=0;v<d;v+=3)h(a[v],a[v+1],a[v+2]);var p,m,y=new Oe,g=(new Oe,new Oe),_=new Oe,E=new Oe,T=new Oe;function A(t){if(null!=r){g.setValues(r[3*t],r[3*t+1],r[3*t+2]),_.copy(g),E.setValues(l[3*t],l[3*t+1],l[3*t+2]),y.copy(E),isNaN(y.x)&&(y.setValues(1,0,0));var e=Oe.dot(g,E);g.multiplyScalar(e);var n=(y=Oe.subtract(y,g)).length();0==n?(y.setValues(1,0,0)):y.multiplyScalar(1/n),isNaN(y.x)&&(y.setValues(1,0,0)),T.setValues(u[3*t],u[3*t+1],u[3*t+2]),m=Oe.dot(Oe.cross(_,E),T),p=m<0?1:-1,s[4*t]=y.x,s[4*t+1]=y.y,s[4*t+2]=y.z,s[4*t+3]=p}}for(var R=0;R<d;R+=3)A(a[R+0]),A(a[R+1]),A(a[R+2]);return t.setAttribute(Ln.TANGENT.name,Ln.TANGENT.stride,s,e),!0}},{key:"generateNormals",value:function(e){var n=e.getPositions();if(!n)throw new ReferenceError("MeshUtils.generateNormals: failed getting positions data on "+e.name);var r=t.toVector3Array(n),i=t.toVector3Array(new Float32Array(n.length)),a=e.indices;if(!a)throw new ReferenceError("Cannot generate normals: expected indices to be defined on mesh");for(var o=i.length,s=a.length/3,l=0;l<s;l++){var u=a[3*l+0],c=a[3*l+1],f=a[3*l+2],h=r[u],d=r[c],v=r[f],p=Oe.cross(d.clone().subtract(h).normalize(),v.clone().subtract(h).normalize()).normalize();i[u].add(p),i[c].add(p),i[f].add(p)}for(l=0;l<o;l++)i[l].normalize();e.setNormals(t.toFloat32Array(i))}},{key:"getElementCenter",value:function(t){var e=t.getPositions(),n=t.getNumVertices(),r=new Oe;if(null===e)throw new ReferenceError("Cannot get element center: positions not defined on mesh");for(var i=0;i<n;i++)r.x+=e[3*i],r.y+=e[3*i+1],r.z+=e[3*i+2];return r.multiplyScalar(1/n),r}},{key:"getBoundingBox",value:function(t,e){var n=t.getPositions(),r=t.getNumVertices(),i=new Oe(0,0,0);if(null===n)throw new ReferenceError("Cannot get element center: positions not defined on mesh");for(var a=0;a<r;a++)i.x=Math.max(i.x,Math.abs(n[3*a]-e.x)),i.y=Math.max(i.x,Math.abs(n[3*a+1]-e.y)),i.z=Math.max(i.x,Math.abs(n[3*a+2]-e.z));return i}},{key:"getMergedMesh",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new Bn(t[0].renderer),r=[],i=!!t[0].indices,a=[],o=t[0],s=0;s<o.attributes.length;s++)r[s]=[];for(var l=[],u=0,c=0;c<t.length;c++){o=t[c];for(var f=0;f<o.attributes.length;f++)for(var h=o.attributes[f].data,d=h.length,v=0;v<d;v++)r[f].push(h[v]);if(i){for(var p=o.indices.length,m=0;m<p;m++)a.push(o.indices[m]+u);u+=o.getNumVertices()}if(e)for(var y=o.getNumVertices(),g=0;g<y;g++)l.push(c)}e&&n.setAttribute("aIndex",1,new Float32Array(l)),o=t[0];for(var _=0;_<o.attributes.length;_++)n.setAttribute(o.attributes[_].name,o.attributes[_].stride,new Float32Array(r[_]));return i&&n.setIndices(new Uint16Array(a)),Se.log("getMergedMesh: vertexCount",n.getNumVertices()),n}},{key:"getMergedTransformedMesh",value:function(e,n){var r,i=new Bn(e[0].renderer),a=[],o=0,s=[],l=[],u=kr(e);try{for(u.s();!(r=u.n()).done;){var c=r.value;o+=c.getNumVertices();var f,h=kr(c.attributes);try{for(h.s();!(f=h.n()).done;){var d=f.value;s.indexOf(d.name)>=0||(s.push(d.name),l.push(d.stride))}}catch(O){h.e(O)}finally{h.f()}}}catch(O){u.e(O)}finally{u.f()}for(var v=[],p=0;p<s.length;p++)v[p]=0,a[p]=new Float32Array(o*l[p]);var m=t.getMergedIndices(e,n);m instanceof Uint32Array?i.setIndices32(m):i.setIndices(m);for(var y=new Oe,g=0;g<e.length;g++)for(var _=e[g],E=n[g].worldMatrix,T=n[g].rotationMatrixMat3,A=_.getNumVertices(),R=0;R<s.length;R++){var b=_.getAttribute(s[R]),w=a[R],S=v[R],x=l[R];if(b){var k=b.data;if(b.name.includes("aPos"))for(var M=0,C=0;C<A;C++)y.x=k[M++],y.y=k[M++],y.z=k[M++],y=Oe.transform(y,E),w[S++]=y.x,w[S++]=y.y,w[S++]=y.z;else if(b.name==Ln.NORMAL.name)for(var I=0,P=0;P<A;P++)y.x=k[I++],y.y=k[I++],y.z=k[I++],y=Oe.transformMat3(y,T),w[S++]=y.x,w[S++]=y.y,w[S++]=y.z;else w.set(k,S),S+=A*x;v[R]=S}else S+=A*x}for(var D=0;D<s.length;D++)i.setAttribute(s[D],l[D],a[D]);return i}},{key:"getMergedTransformedIdentical",value:function(e,n){for(var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=n.length,a=new Bn(e.renderer),o=[],s=new Oe,l=0;l<e.attributes.length;l++){var u=e.attributes[l].data,c=0,f=u.length;if(o[l]=new Float32Array(u.length*i),e.attributes[l].name==Ln.POSITION.name)for(var h=0;h<i;h++)for(var d=n[h].localMatrix,v=0;v<f/3;v++)s.x=u[3*v+0],s.y=u[3*v+1],s.z=u[3*v+2],s=Oe.transform(s,d),o[l][c++]=s.x,o[l][c++]=s.y,o[l][c++]=s.z;else if(e.attributes[l].name==Ln.NORMAL.name)for(var p=0;p<i;p++)for(var m=0;m<f/3;m++)s.x=u[3*m+0],s.y=u[3*m+1],s.z=u[3*m+2],s=Oe.transformQuat(s,n[p].rotation),o[l][c++]=s.x,o[l][c++]=s.y,o[l][c++]=s.z;else for(var y=0;y<i;y++)for(var g=0;g<f;g++)o[l][c++]=u[g];a.setAttribute(e.attributes[l].name,e.attributes[l].stride,o[l])}var _=t.getMergedIndicesIdentical(e,n);return _&&a.setIndices(_),a.setAttribute("aIndex",1,t.getIdListIdentical(e,i,r)),a}},{key:"getMergedIndices",value:function(t,e){if(t[0].indices){for(var n=t.length,r=0,i=0,a=0;a<n;a++){if(void 0===t[a].indices)throw new ReferenceError("Cannot get merged indices: expected indices to be defined on none or all meshes");r+=t[a].indices.length,i+=t[a].getNumVertices()}for(var o=i>=65536?new Uint32Array(r):new Uint16Array(r),s=0,l=0,u=0;u<n;u++){var c=t[u].indices,f=c.length,h=e[u].worldMatrix;if(h.m[0]*h.m[5]*h.m[10]>0)for(var d=0;d<f;d++)o[s++]=c[d]+l;else for(var v=0;v<f/3;v++)o[s++]=c[3*v+0]+l,o[s++]=c[3*v+2]+l,o[s++]=c[3*v+1]+l;l+=t[u].getNumVertices()}return o}return null}},{key:"getMergedIndicesIdentical",value:function(t,e){var n=e.length;if(t.indices){for(var r=t.indices.length,i=new Uint16Array(t.indices.length*n),a=0,o=0,s=0;s<n;s++){var l=e[s].scale;if(l.x*l.y*l.z>0)for(var u=0;u<r;u++)i[a++]=t.indices[u]+o;else for(var c=0;c<r/3;c++)i[a++]=t.indices[3*c+0]+o,i[a++]=t.indices[3*c+2]+o,i[a++]=t.indices[3*c+1]+o;o+=t.getNumVertices()}return i}return null}},{key:"getIdList",value:function(e,n){for(var r=t.getTotalVertexCount(e),i=new Float32Array(r),a=0,o=0,s=e.length,l=0;l<s;l++){var u=e[l].getNumVertices();o=n?Math.random():l;for(var c=0;c<u;c++)i[a++]=o}return i}},{key:"getIdListIdentical",value:function(t,e,n){for(var r=t.getNumVertices(),i=new Float32Array(r*e),a=0,o=0,s=0;s<e;s++){o=n?Math.random():s;for(var l=0;l<r;l++)i[a++]=o}return i}},{key:"getTotalVertexCount",value:function(t){for(var e=0,n=t.length,r=0;r<n;r++)e+=t[r].getNumVertices();return e}},{key:"addBaryCentricCoords",value:function(e){var n=e.indices;if(n){for(var r=0;r<e.attributes.length;r++){var i=e.attributes[r],a=t.getNonIndexed(i.data,n,i.stride);e.setAttribute(i.name,i.stride,a)}delete e.indices}for(var o=e.getNumVertices()/3,s=new Float32Array(9*o),l=0,u=0;u<o;u++)s[l++]=1,s[l++]=0,s[l++]=0,s[l++]=0,s[l++]=1,s[l++]=0,s[l++]=0,s[l++]=0,s[l++]=1;e.setAttribute("aBarycentric",3,s)}},{key:"getNonIndexed",value:function(t,e,n){for(var r=e.length,i=new Float32Array(r*n),a=0,o=0;o<r;o++)for(var s=e[o],l=0;l<n;l++)i[a++]=t[s*n+l];return i}}]),t}();function Ir(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return Pr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Pr(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Pr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Dr(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Or=function(){function t(){N()(this,t),this.animator=null,this.visible=!0,this.distanceFromCamera=0,this.isStatic=!0,this.bbMin=new Oe,this.bbMax=new Oe,this.bbRadius=1}return F()(t,[{key:"init",value:function(){if(!this.isStatic){var t=this.transform.worldPosition;this.bbRadius=Math.max(Oe.distance(t,this.bbMax),Oe.distance(this.bbMin,t))}}},{key:"sharedMaterial",get:function(){return this.material.sharedMaterial}}]),t}(),Nr=function(t){U()(n,t);var e=Dr(n);function n(t){var r;return N()(this,n),(r=e.call(this)).materials=[],r.materialsByName={},r.materialById={},r.meshes=[],r.meshById={},r.meshRenderers=[],r.meshRenderersById={},r.firstTransparentIndex=0,r._renderer=t,r}return F()(n,[{key:"update",value:function(){}},{key:"handleLoaded",value:function(){var t,e=Ir(this.materials);try{for(e.s();!(t=e.n()).done;){t.value.init()}}catch(i){e.e(i)}finally{e.f()}var n,r=Ir(this.meshRenderers);try{for(r.s();!(n=r.n()).done;){n.value.init()}}catch(i){r.e(i)}finally{r.f()}this.meshRenderers=this.sort(this.meshRenderers),this.mergeMeshes(),this.meshRenderers=this.sort(this.meshRenderers)}},{key:"mergeMeshes",value:function(){if(Se.ENABLED){console.log("mergeMeshes: before",this.meshRenderers.length),console.time("modelMerge");var t,e=[],n=Ir(this.meshRenderers);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.isStatic||e.push(r.transform.name)}}catch(A){n.e(A)}finally{n.f()}console.log("dynamic models",e.length,e)}var i,a={},o=Ir(this.meshRenderers);try{for(o.s();!(i=o.n()).done;){var s=i.value;s.isStatic&&s.sharedMaterial.merge&&(a[s.sharedMaterial.name]||(a[s.sharedMaterial.name]=[]),a[s.sharedMaterial.name].push(s))}}catch(A){o.e(A)}finally{o.f()}for(var l in a){var u=a[l];if(u.length>1){u[0].sharedMaterial.transparent&&(u=this.sortZ(u));var c,f=[],h=[],d=new Oe(1e4,1e4,1e4),v=new Oe(-1e4,-1e4,-1e4),p=Ir(u);try{for(p.s();!(c=p.n()).done;){var m=c.value;h.push(m.transform),f.push(m.mesh),d.x=Math.min(d.x,m.bbMin.x),d.y=Math.min(d.y,m.bbMin.y),d.z=Math.min(d.z,m.bbMin.z),v.x=Math.max(v.x,m.bbMax.x),v.y=Math.max(v.y,m.bbMax.y),v.z=Math.max(v.z,m.bbMax.z)}}catch(A){p.e(A)}finally{p.f()}var y=Cr.getMergedTransformedMesh(f,h),g=new Or;g.mesh=y,g.material=u[0].material,g.transform=new cr,g.transform.name=u[0].sharedMaterial.name,g.bbMin=d,g.bbMax=v,this.meshRenderers.unshift(g);var _,E=Ir(u);try{for(E.s();!(_=E.n()).done;){var T=_.value;this.meshRenderers.splice(this.meshRenderers.indexOf(T),1)}}catch(A){E.e(A)}finally{E.f()}}}Se.ENABLED&&(console.timeEnd("modelMerge"),console.log("mergeMeshes: after",this.meshRenderers.length))}},{key:"frustumCull",value:function(t,e){var n,r=[],i=Ir(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a.isStatic)e.boxInFrustum(a.bbMin,a.bbMax)&&r.push(a);else{var o=a.transform.worldPosition;e.sphereInFrustum(o,a.bbRadius)&&r.push(a)}}}catch(s){i.e(s)}finally{i.f()}return r}},{key:"sortZ",value:function(t){var e,n=[],r=Ir(t);try{for(r.s();!(e=r.n()).done;){var i=e.value,a=i.transform.worldPosition;i.distanceFromCamera=a.z,n.push(i)}}catch(o){r.e(o)}finally{r.f()}return n.sort((function(t,e){return t.distanceFromCamera-e.distanceFromCamera})),n}},{key:"sort",value:function(t){var e,n=[],r=[],i=Ir(t);try{for(i.s();!(e=i.n()).done;){var a=e.value;if(a.visible){var o=a.transform.worldPosition;a.distanceFromCamera=o.z,"sun_01"==a.transform.name&&(a.distanceFromCamera=-2e3),a.sharedMaterial.sortBackToFront?r.push(a):n.push(a)}}}catch(s){i.e(s)}finally{i.f()}return this.firstTransparentIndex=n.length,n.sort((function(t,e){return e.distanceFromCamera-t.distanceFromCamera})),r.sort((function(t,e){return t.distanceFromCamera-e.distanceFromCamera})),Se.ENABLED&&console.log("transparent",r),n.concat(r)}},{key:"drawOpaque",value:function(t){if(1!=this.isDestructed){var e,n=t.viewProjection,r=t.worldPosition,i=Ir(this.materials);try{for(i.s();!(e=i.n()).done;){var a=e.value;a.fog&&a.setVector3("_CameraPosition",r),a.setMatrix("_ViewProjection",n),a.billboard&&(a.setMatrix("_View",t.view.matrix),a.setMatrix("_Projection",t.projection.matrix)),(a.movement||a.timeScroll||a.water)&&a.setFloat("_Time",Un.instance.time)}}catch(s){i.e(s)}finally{i.f()}for(var o=0;o<this.firstTransparentIndex;o++)this.drawModel(this.meshRenderers[o])}else Se.ENABLED&&console.warn("drawing a destructed model: aborting")}},{key:"drawTransparent",value:function(t){for(var e=this.firstTransparentIndex;e<this.meshRenderers.length;e++)this.drawModel(this.meshRenderers[e])}},{key:"drawModel",value:function(t){if(t){t.material.setInstanceUniforms();var e=t.sharedMaterial;e.occluder&&this._renderer.setChannelMask(!1,!1,!1,!1),e.skinned&&(t.animator?0==t.animator.boneMatrices.length?console.warn("animator.boneMatrices.length == 0",t.animator):e.setMatrixFloatArray("_BoneMatrices",t.animator.boneMatrices):console.warn("no animator on skinned model",t)),e.setMatrix("_Model",t.transform.worldMatrix),this._renderer.draw(t.mesh,e),e.occluder&&this._renderer.clearChannelMask()}}},{key:"addMeshRenderer",value:function(t){this.meshRenderers.push(t),this.meshRenderersById[t.transform.id]||(this.meshRenderersById[t.transform.id]=[]),this.meshRenderersById[t.transform.id].push(t)}},{key:"removeMeshRenderer",value:function(t){t.visible=!1}},{key:"addMesh",value:function(t,e){this.meshes.push(t),this.meshById[e]=t}},{key:"addMaterial",value:function(t,e){this.materials.push(t),this.materialsByName[t.name]=t,this.materialById[e]=t}},{key:"getMaterialByName",value:function(t){return this.materialsByName[t]}},{key:"getRenderersById",value:function(t){return void 0==this.meshRenderersById[t]?[]:this.meshRenderersById[t]}},{key:"setUniform",value:function(t,e){var n,r=Ir(this.materials);try{for(r.s();!(n=r.n()).done;){n.value.setFloat(t,e)}}catch(i){r.e(i)}finally{r.f()}}},{key:"setColor",value:function(t,e){var n,r=Ir(this.materials);try{for(r.s();!(n=r.n()).done;){n.value.setVector4(t,e)}}catch(i){r.e(i)}finally{r.f()}}},{key:"destruct",value:function(){var t,e=Ir(this.meshes);try{for(e.s();!(t=e.n()).done;){var r=t.value;r.destruct()}}catch(s){e.e(s)}finally{e.f()}var i,a=Ir(this.materials);try{for(a.s();!(i=a.n()).done;){var o=i.value;o.destruct()}}catch(s){a.e(s)}finally{a.f()}we()(H()(n.prototype),"destruct",this).call(this)}}]),n}(xe);function Lr(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return Fr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Fr(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Fr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Br(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Ur=function(t){U()(n,t);var e=Br(n);function n(t){var r;return N()(this,n),(r=e.call(this)).animators=[],r.animatorsById={},r.eventDispatcher=t,r}return F()(n,[{key:"addAnimator",value:function(t){this.animatorsById[t.id]=t,this.animators.push(t)}},{key:"getClipByName",value:function(t){var e,n=Lr(this.animators);try{for(n.s();!(e=n.n()).done;){var r,i=Lr(e.value.clips);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a.name==t)return a}}catch(o){i.e(o)}finally{i.f()}}}catch(o){n.e(o)}finally{n.f()}return console.warn("getClipByName: not found",t,this.animators),null}},{key:"getValueOfTrack",value:function(t,e){var n,r=Lr(this.animators);try{for(r.s();!(n=r.n()).done;){var i,a=Lr(n.value.clips);try{for(a.s();!(i=a.n()).done;){var o,s=Lr(i.value.tracks);try{for(s.s();!(o=s.n()).done;){var l=o.value;if(l.name.indexOf(t)>=0)return l.evaluate(e)}}catch(u){s.e(u)}finally{s.f()}}}catch(u){a.e(u)}finally{a.f()}}}catch(u){r.e(u)}finally{r.f()}return 0}},{key:"update",value:function(t){var e,n=this,r=Lr(this.animators);try{for(r.s();!(e=r.n()).done;){var i,a=e.value,o=Lr(a.clips);try{for(o.s();!(i=o.n()).done;){var s=i.value;s.update(t,(function(t){return n.handleKeyframeEvent(t)}));var l,u=Lr(s.transformsTracks);try{for(u.s();!(l=u.n()).done;){l.value.update(t)}}catch(c){u.e(c)}finally{u.f()}}}catch(c){o.e(c)}finally{o.f()}a.applySkinning()}}catch(c){r.e(c)}finally{r.f()}}},{key:"getTransformTrackByName",value:function(t){var e,n=Lr(this.animators);try{for(n.s();!(e=n.n()).done;){var r,i=Lr(e.value.clips);try{for(i.s();!(r=i.n()).done;){var a,o=Lr(r.value.transformsTracks);try{for(o.s();!(a=o.n()).done;){var s=a.value;if(s.transform.name==t)return s}}catch(l){o.e(l)}finally{o.f()}}}catch(l){i.e(l)}finally{i.f()}}}catch(l){n.e(l)}finally{n.f()}return null}},{key:"handleKeyframeEvent",value:function(t){this.eventDispatcher.dispatchEvent(new Re(Re.ANIMATION_EVENT,{data:t}))}},{key:"destruct",value:function(){var t,e=Lr(this.animators);try{for(e.s();!(t=e.n()).done;){var r=t.value;r.destruct()}}catch(i){e.e(i)}finally{e.f()}we()(H()(n.prototype),"destruct",this).call(this)}}]),n}(xe);function Vr(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return zr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zr(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function zr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Gr(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Hr=function(){function t(){N()(this,t),this.size=0,this.screenPosition=new un,this.screenPositionPixels=[0,0],this.opacity=0,this.visibility=!1,this.mouseOver=!1,this.mouseOverValue=0}return F()(t,[{key:"update",value:function(t){this.opacity=Fe.clamp01(this.opacity+(this.visibility?t:-t)),this.mouseOverValue=Fe.clamp01(this.mouseOverValue+4*(this.mouseOver?t:-t))}},{key:"setVisible",value:function(t,e){this.visibility=t,e&&(this.opacity=t?1:0)}},{key:"name",get:function(){return this.transform.name}},{key:"visible",get:function(){return this.screenPosition.z>0&&this.screenPosition.x>0&&this.screenPosition.x<1&&this.screenPosition.y>0&&this.screenPosition.y<1}}]),t}(),$r=function t(){N()(this,t),this.mainTimeline=null},Wr=function(t){U()(n,t);var e=Gr(n);function n(){var t;return N()(this,n),(t=e.apply(this,arguments)).hotspots=[],t}return F()(n,[{key:"destruct",value:function(){we()(H()(n.prototype),"destruct",this).call(this)}}]),n}(xe),Xr=function(){function t(){N()(this,t)}return F()(t,null,[{key:"parseComponents",value:function(t,e){var n=e.components;if(t.hotspots){var r,i=Vr(t.hotspots);try{for(i.s();!(r=i.n()).done;){var a=r.value,o=new Hr;o.transform=e.getTransformById(a.transformID),o.size=a.size,n.hotspots.push(o)}}catch(s){i.e(s)}finally{i.f()}}return t.sceneReferences&&(n.sceneReferences=new $r,t.sceneReferences.timelineName&&(n.sceneReferences.mainTimeline=e.unityAnimator.getClipByName(t.sceneReferences.timelineName))),n}}]),t}();function jr(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Yr=function(t){U()(n,t);var e=jr(n);function n(t,r){var i;return N()(this,n),(i=e.call(this))._transforms=[],i._transformsById={},i._transformsByName={},i.unityRenderer=new Nr(t),i.unityAnimator=new Ur(r),i._unityComponents=new Wr,i}return F()(n,[{key:"handleLoaded",value:function(){this.unityRenderer.handleLoaded()}},{key:"update",value:function(t,e){this.unityAnimator.update(e),this.unityRenderer.update()}},{key:"drawOpaque",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.unityRenderer.drawOpaque(t,e)}},{key:"drawTransparent",value:function(t){this.unityRenderer.drawTransparent(t)}},{key:"addTransform",value:function(t){this._transforms.push(t),this._transformsById[t.id]=t,this._transformsByName[t.name]=t}},{key:"getTransformById",value:function(t){return this._transformsById[t]}},{key:"getTransformByName",value:function(t){return this._transformsByName[t]}},{key:"destruct",value:function(){var t;this.unityAnimator.destruct(),this.unityRenderer.destruct(),null===(t=this._unityComponents)||void 0===t||t.destruct(),we()(H()(n.prototype),"destruct",this).call(this)}},{key:"transforms",get:function(){return this._transforms}},{key:"components",get:function(){return this._unityComponents},set:function(t){this._unityComponents=t}},{key:"rootTransform",get:function(){return this.transforms[0]}}]),n}(xe),Kr=function(){function t(e,n){N()(this,t),this.loaded=!1,this._url=n,e.add(this)}return F()(t,[{key:"load",value:function(t){var e=this;Pn.loadText(this._url,(function(n){e._text=n,e.loaded=!0,t.call(e)}))}},{key:"text",get:function(){if(void 0===this._text)throw new Error("Trying to get TextLoader.text property but loading is not complete for: ".concat(this._url));return this._text}}]),t}();function qr(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return Zr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Zr(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Zr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Qr(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Jr=function(t){U()(n,t);var e=Qr(n);function n(t,r,i,a,o,s){var l,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:24;N()(this,n),(l=e.call(this,t,r,"unlit")).texture0ScaleOffset=new un(1,1,0,0),l.texture1ScaleOffset=new un(1,1,0,0),l.texture2ScaleOffset=new un(1,1,0,0),l.transparent=!1,l.sortBackToFront=!1,l.skinned=!1,l.terrain=!1,l.fade=!1,l.textureScroll=!1,l.textured=!1,l.backFaceTint=!1,l.billboard=!1,l.colorLayer=!1,l.merge=!0,l.fog=!0,l.movement=!1,l.occluder=!1,l.timeScroll=!1,l.trackDeform=!1,l.water=!1,l.bottle=!1,l.uniforms=[],l.name=i.name,i.shaderName.indexOf("Transparent")>=0&&(l.transparent=!0),i.shaderName.indexOf("TrackDeform")>=0&&(l.trackDeform=!0),i.shaderName.indexOf("Bottle")>=0&&(l.bottle=!0,l.fog=!1),i.shaderName.indexOf("ATC")>=0&&(l.alphaToCoverage=!0,l.transparent=!0,l.setCullingDisabled()),"Sprites/Default"==i.shaderName&&(l.transparent=!0),"Webgl/Billboard"==i.shaderName&&(l.transparent=!0,l.merge=!1,l.billboard=!0),"Webgl/UnlitTransparentColorLayer"==i.shaderName&&(l.colorLayer=!0),"Webgl/UnlitColorLayer"==i.shaderName&&(l.colorLayer=!0),"Webgl/TextureScroll"==i.shaderName&&(l.transparent=!0,l.textureScroll=!0),"Webgl/TextureScrollATC"==i.shaderName&&(l.textureScroll=!0),"Webgl/TintedBackfaceATC"==i.shaderName&&(l.backFaceTint=!0,l.movement=!0),"Webgl/UnlitTransparentFade"==i.shaderName&&(l.addShaderDefines(["FADE",1]),l.fade=!0),"Webgl/UnlitSkinned"==i.shaderName&&(l.skinned=!0),"Webgl/UnlitTerrain"==i.shaderName&&(l.terrain=!0),"Webgl/Water"==i.shaderName&&(l.water=!0),"Webgl/Occlude"==i.shaderName&&(l.occluder=!0,l.fog=!1),"Webgl/TimeScroll"!=i.shaderName&&"Webgl/TransparentTimeScroll"!=i.shaderName||(l.timeScroll=!0);var c,f=qr(i.properties);try{for(f.s();!(c=f.n()).done;){var h=c.value;switch(h.name){case"_MainTex":l.texture=l.getTexture(a,h.sValue,r,o,s,l.transparent),l.uniforms.push({name:"_MainTex_ST",value:[h.vValue[0],h.vValue[1],h.vValue[2],h.vValue[3]]}),l.textured=!0;break;case"_Texture0":l.texture0=l.getTexture(a,h.sValue,r,o,s),l.texture0ScaleOffset.setValues(h.vValue[0],h.vValue[1],h.vValue[2],h.vValue[3]);break;case"_Texture1":l.texture1=l.getTexture(a,h.sValue,r,o,s),l.texture1ScaleOffset.setValues(h.vValue[0],h.vValue[1],h.vValue[2],h.vValue[3]);break;case"_Texture2":l.texture2=l.getTexture(a,h.sValue,r,o,s),l.texture2ScaleOffset.setValues(h.vValue[0],h.vValue[1],h.vValue[2],h.vValue[3]);break;case"_MaskTex":l.mask=l.getTexture(a,h.sValue,r,o,s,!1,!0);break;case"_AlphaTex":l.alphaMap=l.getTexture(a,h.sValue,r,o,s,!1,!0);break;default:""==h.sValue?l.uniforms.push({name:h.name,value:h.vValue}):Se.ENABLED&&console.warn("unhandled property",h)}}}catch(d){f.e(d)}finally{f.f()}return Se.ENABLED&&l.addShaderDefines(["DEBUG",1]),l.movement&&l.addShaderDefines(["MOVEMENT",1]),l.timeScroll&&l.addShaderDefines(["TIME_SCROLL",1]),l.fog&&l.addShaderDefines(["FOG",1]),l.colorLayer&&l.addShaderDefines(["COLOR_LAYER",1]),l.billboard&&l.addShaderDefines(["BILLBOARD",1]),l.terrain&&l.addShaderDefines(["TERRAIN",1]),l.textureScroll&&l.addShaderDefines(["TEXTURE_SCROLL",1]),l.backFaceTint&&l.addShaderDefines(["BACKFACE_TINT",1]),l.textured&&l.addShaderDefines(["TEXTURED",1]),l.alphaMap&&l.addShaderDefines(["ALPHA_MAP",1]),l.trackDeform&&l.addShaderDefines(["TRACK_DEFORM",1]),l.water&&l.addShaderDefines(["WATER",1]),l.bottle&&l.addShaderDefines(["BOTTLE",1]),l.transparent&&(l.setAlphaBlending(),l.addShaderDefines(["TRANSPARENT",1]),l.sortBackToFront=!0),l.alphaToCoverage&&(l.depthWrite=!0,l.addShaderDefines(["ALPHA_TO_COVERAGE",1]),l.sortBackToFront=!1),l.skinned&&(u>0?(l.addShaderDefines(["SKINNED_MATRICES",1]),l.addShaderDefines(["BONE_COUNT",u]),Se.ENABLED&&console.log("skinned material: boneCount: ",u)):Se.ENABLED&&console.error("bonecount should be > 0 on mesh that uses skinned material",i,u)),l.blend=!0,l.blendEquation=dn.FUNC_ADD,l.setBlendUnified(dn.ONE,dn.ONE_MINUS_SRC_ALPHA),l}return F()(n,[{key:"getTexture",value:function(t,e,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=a?qn.RGBA_UNSIGNED_BYTE:qn.RGB_UNSIGNED_BYTE;o&&(s=qn.LUMINANCE_UNSIGNED_BYTE);var l=br.getFileName(t+e,a);return r[e]||(r[e]=new Ar(this.renderer,n,l,i[e].mipmap,!0,i[e].clamp,!0,s)),r[e]}},{key:"init",value:function(){this.textured&&(this.setTexture("_Texture",this.texture),this.setVector2("_TextureResolution",this.texture.size)),this.terrain&&(this.setTexture("_Texture0",this.texture0),this.setVector4("_Texture0ScaleOffset",this.texture0ScaleOffset),this.setTexture("_Texture1",this.texture1),this.setVector4("_Texture1ScaleOffset",this.texture1ScaleOffset),this.setTexture("_Texture2",this.texture2),this.setVector4("_Texture2ScaleOffset",this.texture2ScaleOffset)),this.mask&&this.setTexture("_Mask",this.mask),this.alphaMap&&this.setTexture("_AlphaMap",this.alphaMap),this.setVector4("_Color",new un(1,1,1,1)),this.alphaToCoverage&&(this.setFloat("_Cutoff",.6),this.setFloat("_EdgeSoftness",1.5)),this.setFloatUniforms(this.uniforms,!1)}},{key:"setFloatUniforms",value:function(t){for(var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=0;n<t.length;n++){var r=t[n];if(e){for(var i=this.uniforms[n],a=!1,o=0;o<r.value.length;o++)r.value[o]!=i.value[o]&&(i.value[o]=r.value[o],a=!0);if(!a)continue}1==r.value.length?this.setFloat(r.name,r.value[0]):2==r.value.length?this.setVector2(r.name,new vn(r.value[0],r.value[1])):3==r.value.length?this.setVector3(r.name,new Oe(r.value[0],r.value[1],r.value[2])):4==r.value.length&&this.setVector4(r.name,new un(r.value[0],r.value[1],r.value[2],r.value[3]))}}},{key:"destruct",value:function(){we()(H()(n.prototype),"destruct",this).call(this)}}]),n}(kn);function ti(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return ei(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ei(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function ei(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var ni,ri=function(){function t(){N()(this,t),this.position=new Oe,this.rotation=new ur,this.scale=new Oe(1,1,1),this.inverseBindpose=new or,this.bindTransform=new cr,this.bindPosition=new Oe,this.bindRotation=new ur,this.bindScale=new Oe(1,1,1)}return F()(t,[{key:"identity",value:function(){this.position.x=0,this.position.y=0,this.position.z=0,this.rotation.identity(),this.scale.x=1,this.scale.y=1,this.scale.z=1}}]),t}(),ii=function(){function t(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4?arguments[4]:void 0;N()(this,t),this.bones=[],this.id=0,this.boneTransformMap={},this.transformMap={},this.bonesMap={},this.tempMat4=new or,this.rootInverseMat4=new or,null===r&&(r=n),this._renderer=e,this.bones=n,this.id=i,this.clips=a;var o,s=ti(r);try{for(s.s();!(o=s.n()).done;){var l=o.value;this.transformMap[l.id]=l}}catch(_){s.e(_)}finally{s.f()}var u,c=ti(n);try{for(c.s();!(u=c.n()).done;){var f=u.value;this.bonesMap[f.id]=f}}catch(_){c.e(_)}finally{c.f()}var h,d=ti(a);try{for(d.s();!(h=d.n()).done;){var v=h.value;v.transformsTracks=v.createTransformTracks(v.tracks,this.transformMap)}}catch(_){d.e(_)}finally{d.f()}this.bones[0]&&this.bones[0].getParent()&&(this.rootTransform=this.bones[0].getParent()),this.rootTransform?or.invert(this.rootInverseMat4,this.rootTransform.worldMatrix):or.identity(this.rootInverseMat4);var p,m=ti(n);try{for(m.s();!(p=m.n()).done;){var y=p.value,g=this.getCachedBoneTransform(y.id);or.copy(this.tempMat4,y.worldMatrix),or.multiply(this.tempMat4,this.rootInverseMat4,this.tempMat4),or.invert(g.inverseBindpose,this.tempMat4),this.boneTransformMap[y.id]=g}}catch(_){m.e(_)}finally{m.f()}this.initBoneStorageData(n.length),this.updateBoneStorageData(n)}return F()(t,[{key:"setRootTransform",value:function(t){this.rootTransform=t}},{key:"initBoneStorageData",value:function(t){this.boneMatrices=new Float32Array(16*t)}},{key:"updateBoneStorageData",value:function(t){if(0!==t.length){this.rootTransform?or.invert(this.rootInverseMat4,this.rootTransform.worldMatrix):or.identity(this.rootInverseMat4);var e,n=0,r=ti(t);try{for(r.s();!(e=r.n()).done;){var i=e.value;if(-1===i.id)throw new ReferenceError("expected all transforms to have an id");or.multiply(this.tempMat4,i.worldMatrix,this.boneTransformMap[i.id].inverseBindpose),or.multiply(this.tempMat4,this.rootInverseMat4,this.tempMat4);for(var a=16*n,o=a;o<a+16;o++)this.boneMatrices[o]=this.tempMat4.m[o-a];n++}}catch(s){r.e(s)}finally{r.f()}}}},{key:"applySkinning",value:function(){var t,e=ti(this.clips);try{for(e.s();!(t=e.n()).done;){var n,r=ti(t.value.transformsTracks);try{for(r.s();!(n=r.n()).done;){var i=n.value.transform,a=this.boneTransformMap[i.id];a&&(a.position=i.position,a.rotation=i.rotation,a.scale=i.scale)}}catch(o){r.e(o)}finally{r.f()}}}catch(o){e.e(o)}finally{e.f()}this.updateBoneStorageData(this.bones)}},{key:"getCachedBoneTransform",value:function(t){var e=this.boneTransformMap[t];if(e)return e;var n=this.transformMap[t];if(n)return(e=new ri).position=n.position,e.scale=n.scale,e.rotation=n.rotation,e.bindPosition=n.position,e.bindScale=n.scale,e.bindRotation=n.rotation,e.bindTransform.setPositionRotationScale(n.position,n.rotation,n.scale),this.boneTransformMap[t]=e,e;throw new Error("getCachedBoneTransform: transform not found")}},{key:"setTransform",value:function(t,e){t.setPositionRotationScale(e.position,e.rotation,e.scale)}},{key:"destruct",value:function(){}}]),t}();function ai(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return oi(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oi(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function oi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function si(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}!function(t){t.PositionX="Position.x",t.PositionY="Position.y",t.PositionZ="Position.z",t.RotationX="Rotation.x",t.RotationY="Rotation.y",t.RotationZ="Rotation.z",t.RotationW="Rotation.w",t.ScaleX="Scale.x",t.ScaleY="Scale.y",t.ScaleZ="Scale.z",t.Float="Float",t.NotSet="NotSet"}(ni||(ni={}));var li=function(t){U()(n,t);var e=si(n);function n(t,r,i,a,o){var s;return N()(this,n),(s=e.call(this))._lastIndex=0,s._lastTime=0,s.name=t,s.transformId=r,s.type=i,s.times=a,s.values=o,s}return F()(n,[{key:"getIsEmpty",value:function(){var t=this.values.length;if(t<2)return!0;for(var e=1;e<t;++e)if(this.values[e-1]!=this.values[e])return!1;return!0}},{key:"evaluate",value:function(t){if(0===this.values.length)return 0;if(1===this.values.length)return this.values[0];if(0===t)return this.values[0];if(t<this.times[0])return this.values[0];if(t>=this.times[this.times.length-1])return this.values[this.values.length-1];var e=this.getFramePositions(t);return this.lerp(this.values[e.lowFrame],this.values[e.highFrame],e.ratio)}},{key:"lerp",value:function(t,e,n){return(1-n)*t+n*e}},{key:"getFramePositions",value:function(t){var e=this.times.length,n=t>=this._lastTime?this._lastIndex:0;this._lastTime=t;for(var r=n;r<e-1;r++){var i=this.times[r],a=this.times[r+1];if(t>=i&&t<=a)return this._lastIndex=r,{lowFrame:r,highFrame:r+1,ratio:(t-i)/(a-i)}}return Se.ENABLED&&console.log("getFramePositions: could not find frame: ",this.name,this.type,t,this._lastTime,this._lastIndex,n,this.times[0],this.times[e-1],e),{lowFrame:0,highFrame:0,ratio:0}}},{key:"scaleFrameTimesTo",value:function(t){for(var e=this.times[this.times.length-1],n=0;n<this.times.length;n++)this.times[n]*=t/e}}],[{key:"deserialize",value:function(t){var e=t.name,r=t.transformId,i=t.times,a=t.values;return new n(e,r,t.type,i,a)}}]),n}(xe),ui=function(){function t(e,n){N()(this,t),this.animatePosition=!1,this.animateRotation=!1,this.animateScale=!1,this.transform=e;var r,i=ai(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;a.type!=ni.PositionX&&a.type!=ni.PositionY&&a.type!=ni.PositionZ||(this.animatePosition=!0),a.type!=ni.RotationX&&a.type!=ni.RotationY&&a.type!=ni.RotationZ&&a.type!=ni.RotationW||(this.animateRotation=!0),a.type!=ni.ScaleX&&a.type!=ni.ScaleY&&a.type!=ni.ScaleZ||(this.animateScale=!0)}}catch(o){i.e(o)}finally{i.f()}this.p=e.position,this.r=e.rotation,this.s=e.scale,this.tracks=n}return F()(t,[{key:"update",value:function(t){var e,n=ai(this.tracks);try{for(n.s();!(e=n.n()).done;){var r=e.value;switch(r.type){case ni.PositionX:this.p.x=r.evaluate(t);break;case ni.PositionY:this.p.y=r.evaluate(t);break;case ni.PositionZ:this.p.z=r.evaluate(t);break;case ni.RotationX:this.r.x=r.evaluate(t);break;case ni.RotationY:this.r.y=r.evaluate(t);break;case ni.RotationZ:this.r.z=r.evaluate(t);break;case ni.RotationW:this.r.w=r.evaluate(t);break;case ni.ScaleX:this.s.x=r.evaluate(t);break;case ni.ScaleY:this.s.y=r.evaluate(t);break;case ni.ScaleZ:this.s.z=r.evaluate(t)}}}catch(i){n.e(i)}finally{n.f()}this.animatePosition&&(this.transform.position=this.p),this.animateRotation&&(this.transform.rotation=this.r.normalize()),this.animateScale&&(this.transform.scale=this.s)}}]),t}();function ci(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return fi(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fi(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function fi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function hi(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var di=function(){function t(){N()(this,t),this.time=0,this.name="unnamed event",this.timeOld=0}return F()(t,[{key:"update",value:function(t,e){this.timeOld<this.time&&t>=this.time&&e(this.name),this.timeOld=t}}],[{key:"deserialize",value:function(e){var n=new t;return n.time=e.time,n.name=e.name,n}}]),t}(),vi=function(t){U()(n,t);var e=hi(n);function n(t,r,i,a){var o;return N()(this,n),(o=e.call(this)).duration=0,o.name="not set",o.transformsTracks=[],o.duration=r,o.name=t,o.tracks=i,o.events=a,o}return F()(n,[{key:"update",value:function(t,e){var n,r=ci(this.events);try{for(r.s();!(n=r.n()).done;){n.value.update(t,e)}}catch(i){r.e(i)}finally{r.f()}}},{key:"createTransformTracks",value:function(t,e){var n,r={},i=ci(this.tracks);try{for(i.s();!(n=i.n()).done;){var a=n.value;a.type!=ni.PositionX&&a.type!=ni.PositionY&&a.type!=ni.PositionZ&&a.type!=ni.RotationX&&a.type!=ni.RotationY&&a.type!=ni.RotationZ&&a.type!=ni.RotationW&&a.type!=ni.ScaleX&&a.type!=ni.ScaleY&&a.type!=ni.ScaleZ||(r[a.transformId]||(r[a.transformId]=[]),r[a.transformId].push(a))}}catch(u){i.e(u)}finally{i.f()}var o=[];for(var s in r){var l=e[parseInt(s)];l?o.push(new ui(l,r[s])):console.warn("transform not found",s,e,r)}return o}},{key:"destruct",value:function(){if(this.tracks){var t,e=ci(this.tracks);try{for(e.s();!(t=e.n()).done;){t.value.destruct()}}catch(r){e.e(r)}finally{e.f()}}we()(H()(n.prototype),"destruct",this).call(this)}}],[{key:"deserialize",value:function(t){var e,r=[],i=ci(t.tracks);try{for(i.s();!(e=i.n()).done;){var a=e.value;r.push(li.deserialize(a))}}catch(c){i.e(c)}finally{i.f()}Se.ENABLED&&console.log("tracks",r);var o=[];if(void 0!==t.events){var s,l=ci(t.events);try{for(l.s();!(s=l.n()).done;){var u=s.value;o.push(di.deserialize(u))}}catch(c){l.e(c)}finally{l.f()}}return new n(t.name,t.duration,r,o)}}]),n}(xe);function pi(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return mi(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mi(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function mi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var yi=function(){function t(e){N()(this,t),this.uniforms=[],this.sharedMaterial=e,this.uniforms=JSON.parse(JSON.stringify(this.sharedMaterial.uniforms))}return F()(t,[{key:"setInstanceUniforms",value:function(){this.sharedMaterial.setFloatUniforms(this.uniforms)}},{key:"setFloat",value:function(t,e,n){var r,i=pi(this.uniforms);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a.name==t){a.value[e]=n;break}}}catch(o){i.e(o)}finally{i.f()}}}]),t}();function gi(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return _i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _i(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function _i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Ei=function(){function t(){N()(this,t)}return F()(t,null,[{key:"load",value:function(e,n,r,i,a,o){var s=new Kr(n,r);n.setCallbackForPreloadable(s,(function(){t.parseJson(e,n,JSON.parse(s.text),i,a,o)}))}},{key:"parseJson",value:function(t,e,n,r,i,a){Se.ENABLED&&console.log("parseJson",n,i),this.parseTransforms(n,r),this.parseMaterials(t,e,n,r,i,a),this.parseAnimations(t,n,r),this.parseMeshes(t,n,r),this.parseMeshRenderers(t,n,r),this.parseComponents(n,r)}},{key:"parseTransforms",value:function(t,e){for(var n=0;n<t.transforms.length;n++){var r=t.transforms[n],i=this.transformFromData(r);e.getTransformById(r.parentId)&&i.setParent(e.getTransformById(r.parentId)),e.addTransform(i)}}},{key:"transformFromData",value:function(t){var e=new cr;return e.setPositionRotationScale(new Oe(t.position[0],t.position[1],t.position[2]),new ur(t.rotation[0],t.rotation[1],t.rotation[2],t.rotation[3]),new Oe(t.scale[0],t.scale[1],t.scale[2])),e.name=t.name,e.id=t.id,e}},{key:"parseMaterials",value:function(t,e,n,r,i,a){var o,s={},l=gi(n.textures);try{for(l.s();!(o=l.n()).done;){var u=o.value;s[u.name]=u}}catch(v){l.e(v)}finally{l.f()}Se.ENABLED&&console.log("textureInfoByName",s);var c,f=gi(n.materials);try{for(f.s();!(c=f.n()).done;){var h=c.value;if(null==r.unityRenderer.getMaterialByName(h.name)){var d=new Jr(t,e,h,i,a,s);r.unityRenderer.addMaterial(d,h.id)}else Se.ENABLED&&console.log("shared material",h.name)}}catch(v){f.e(v)}finally{f.f()}}},{key:"parseAnimations",value:function(t,e,n){var r,i=0,a=0,o=gi(e.animations);try{for(o.s();!(r=o.n()).done;){var s,l=r.value,u=[],c=[],f=gi(l.clips);try{for(f.s();!(s=f.n()).done;){var h=s.value;u.push(vi.deserialize(h))}}catch(A){f.e(A)}finally{f.f()}if(Se.ENABLED){var d,v=gi(u);try{for(v.s();!(d=v.n()).done;){var p=d.value;i+=p.tracks.length;var m,y=gi(p.tracks);try{for(y.s();!(m=y.n()).done;){a+=m.value.values.length}}catch(A){y.e(A)}finally{y.f()}}}catch(A){v.e(A)}finally{v.f()}}var g,_=gi(l.bones);try{for(_.s();!(g=_.n()).done;){var E=g.value;c.push(n.getTransformById(E.transformId))}}catch(A){_.e(A)}finally{_.f()}var T=new ii(t,c,n.transforms,l.id,u);n.unityAnimator.addAnimator(T)}}catch(A){o.e(A)}finally{o.f()}Se.ENABLED&&(console.log("trackCount",i),console.log("keyCount",a))}},{key:"parseMeshes",value:function(t,e,n){var r,i=gi(e.meshes);try{for(i.s();!(r=i.n()).done;){var a=r.value,o=a.instanceId;if(n.unityRenderer.meshById[o])console.error("mesh has duplicate id",a.meshId);else{var s=new Bn(t);s.name=a.name,a.indices.length>0&&s.setIndices(new Uint16Array(a.indices));var l,u=gi(a.attributes);try{for(u.s();!(l=u.n()).done;){var c=l.value;s.setAttribute(c.name,c.stride,new Float32Array(c.data))}}catch(f){u.e(f)}finally{u.f()}n.unityRenderer.addMesh(s,o)}}}catch(f){i.e(f)}finally{i.f()}Se.ENABLED&&console.log("imported meshes: unique",n.unityRenderer.meshes.length)}},{key:"parseMeshRenderers",value:function(t,e,n){var r,i=0,a=gi(e.models);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=new Or;null!=n.getTransformById(o.transformId)?s.transform=n.getTransformById(o.transformId):console.error("transform not found for model");var l=new Oe(o.bbCenter[0],o.bbCenter[1],o.bbCenter[2]),u=new Oe(o.bbExtents[0],o.bbExtents[1],o.bbExtents[2]);s.bbMin=Oe.subtract(l,u),s.bbMax=Oe.add(l,u),s.isStatic=o.isStatic;var c=n.unityRenderer.materialById[o.materialId];null!=c?s.material=new yi(c):console.error("material not found for model",s.transform.name,o.material),s.mesh=n.unityRenderer.meshById[o.meshId],s.animator=n.unityAnimator.animatorsById[o.animatorId],s.mesh||console.error("mesh not found for model",o.meshId),i+=s.mesh.getNumVertices(),n.unityRenderer.addMeshRenderer(s)}}catch(f){a.e(f)}finally{a.f()}Se.ENABLED&&console.log("imported model: vertexCount",i,"objects",n.unityRenderer.meshRenderers.length)}},{key:"parseComponents",value:function(t,e){e.components=Xr.parseComponents(t,e)}}]),t}();var Ti=function(){function t(e,n,r,i){N()(this,t),this.channel=0,this.material=e,this.name=n,"y"==r?this.channel=1:"z"==r?this.channel=2:"w"==r?this.channel=3:"r"==r?this.channel=0:"g"==r?this.channel=1:"b"==r?this.channel=2:"a"==r&&(this.channel=3),this.keyframeTrack=i}return F()(t,[{key:"update",value:function(t){this.material.setFloat(this.name,this.channel,this.keyframeTrack.evaluate(t))}}]),t}(),Ai=function(){function t(e,n){N()(this,t),this.model=e,this.keyframeTrack=n}return F()(t,[{key:"update",value:function(t){this.model.visible=this.keyframeTrack.evaluate(t)>.5}}]),t}();function Ri(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return bi(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bi(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function bi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function wi(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Si=function(t){U()(n,t);var e=wi(n);function n(t,r,i,a){var o;N()(this,n),(o=e.call(this))._isInit=!1,o.duration=1,o.keyDrivenAttributes=[],o.scenePath="scenes/",o.texturePool={},o.fogSettings=new un,o.time=0,o.playing=!0,o.playSpeed=1,o.ended=!1,o.sceneId=i,o.eventDispatcher=a,Se.ENABLED&&console.time("load: "+o.sceneId),o.renderer=t,o.unity=new Yr(t,a);var s=br.getStaticDir()+"webgl/"+o.scenePath+i+".json";return Ei.load(t,r,s,o.unity,o.scenePath,o.texturePool),o}return F()(n,[{key:"reset",value:function(){Se.ENABLED&&console.log("Scene: reset",this.sceneId),this.normalizedAnimationProgress=0,this.hardPaused=!1,this.playSpeed=1,this.ended=!1,this.playing=!0}},{key:"init",value:function(){if(Se.ENABLED&&console.log("Scene: init",this.sceneId),!this._isInit){Se.ENABLED&&(this.datGui=new nn(null));var t=new je;t.init(this.sceneId),this.unity.handleLoaded(),this.unity.components.sceneReferences?this.getTimeline(this.unity.components.sceneReferences):console.error("no scene references",this.sceneId),this.sky=this.unity.getTransformByName("sky"),this.initAnimationListeners(),this.postInit(t);for(var e=0;e<t.children.length;e++)t.children[e].collapsed=!0;if(this.datGui&&this.datGui.init(t),Se.ENABLED){var n=0;for(var r in this.texturePool){var i=this.texturePool[r];n+=i.width*i.height*i.channelCount/1048576}Se.ENABLED&&console.log("textureMemoryUsed",Math.floor(n)+" MB")}this._isInit=!0,Se.ENABLED&&console.timeEnd("load: "+this.sceneId)}}},{key:"getTimeline",value:function(t){t.mainTimeline?this.duration=t.mainTimeline.duration:console.error("no timeline linked to scene references",this.sceneId)}},{key:"initAnimationListeners",value:function(){var t,e=Ri(this.model.unityAnimator.animators);try{for(e.s();!(t=e.n()).done;){var n,r=Ri(t.value.clips);try{for(r.s();!(n=r.n()).done;){var i,a=Ri(n.value.tracks);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=o.name.split(".");if(s.length>=2){var l=this.model.getTransformById(o.transformId);if(l){var u,c=Ri(this.model.unityRenderer.getRenderersById(l.id));try{for(c.s();!(u=c.n()).done;){var f=u.value;"material"==s[1]?this.keyDrivenAttributes.push(new Ti(f.material,s[2],s[3],o)):"m_IsActive"==s[1]&&this.keyDrivenAttributes.push(new Ai(f,o))}}catch(h){c.e(h)}finally{c.f()}}}}}catch(h){a.e(h)}finally{a.f()}}}catch(h){r.e(h)}finally{r.f()}}}catch(h){e.e(h)}finally{e.f()}}},{key:"postInit",value:function(t){}},{key:"update",value:function(t){this.playSpeed+=this.playing?2*t:2*-t,this.playSpeed=Fe.clamp01(this.playSpeed),this.time+=this.playSpeed*t,this.time>=this.duration?(this.time=this.duration,this.ended||(this.eventDispatcher.dispatchEvent(new Re(Re.ANIMATION_END,{data:this.sceneId})),this.ended=!0)):this.ended=!1;var e,n=Ri(this.keyDrivenAttributes);try{for(n.s();!(e=n.n()).done;){e.value.update(this.time)}}catch(r){n.e(r)}finally{n.f()}this.unity.update(t,this.time),this.setFog()}},{key:"setCameraPosition",value:function(t){this.sky&&(this.sky.position=t)}},{key:"setFog",value:function(){this.fogSettings.x=this.unity.unityAnimator.getValueOfTrack("fogColor.r",this.time),this.fogSettings.y=this.unity.unityAnimator.getValueOfTrack("fogColor.g",this.time),this.fogSettings.z=this.unity.unityAnimator.getValueOfTrack("fogColor.b",this.time),this.fogSettings.w=.01*this.unity.unityAnimator.getValueOfTrack("fogAmount",this.time),this.unity.unityRenderer.setColor("_Fog",this.fogSettings)}},{key:"draw",value:function(t,e){this.unity.drawOpaque(t,e),this.drawOpaque(t,e),this.unity.drawTransparent(t),this.drawTransparent(t,e)}},{key:"drawOpaque",value:function(t,e){}},{key:"drawTransparent",value:function(t,e){}},{key:"destruct",value:function(){var t,e;for(var r in null===(t=this.unity)||void 0===t||t.destruct(),this.texturePool)this.texturePool[r].destruct();null===(e=this.datGui)||void 0===e||e.destruct(),we()(H()(n.prototype),"destruct",this).call(this)}},{key:"secondsRemaining",get:function(){return this.duration-this.time}},{key:"animationTime",get:function(){return this.time}},{key:"normalizedAnimationProgress",get:function(){return this.duration>0?this.time/this.duration:0},set:function(t){this.time=t*this.duration}},{key:"paused",set:function(t){this.playing=!t}},{key:"hardPaused",set:function(t){this.playing=!t,this.playSpeed=this.playing?1:0}},{key:"model",get:function(){return this.unity}},{key:"isInit",get:function(){return this._isInit}},{key:"cameraMix",get:function(){return 0}}]),n}(xe);function xi(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return ki(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ki(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function ki(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Mi(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Ci=function(t){U()(n,t);var e=Mi(n);function n(t,r){var i;return N()(this,n),(i=e.call(this)).count=64,i.progressRange=.2,i.transformTrack=null,i.materials=[],i.path=[],i.minMaxZ=new vn,i.renderer=t,i.deformArray=new Float32Array(2*i.count),i}return F()(n,[{key:"init",value:function(t,e){this.transformTrack=t.unity.unityAnimator.getTransformTrackByName("Path"),this.materials=e}},{key:"update",value:function(t,e){if(this.transformTrack)for(var n=0,r=0;r<this.count;r++){var i=(t+r/this.count*this.progressRange)*e;this.transformTrack.update(i);var a=this.transformTrack.transform.worldPosition;this.path[r]=a,this.deformArray[n++]=a.x,this.deformArray[n++]=a.y}this.minMaxZ.x=this.path[0].z,this.minMaxZ.y=this.path[this.count-1].z;var o,s=xi(this.materials);try{for(s.s();!(o=s.n()).done;){var l=o.value;l.setVector2Array("_Deform",this.deformArray),l.setVector2("_MinMaxZ",this.minMaxZ)}}catch(u){s.e(u)}finally{s.f()}this.transformTrack&&this.transformTrack.update(t*e)}},{key:"destruct",value:function(){we()(H()(n.prototype),"destruct",this).call(this)}}]),n}(xe);function Ii(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Pi=function(t){U()(n,t);var e=Ii(n);function n(t,r,i){var a;return N()(this,n),(a=e.call(this,t,r,Ta.TRACK_2,i)).birds=new xr(t,r,new Oe(10,0,100)),a.trackDeform=new Ci(t,r),a}return F()(n,[{key:"postInit",value:function(t){this.birds.init(t),this.birds.centerBias.setValue(.075),this.trackDeform.init(this,this.unity.unityRenderer.materials)}},{key:"update",value:function(t){we()(H()(n.prototype),"update",this).call(this,t)}},{key:"draw",value:function(t,e){this.trackDeform.update(this.normalizedAnimationProgress,this.duration),we()(H()(n.prototype),"draw",this).call(this,t,e)}},{key:"drawOpaque",value:function(t,e){var n=t.worldPosition,r=t.view.transform.worldForward;n.x-=16*r.x,n.z-=16*r.z,n.y+=8,this.birds.setCenter(n),this.birds.draw(t)}},{key:"drawTransparent",value:function(t,e){}},{key:"destruct",value:function(){this.birds.destruct(),we()(H()(n.prototype),"destruct",this).call(this)}}]),n}(Si);function Di(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Oi=function(t){U()(n,t);var e=Di(n);function n(t,r,i){var a;return N()(this,n),(a=e.call(this,t,r,Ta.TRACK_3,i)).trackDeform=new Ci(t,r),a}return F()(n,[{key:"init",value:function(){we()(H()(n.prototype),"init",this).call(this),this.trackDeform.init(this,this.unity.unityRenderer.materials)}},{key:"draw",value:function(t,e){this.trackDeform.update(this.normalizedAnimationProgress,this.duration),we()(H()(n.prototype),"draw",this).call(this,t,e)}}]),n}(Si);function Ni(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Li=function(t){U()(n,t);var e=Ni(n);function n(t,r,i){var a;return N()(this,n),(a=e.call(this,t,r,Ta.TRACK_1,i)).birds=new xr(t,r,new Oe(0,6,100)),a}return F()(n,[{key:"postInit",value:function(t){this.birds.init(t)}},{key:"update",value:function(t){we()(H()(n.prototype),"update",this).call(this,t)}},{key:"drawOpaque",value:function(t,e){this.birds.draw(t)}},{key:"drawTransparent",value:function(t,e){}},{key:"destruct",value:function(){this.birds.destruct(),we()(H()(n.prototype),"destruct",this).call(this)}}]),n}(Si);function Fi(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Bi=function(t){U()(n,t);var e=Fi(n);function n(t,r,i){var a;return N()(this,n),(a=e.call(this)).sceneId=Ta.NONE,a._scene=null,a.renderer=t,a.eventDispatcher=i,a}return F()(n,[{key:"loadScene",value:function(t,e){var n;switch(null===(n=this._scene)||void 0===n||n.destruct(),t){case Ta.NONE:this._scene=null;break;case Ta.TRACK_1:this._scene=new Li(this.renderer,e,this.eventDispatcher);break;case Ta.TRACK_2:this._scene=new Pi(this.renderer,e,this.eventDispatcher);break;case Ta.TRACK_3:this._scene=new Oi(this.renderer,e,this.eventDispatcher);break;default:return void console.warn("unhandled worldId: ",t)}this.sceneId=t}},{key:"handleSceneLoaded",value:function(){this._scene?this._scene.init():console.warn("handleSceneLoaded: no scene")}},{key:"destruct",value:function(){var t;null===(t=this._scene)||void 0===t||t.destruct(),we()(H()(n.prototype),"destruct",this).call(this)}},{key:"scene",get:function(){return this._scene}}]),n}(xe),Ui=function(){function t(){N()(this,t),this.planes=[],this.points=[],this.m=new or;for(var e=0;e<6;++e)this.planes.push(new un);for(var n=0;n<8;++n)this.points.push(new Oe)}return F()(t,[{key:"updateForCamera",value:function(t){or.transpose(this.m,t.viewProjection);var e=t.viewProjection.m;this.planes[0].setValues(e[3]-e[0],e[7]-e[4],e[11]-e[8],e[15]-e[12]),this.planes[1].setValues(e[3]+e[0],e[7]+e[4],e[11]+e[8],e[15]+e[12]),this.planes[2].setValues(e[3]+e[1],e[7]+e[5],e[11]+e[9],e[15]+e[13]),this.planes[3].setValues(e[3]-e[1],e[7]-e[5],e[11]-e[9],e[15]-e[13]),this.planes[4].setValues(e[3]-e[2],e[7]-e[6],e[11]-e[10],e[15]-e[14]),this.planes[5].setValues(e[3]+e[2],e[7]+e[6],e[11]+e[10],e[15]+e[14]),this.planes.forEach((function(t){t.multiplyScalar(1/Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2)+Math.pow(t.z,2)))}))}},{key:"pointInFrustum",value:function(t){return this.sphereInFrustum(t,0)}},{key:"sphereInFrustum",value:function(t,e){for(var n=0;n<6;n++)if(this.dot(this.planes[n],t.x,t.y,t.z)<-e)return!1;return!0}},{key:"boxInFrustum",value:function(t,e){for(var n=0;n<6;n++)if(this.dot(this.planes[n],t.x,t.y,t.z)<0&&this.dot(this.planes[n],e.x,t.y,t.z)<0&&this.dot(this.planes[n],t.x,e.y,t.z)<0&&this.dot(this.planes[n],e.x,e.y,t.z)<0&&this.dot(this.planes[n],t.x,t.y,e.z)<0&&this.dot(this.planes[n],e.x,t.y,e.z)<0&&this.dot(this.planes[n],t.x,e.y,e.z)<0&&this.dot(this.planes[n],e.x,e.y,e.z)<0)return!1;return!0}},{key:"dot",value:function(t,e,n,r){return t.x*e+t.y*n+t.z*r+t.w}}]),t}();function Vi(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var zi=function(t){U()(n,t);var e=Vi(n);function n(t){var r,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return N()(this,n),r=e.call(this,t),i?r.positionsOnly(a):r.createWithNormalsAndUV(a),r}return F()(n,[{key:"positionsOnly",value:function(t){var e=new Float32Array([1,1,1,-1,1,1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,-1,-1,-1,-1,-1]);this.setPositions(e,t);var n=new Uint16Array([0,3,2,0,1,3,5,6,7,5,4,6,1,7,3,1,5,7,4,2,6,4,0,2,0,5,1,0,4,5,6,3,7,6,2,3]);this.setIndices(n)}},{key:"createWithNormalsAndUV",value:function(t){var e=new Float32Array([-1,-1,-1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,1,1,-1,1,-1,-1,-1,-1,1,1,-1,1,1,-1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,1,1,-1,1,1,1,-1,-1,1,1,-1,-1,1,-1,-1,-1,-1,-1,-1,1,-1,1,1,1,1,1,1,-1,1]);this.setPositions(e,t);for(var n=new Float32Array(48),r=0,i=0;i<6;i++)n[r++]=0,n[r++]=0,n[r++]=0,n[r++]=1,n[r++]=1,n[r++]=1,n[r++]=1,n[r++]=0;this.setUV0(n,t);for(var a=new Float32Array(72),o=0,s=0;s<4;s++)a[o++]=-1,a[o++]=0,a[o++]=0;for(var l=0;l<4;l++)a[o++]=1,a[o++]=0,a[o++]=0;for(var u=0;u<4;u++)a[o++]=0,a[o++]=-1,a[o++]=0;for(var c=0;c<4;c++)a[o++]=0,a[o++]=1,a[o++]=0;for(var f=0;f<4;f++)a[o++]=0,a[o++]=0,a[o++]=-1;for(var h=0;h<4;h++)a[o++]=0,a[o++]=0,a[o++]=1;this.setNormals(a,t);for(var d=new Uint16Array(36),v=0,p=0;p<6;p++){var m=4*p;d[v++]=m+0,d[v++]=m+2,d[v++]=m+1,d[v++]=m+2,d[v++]=m+0,d[v++]=m+3}this.setIndices(d)}}]),n}(Bn);function Gi(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Hi=function(t){U()(n,t);var e=Gi(n);function n(t,r){var i;return N()(this,n),(i=e.call(this)).spriteGrid=3,i.renderer=t,i.material=new kn(t,r,"snow"),i.material.setPreMultipliedAlphaBlending(),i.material.setDrawTypePoints(),i.mesh=i.createMesh(2048),i.texture=new Ar(t,r,br.getFileName("effects/snowflakes",!1),!0,!0,!0,!0,qn.LUMINANCE_UNSIGNED_BYTE),i}return F()(n,[{key:"createMesh",value:function(t){for(var e=new Float32Array(4*t),n=new Float32Array(4*t),r=0,i=0,a=0;a<t;a++){e[r++]=2*Math.random()-1,e[r++]=2*Math.random()-1,e[r++]=2*Math.random()-1,e[r++]=Math.random(),n[i++]=Math.random(),n[i++]=Math.random();var o=Math.floor(Math.random()*this.spriteGrid*this.spriteGrid);n[i++]=o%this.spriteGrid/this.spriteGrid,n[i++]=Math.floor(o/this.spriteGrid)/this.spriteGrid}var s=new Bn(this.renderer);return s.setAttribute("aData0",4,e),s.setAttribute("aData1",4,n),s}},{key:"init",value:function(t){var e=t.addGroup("snow",this.material);e.addShaderParamFloat("_PointSize",.05,0,.1),e.addShaderParamFloat("_Spread",6,0,10),e.addShaderParamFloat("_Additive",.4),e.addShaderParamFloat("_Opacity",.5),e.addShaderParamFloat("_Gravity",.1),e.addShaderParamFloat("_Amp",.25),this.amount=e.addShaderParamFloat("_Amount",1),this.material.setTexture("_Texture",this.texture),this.material.setFloat("_Grid",this.spriteGrid)}},{key:"update",value:function(t,e,n){this.amount.setValue(n.unityAnimator.getValueOfTrack("snowAmount",t))}},{key:"draw",value:function(t){if(!this.isDestructed&&this.amount.value>0){var e=this.material;e.setFloat("_Time",Un.instance.time),e.setFloat("_ScreenHeight",this.renderer.height),e.setMatrix("_ViewProjection",t.viewProjection),e.setVector3("_CameraPos",t.worldPosition),e.setVector3("_CameraDir",t.view.transform.worldForward),this.renderer.draw(this.mesh,e)}}},{key:"destruct",value:function(){this.material.destruct(),this.mesh.destruct(),this.texture.destruct(),we()(H()(n.prototype),"destruct",this).call(this)}}]),n}(xe);function $i(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Wi=function(t){U()(n,t);var e=$i(n);function n(t,r){var i;return N()(this,n),(i=e.call(this)).windPos=new Oe,i.windDir=new Oe,i.renderer=t,i.material=new kn(t,r,"wind"),i.material.setPreMultipliedAlphaBlending(),i.material.setCullingDisabled(),i.mesh=i.createRibbons(256,32),i}return F()(n,[{key:"createRibbons",value:function(t,e){for(var n=t*e*2,r=new Float32Array(4*n),i=new Float32Array(4*n),a=new Uint16Array(t*(e-1)*2*3),o=0,s=0,l=0,u=0;u<t;u++)for(var c=[2*Math.random()-1,2*Math.random()-1,2*Math.random()-1,Math.random(),Math.random(),Math.random()],f=0;f<e;f++){for(var h=2*(u*e+f),d=0;d<=1;d++){r[o++]=f/(e-1)*2-1,r[o++]=2*d-1,r[o++]=c[4],r[o++]=c[5];for(var v=0;v<4;v++)i[s++]=c[v]}f<e-1&&(a[l++]=h+0,a[l++]=h+1,a[l++]=h+2,a[l++]=h+2,a[l++]=h+1,a[l++]=h+3)}var p=new Bn(this.renderer);return p.setAttribute("aData0",4,r),p.setAttribute("aData1",4,i),p.setIndices(a),Se.ENABLED&&console.log("wind: vertex count",p.getNumVertices()),p}},{key:"init",value:function(t){var e=t.addGroup("wind",this.material);e.addShaderParamFloat("_Length",1,0,1),e.addShaderParamFloat("_Width",.01,0,.1),e.addShaderParamFloat("_Softness",1.5,0,10),e.addShaderParamFloat("_Spread",4,0,10),e.addShaderParamFloat("_Additive",.4),e.addShaderParamFloat("_Opacity",.1),e.addShaderParamFloat("_Speed",.5),e.addShaderParamFloat("_Amplitude",.2),e.addShaderParamFloat("_Frequency",.1),this.amount=e.addShaderParamFloat("_Amount",1)}},{key:"update",value:function(t,e,n){this.windPos.add(this.windDir.multiplyScalar(e)),this.amount.setValue(n.unityAnimator.getValueOfTrack("windAmount",t))}},{key:"draw",value:function(t){if(!this.isDestructed&&this.amount.value>0){var e=this.material;e.setFloat("_Time",Un.instance.time),e.setMatrix("_ViewProjection",t.viewProjection),e.setVector3("_CameraPos",t.worldPosition),e.setVector3("_CameraDir",t.view.transform.worldForward),e.setVector3("_WindPos",this.windPos),this.windDir.copy(t.view.transform.worldForward.multiplyScalar(1)),this.renderer.draw(this.mesh,e)}}},{key:"destruct",value:function(){this.material.destruct(),this.mesh.destruct(),we()(H()(n.prototype),"destruct",this).call(this)}}]),n}(xe);function Xi(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var ji=function(t){U()(n,t);var e=Xi(n);function n(t,r){var i;return N()(this,n),(i=e.call(this)).spriteGrid=1,i.renderer=t,i.material=new kn(t,r,"bubbles"),i.material.setPreMultipliedAlphaBlending(),i.material.setDrawTypePoints(),i.mesh=i.createMesh(2048),i.texture=new Ar(t,r,br.getFileName("effects/bubbles",!0),!0,!0,!0,!0,qn.RGBA_UNSIGNED_BYTE),i}return F()(n,[{key:"createMesh",value:function(t){for(var e=new Float32Array(4*t),n=new Float32Array(4*t),r=0,i=0,a=0;a<t;a++){e[r++]=2*Math.random()-1,e[r++]=2*Math.random()-1,e[r++]=2*Math.random()-1,e[r++]=Math.random(),n[i++]=Math.random(),n[i++]=Math.random();var o=Math.floor(Math.random()*this.spriteGrid*this.spriteGrid);n[i++]=o%this.spriteGrid/this.spriteGrid,n[i++]=Math.floor(o/this.spriteGrid)/this.spriteGrid}var s=new Bn(this.renderer);return s.setAttribute("aData0",4,e),s.setAttribute("aData1",4,n),s}},{key:"init",value:function(t){var e=t.addGroup("bubbles",this.material);e.addShaderParamFloat("_PointSize",.05,0,.1),e.addShaderParamFloat("_Spread",7,0,10),e.addShaderParamFloat("_Additive",.4),e.addShaderParamFloat("_Opacity",.5),e.addShaderParamFloat("_Gravity",-.2),e.addShaderParamFloat("_Amp",.01,0,.1),this.amount=e.addShaderParamFloat("_Amount",1),this.material.setTexture("_Texture",this.texture),this.material.setFloat("_Grid",this.spriteGrid)}},{key:"update",value:function(t,e,n){this.amount.setValue(n.unityAnimator.getValueOfTrack("bubblesAmount",t))}},{key:"draw",value:function(t){if(!this.isDestructed&&this.amount.value>0){var e=this.material;e.setFloat("_Time",Un.instance.time),e.setFloat("_ScreenHeight",this.renderer.height),e.setMatrix("_ViewProjection",t.viewProjection),e.setVector3("_CameraPos",t.worldPosition),e.setVector3("_CameraDir",t.view.transform.worldForward),this.renderer.draw(this.mesh,e)}}},{key:"destruct",value:function(){this.material.destruct(),this.mesh.destruct(),this.texture.destruct(),we()(H()(n.prototype),"destruct",this).call(this)}}]),n}(xe);function Yi(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return Ki(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ki(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Ki(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function qi(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Zi=function(t){U()(n,t);var e=qi(n);function n(t,r,i){var a;return N()(this,n),(a=e.call(this)).renderer=t,a.frustum=new Ui,a.snow=new Hi(t,r),a.wind=new Wi(t,r),a.bubbles=new ji(t,r),Se.ENABLED&&(a.cube=new zi(t),a.boundingBoxMaterial=new kn(t,r,"lines"),a.boundingBoxMaterial.setDrawTypeLines(),a.boundingBoxMaterial.depthTest=!1),a}return F()(n,[{key:"init",value:function(t){this.snow.init(t),this.wind.init(t),this.bubbles.init(t),this.showTransforms=t.addParamBool("showTransforms",!1),this.showBounds=t.addParamBool("showBoundingBoxes",!1)}},{key:"update",value:function(t,e){this.snow.update(e.animationTime,t,e.unity),this.wind.update(e.animationTime,t,e.unity),this.bubbles.update(e.animationTime,t,e.unity)}},{key:"drawScene",value:function(t,e){e.isDestructed||this.draw(t,e)}},{key:"draw",value:function(t,e){this.renderer.clear(),this.frustum.updateForCamera(t),e.draw(t,this.frustum),this.snow.draw(t),this.wind.draw(t),this.bubbles.draw(t),Se.ENABLED&&(this.showBounds.value&&this.drawBounds(t,this.boundingBoxMaterial,e.unity.unityRenderer.meshRenderers),this.showTransforms.value&&this.drawTransforms(t,this.boundingBoxMaterial,e.unity.transforms))}},{key:"drawBounds",value:function(t,e,n){e.setMatrix("_ViewProjection",t.viewProjection);var r,i=Yi(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;e.setVector3("_Min",a.bbMin),e.setVector3("_Max",a.bbMax),this.renderer.draw(this.cube,e)}}catch(o){i.e(o)}finally{i.f()}}},{key:"drawTransforms",value:function(t,e,n){e.setMatrix("_ViewProjection",t.viewProjection);var r,i=.1,a=Yi(n);try{for(a.s();!(r=a.n()).done;){var o=r.value.worldPosition;e.setVector3("_Min",Oe.add(o,new Oe(-i,-i,-i))),e.setVector3("_Max",Oe.add(o,new Oe(i,i,i))),this.renderer.draw(this.cube,e)}}catch(s){a.e(s)}finally{a.f()}}},{key:"destruct",value:function(){var t,e;null===(t=this.boundingBoxMaterial)||void 0===t||t.destruct(),null===(e=this.cube)||void 0===e||e.destruct(),this.snow.destruct(),this.bubbles.destruct(),this.wind.destruct(),we()(H()(n.prototype),"destruct",this).call(this)}}]),n}(xe),Qi=function(){function t(){N()(this,t)}return F()(t,null,[{key:"sineNoise1",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.612,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,r=0,i=1,a=1,o=0;o<n;o++)r+=Math.sin(t*a)*i,a/=e,i*=e;return r}},{key:"sineNoise3",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.612,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,i=new Oe;return i.x=t.sineNoise1(e,n,r),i.y=t.sineNoise1(.98765*e+1e4,n,r),i.z=t.sineNoise1(1.23456*e+2e4,n,r),i}},{key:"sineNoise33",value:function(e){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.612,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6,i=new Oe,a=1,o=1,s=0;s<r;s++)i.x+=Math.sin(e.y*o)*a,i.y+=Math.sin(e.z*o)*a,i.z+=Math.sin(e.x*o)*a,e=Oe.transformMat3(e,t._rotationMatrix),o/=n,a*=n;return i}},{key:"getFloatNoiseVolumeData",value:function(e,n){var r=1/e,i=0,a=new Float32Array(e*e*e*4),o=new Oe;t.RandomizeSeeds();for(var s=0;s<e;s++){o.z=s*r*n;for(var l=0;l<e;l++){o.y=l*r*n;for(var u=0;u<e;u++){o.x=u*r*n;var c=t.noise3(o);a[i++]=c.x,a[i++]=c.y,a[i++]=c.z,a[i++]=0}}}return a}},{key:"getFloatNoiseVolumeDataAs2D",value:function(e,n,r,i){var a=1/r,o=0,s=new Float32Array(r*r*r*4),l=new Oe;t.RandomizeSeeds();for(var u,c=e/r,f=new Oe,h=1,d=[],v=0;v<8;v++)d.push((new Oe).randomize());for(var p=0;p<n;p++)for(var m=0;m<e;m++){l.x=m%r,l.y=p%r,l.z=Math.floor(p*a)*c+Math.floor(m*a),l.multiplyScalar(a*i),f.setValues(0,0,0),h=1;for(v=0;v<8;v++)l.add(d[v]),(u=t.noise3(l)).multiplyScalar(h),f.add(u),h*=.5678,l.multiplyScalar(1.8);s[o++]=f.x,s[o++]=f.y,s[o++]=f.z,s[o++]=0}return s}},{key:"getUintNoiseVolumeData",value:function(e,n){for(var r=t.getFloatNoiseVolumeData(e,n),i=r.length,a=new Uint8Array(i),o=0;o<i;o++){var s=255*(.5*r[o]+.5);a[o]=Math.floor(s)}return a}},{key:"getUintNoiseVolumeDataAs2D",value:function(e,n,r,i){for(var a=t.getFloatNoiseVolumeDataAs2D(e,n,r,i),o=a.length,s=new Uint8Array(o),l=0;l<o;l++){var u=255*(.5*a[l]+.5);s[l]=Math.floor(u)}return s}},{key:"RandomizeSeeds",value:function(){t._hashDotX.randomize01(),t._hashDotX.multiplyScalar(100),t._hashDotY.randomize01(),t._hashDotY.multiplyScalar(100),t._hashDotZ.randomize01(),t._hashDotZ.multiplyScalar(100),t._noiseSeedX=1e4*Math.random(),t._noiseSeedY=1e4*Math.random(),t._noiseSeedZ=1e4*Math.random()}},{key:"getUint8Data",value:function(){return null}},{key:"lerp1",value:function(t,e,n){return(1-n)*t+n*e}},{key:"smoothstep1",value:function(t){return t*t*(3-2*t)}},{key:"fract1",value:function(t){return t-Math.floor(t)}},{key:"hash",value:function(e){return t.fract1(Math.sin(Oe.dot(e,t._hashDot))*t._noiseSeed)}},{key:"noise1",value:function(e){var n=Oe.floor(e),r=Oe.fract(e);r.smoothstep();var i=t.lerp1(this.hash(n),this.hash(Oe.add(n,this.p100)),r.x),a=t.lerp1(this.hash(Oe.add(n,this.p010)),this.hash(Oe.add(n,this.p110)),r.x),o=t.lerp1(i,a,r.y),s=t.lerp1(this.hash(Oe.add(n,this.p001)),this.hash(Oe.add(n,this.p101)),r.x),l=t.lerp1(this.hash(Oe.add(n,this.p011)),this.hash(Oe.add(n,this.p111)),r.x),u=t.lerp1(s,l,r.y);return t.lerp1(o,u,r.z)-.5}},{key:"perlin1",value:function(e){var n=this._tempV35;n.copy(e);var r=.5*t.noise1(n);return(n=Oe.transformMat3(n,t.mat3)).multiplyScalar(2.01),r+=.25*t.noise1(n),(n=Oe.transformMat3(n,t.mat3)).multiplyScalar(2.02),r+=.125*t.noise1(n),(n=Oe.transformMat3(n,t.mat3)).multiplyScalar(2.03),r+=.0625*t.noise1(n),(n=Oe.transformMat3(n,t.mat3)).multiplyScalar(2.04),r}},{key:"perlin3D",value:function(t,e,n){for(var r=function(t){return t*t*t*(t*(6*t-15)+10)},i=function(t,e,n){return e+t*(n-e)},a=function(t,e,n,r){var i=15&t,a=i<8?e:n,o=i<4?n:12==i||14==i?e:r;return(0===(1&i)?a:-a)+(0===(2&i)?o:-o)},o=new Array(512),s=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],l=0;l<256;l++)o[256+l]=o[l]=s[l];var u=255&Math.floor(t),c=255&Math.floor(e),f=255&Math.floor(n);t-=Math.floor(t),e-=Math.floor(e),n-=Math.floor(n);var h=r(t),d=r(e),v=r(n),p=o[u]+c,m=o[p]+f,y=o[p+1]+f,g=o[u+1]+c,_=o[g]+f,E=o[g+1]+f;return(1+i(v,i(d,i(h,a(o[m],t,e,n),a(o[_],t-1,e,n)),i(h,a(o[y],t,e-1,n),a(o[E],t-1,e-1,n))),i(d,i(h,a(o[m+1],t,e,n-1),a(o[_+1],t-1,e,n-1)),i(h,a(o[y+1],t,e-1,n-1),a(o[E+1],t-1,e-1,n-1)))))/2}},{key:"noise3Ref",value:function(e,n){t._noiseSeed=t._noiseSeedX,t._hashDot.copy(t._hashDotX),n.x=t.noise1(e),t._noiseSeed=t._noiseSeedY,t._hashDot.copy(t._hashDotY),n.y=t.noise1(e),t._noiseSeed=t._noiseSeedZ,t._hashDot.copy(t._hashDotZ),n.z=t.noise1(e)}},{key:"noise3",value:function(t){var e=new Oe;return this.noise3Ref(t,e),e}},{key:"curlNoise3",value:function(e,n){var r=t._tempV34;r.copy(n),r.x+=.01;var i=this.perlin1(r);r.copy(n),r.x-=.01;var a=this.perlin1(r);r.copy(n),r.y+=.01;var o=this.perlin1(r);r.copy(n),r.y-=.01;var s=this.perlin1(r);r.copy(n),r.z+=.01;var l=this.perlin1(r);r.copy(n),r.z-=.01;var u=i-a,c=o-s,f=l-this.perlin1(r);return e.x=c-f,e.y=f-u,e.z=u-c,e.multiplyScalar(50),e}}]),t}();function Ji(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}Qi._tempV30=new Oe,Qi._tempV31=new Oe,Qi._tempV32=new Oe,Qi._tempV33=new Oe,Qi._tempV34=new Oe,Qi._tempV35=new Oe,Qi._hashDot=new Oe(12.9898,39.1215,78.233),Qi._hashDotX=new Oe(12.9898,39.1215,78.233),Qi._hashDotY=new Oe(36.8704,19.6392,83.123),Qi._hashDotZ=new Oe(58.927,17.456,38.347),Qi._noiseSeed=43758.5453,Qi._noiseSeedX=43758.5453,Qi._noiseSeedY=87345.5453,Qi._noiseSeedZ=19045.5453,Qi.p100=new Oe(1,0,0),Qi.p010=new Oe(0,1,0),Qi.p110=new Oe(1,1,0),Qi.p001=new Oe(0,0,1),Qi.p101=new Oe(1,0,1),Qi.p011=new Oe(0,1,1),Qi.p111=new Oe(1,1,1),Qi._tempV3=new Oe,Qi._rotationMatrix=lr.fromValues(0,.8,.6,-.8,.36,-.48,-.6,-.48,.64),Qi.mat3=lr.fromValues(0,.8,.6,-.8,.36,-.48,-.6,-.48,.64);var ta=function(t){U()(n,t);var e=Ji(n);function n(t){var r;return N()(this,n),(r=e.call(this,1,.2,1e3)).parallax=new vn,r.parallaxAmountX=.5,r.parallaxAmountY=.4,r.slowX=0,r.shakeAmp=0,r.renderer=t,r.mouseListener=t.mouseListener,r.view.transform.rotateY(Math.PI),r}return F()(n,[{key:"init",value:function(t){}},{key:"shake",value:function(){this.shakeAmp=.05}},{key:"update",value:function(t,e){var n=e;n.z-=1.5,n.y+=.5;var r=Qi.sineNoise3(100*Un.instance.time,.618,4);n.add(r.multiplyScalar(this.shakeAmp)),this.shakeAmp*=.8,this.view.transform.position=n,this.projection.aspectRatio=this.renderer.aspectRatio}}]),n}(hr);function ea(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var na=function(t){U()(n,t);var e=ea(n);function n(t){var r;N()(this,n),r=e.call(this,t);var i=new Float32Array([-1,-1,0,-1,1,0,1,1,0,1,-1,0]);r.setPositions(i);var a=new Float32Array([0,0,0,1,1,1,1,0]);r.setUV0(a);var o=new Uint16Array([0,2,1,2,0,3]);return r.setIndices(o),r}return n}(Bn);function ra(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return ia(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ia(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function ia(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function aa(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var oa=function t(e,n,r,i){N()(this,t),this.lane=0,this.transform=new cr,this.position=new Oe,this.scalar=0,this.hasHit=!1,this.genericGlow=!1,this.material=e.sharedMaterial,this.mesh=e.mesh,this.lane=i-1,n.x-=this.lane,this.transform.position=n,this.transform.scale=e.transform.scale,this.scale=e.transform.scale,this.position.copy(n),this.isObstacle=r,"Crystal01"==e.transform.name&&(this.genericGlow=!0),"Crystal02"==e.transform.name&&(this.genericGlow=!0),"Crystal03"==e.transform.name&&(this.genericGlow=!0),"Crystal04"==e.transform.name&&(this.genericGlow=!0),"gravel_3D_02"==e.transform.name&&(this.genericGlow=!0),"gravel_3D_03"==e.transform.name&&(this.genericGlow=!0),"gravel_3D_04"==e.transform.name&&(this.genericGlow=!0),"gravel_3D_10"==e.transform.name&&(this.genericGlow=!0),"gravel_3D_12"==e.transform.name&&(this.genericGlow=!0)},sa=function(t){U()(n,t);var e=aa(n);function n(t,r,i){var a;return N()(this,n),(a=e.call(this)).gameObjects=[],a.currentMaterials=[],a.transformTrack=null,a.glowColorObstacle=new un(1,0,0,.25),a.glowColorCollectable=new un(0,.5,1,.25),a.patterns=[[0,0,0],[1,0,0],[0,1,0],[0,0,1],[2,0,0],[0,2,0],[0,0,2],[0,1,2],[0,2,1],[1,2,0],[1,0,2],[2,0,1],[1,1,0],[0,1,1],[1,0,1],[2,2,0],[2,0,2],[0,2,2],[1,1,2],[1,2,1],[2,1,1],[2,2,1],[2,1,2],[1,2,2]],a.rows=[],a.renderer=t,a.eventDispatcher=i,a.glowMaterial=new kn(t,r,"glow"),a.glowMaterial.setPreMultipliedAlphaBlending(),a.glowMaterial.setCullingDisabled(),a.glowMesh=new na(t),a}return F()(n,[{key:"init",value:function(t){}},{key:"addObjects",value:function(t,e){this.transformTrack=t.unity.unityAnimator.getTransformTrackByName("Path"),this.gameObjects=[],this.rows=[];var n=Fe.lerp(10,100,e);this.transformTrack&&(this.rows=this.createGamePatterns(n),this.gameObjects=this.spawnItems(t.unity,this.transformTrack,t.duration,this.rows),this.sortItems(this.gameObjects)),this.currentMaterials=[];var r,i=ra(this.gameObjects);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.currentMaterials.indexOf(a.material)<0&&this.currentMaterials.push(a.material)}}catch(o){i.e(o)}finally{i.f()}}},{key:"createGamePatterns",value:function(t){for(var e=[],n=0;n<t;n++){var r=.1+n/t*.85,i=Math.floor(Math.random()*this.patterns.length*.9999),a=this.patterns[i];e.push({pattern:a,progress:r})}return e}},{key:"spawnItems",value:function(t,e,n,r){for(var i=[],a=this.getModelsOfParent("Obstacles",t),o=this.getModelsOfParent("Collectables",t),s=r.length,l=0;l<s;l++){var u=r[l],c=u.pattern;e.update(u.progress*n);for(var f=e.transform.worldPosition,h=0;h<3;h++)if(1==c[h]){var d=o[Math.floor(Math.random()*o.length*.9999)],v=this.adjustPosition(d,f.clone());i.push(new oa(d,v,!1,h))}else if(2==c[h]){var p=a[Math.floor(Math.random()*a.length*.9999)],m=this.adjustPosition(p,f.clone());i.push(new oa(p,m,!0,h))}}var y,g=ra(a);try{for(g.s();!(y=g.n()).done;){var _=y.value;t.unityRenderer.removeMeshRenderer(_)}}catch(R){g.e(R)}finally{g.f()}var E,T=ra(o);try{for(T.s();!(E=T.n()).done;){var A=E.value;t.unityRenderer.removeMeshRenderer(A)}}catch(R){T.e(R)}finally{T.f()}return i}},{key:"sortItems",value:function(t){t.sort((function(t,e){return e.position.z-t.position.z}))}},{key:"adjustPosition",value:function(t,e){return("Pigeon"==t.transform.name||"Wolves"==t.transform.name||"Deer"==t.transform.name||"Wolves"==t.transform.name||"Wolf"==t.transform.name||t.transform.name.indexOf("plant_tuft")>=0)&&(e.y=t.transform.position.y),e}},{key:"getModelsOfParent",value:function(t,e){var n=e.getTransformByName(t);if(n){var r,i=[],a=ra(n.getChildren());try{for(a.s();!(r=a.n()).done;){var o,s=r.value,l=ra(e.unityRenderer.getRenderersById(s.id));try{for(l.s();!(o=l.n()).done;){var u=o.value;i.push(u)}}catch(c){l.e(c)}finally{l.f()}}}catch(c){a.e(c)}finally{a.f()}return i}return console.warn("scene file should have a transform with the name: ",t,e),[]}},{key:"update",value:function(t,e,n){var r,i=e.worldPosition,a=ra(this.gameObjects);try{for(a.s();!(r=a.n()).done;){var o=r.value;i.z<o.position.z&&i.z>o.position.z-75?(Oe.distance(o.position,n)<.5&&(o.hasHit||(o.hasHit=!0,o.isObstacle?this.eventDispatcher.dispatchEvent(new Re(Re.OBSTACLE_HIT,{data:o.transform.name})):this.eventDispatcher.dispatchEvent(new Re(Re.COLLECTABLE_HIT,{data:o.transform.name})))),o.hasHit&&!o.isObstacle?(o.scalar*=Math.max(1-10*t,0),o.transform.scale=o.scale.clone().multiplyScalar(o.scalar)):(o.scalar=Fe.smoothStep(75,55,o.position.z-i.z),o.transform.scale=o.scale.clone().multiplyScalar(o.scalar))):o.scalar=0}}catch(s){a.e(s)}finally{a.f()}}},{key:"draw",value:function(t,e){var n,r=t.viewProjection,i=t.worldPosition,a=ra(this.currentMaterials);try{for(a.s();!(n=a.n()).done;){var o=n.value;o.fog&&o.setVector3("_CameraPosition",i),o.setMatrix("_ViewProjection",r),o.setFloat("_Opacity",e)}}catch(c){a.e(c)}finally{a.f()}this.glowMaterial.setMatrix("_ViewProjection",r);var s,l=ra(this.gameObjects);try{for(l.s();!(s=l.n()).done;){var u=s.value;u.scalar>.01&&(u.genericGlow&&(this.glowMaterial.setVector3("_Position",u.position),this.glowMaterial.setVector4("_Color",u.isObstacle?this.glowColorObstacle:this.glowColorCollectable),this.renderer.draw(this.glowMesh,this.glowMaterial)),u.material.setMatrix("_Model",u.transform.worldMatrix),this.renderer.draw(u.mesh,u.material))}}catch(c){l.e(c)}finally{l.f()}}},{key:"getRow",value:function(t){for(var e=0;e<this.rows.length;e++){var n=this.rows[e];if(n.progress>t)return n.pattern}return[2,2,2]}},{key:"destruct",value:function(){this.glowMesh.destruct(),this.glowMaterial.destruct(),we()(H()(n.prototype),"destruct",this).call(this)}}]),n}(xe),la=function(){function t(){N()(this,t)}return F()(t,null,[{key:"linear",value:function(t){return t}},{key:"smoothstep",value:function(t){return t*t*(3-2*t)}},{key:"smootherstep",value:function(t){return t*t*t*(t*(6*t-15)+10)}},{key:"invsmoothstep",value:function(t){return t+(t-t*t*(3-2*t))}},{key:"quadIn",value:function(t){return t*t}},{key:"quadOut",value:function(t){return t*(2-t)}},{key:"quadInOut",value:function(t){return t<=.5?t*t*2:1- --t*t*2}},{key:"quadOutIn",value:function(t){return t<.5?-.5*(t*=2)*(t-2):.5*(t=2*t-1)*t+.5}},{key:"powIn",value:function(t){return Math.pow(t,5)}},{key:"powOut",value:function(t){return 1-Math.pow(1-t,5)}},{key:"sineIn",value:function(t){return 1-Math.cos(.5*Math.PI*t)}},{key:"sineOut",value:function(t){return Math.sin(.5*Math.PI*t)}},{key:"sineInOut",value:function(t){return.5-Math.cos(Math.PI*t)/2}},{key:"sineOutIn",value:function(t){return 0==t?0:1==t?1:t<.5?.5*Math.sin(2*t*Math.PI*.5):-.5*Math.cos((2*t-1)*Math.PI*.5)+1}},{key:"circIn",value:function(t){return 1-Math.sqrt(1-t*t)}},{key:"circOut",value:function(t){return--t,Math.sqrt(1-t*t)}},{key:"circInOut",value:function(t){return t<=.5?(Math.sqrt(1-t*t*4)-1)/-2:(Math.sqrt(1-(2*t-2)*(2*t-2))+1)/2}},{key:"circOutIn",value:function(t){return t<.5?.5*Math.sqrt(1-(t=2*t-1)*t):-.5*(Math.sqrt(1-(t=2*t-1)*t)-1-1)}},{key:"cubeIn",value:function(t){return t*t*t}},{key:"cubeOut",value:function(t){return 1+--t*t*t}},{key:"cubeInOut",value:function(t){return t<=.5?t*t*t*4:1+--t*t*t*4}},{key:"cubeOutIn",value:function(t){return.5*((t=2*t-1)*t*t+1)}},{key:"quartIn",value:function(t){return t*t*t*t}},{key:"quartOut",value:function(t){return 1+--t*t*t*t}},{key:"quartInOut",value:function(t){return t<=.5?t*t*t*t*8:.5*(1-(t=2*t-2)*t*t*t)+.5}},{key:"quartOutIn",value:function(t){return t<.5?-.5*(t=2*t-1)*t*t*t+.5:.5*(t=2*t-1)*t*t*t+.5}},{key:"quintIn",value:function(t){return t*t*t*t*t}},{key:"quintOut",value:function(t){return(t-=1)*t*t*t*t+1}},{key:"quintInOut",value:function(t){return(t*=2)<1?t*t*t*t*t/2:((t-=2)*t*t*t*t+2)/2}},{key:"quintOutIn",value:function(t){return.5*((t=2*t-1)*t*t*t*t+1)}},{key:"expoIn",value:function(t){return Math.pow(2,10*(t-1))}},{key:"expoOut",value:function(t){return 1-Math.pow(2,-10*t)}},{key:"expoInOut",value:function(t){return t<.5?Math.pow(2,10*(2*t-1))/2:(2-Math.pow(2,-10*(2*t-1)))/2}},{key:"expoOutIn",value:function(t){return t<.5?.5*(1-Math.pow(2,-20*t)):.5==t?.5:.5*(Math.pow(2,20*(t-1))+1)}},{key:"backIn",value:function(t){return t*t*(5*t-4)}},{key:"backOut",value:function(t){return 1- --t*t*(-5*t-4)}},{key:"backInOut",value:function(t){return(t*=2)<1?t*t*(5*t-4)/2:(1-(t-=2)*t*(-5*t-4))/2+.5}},{key:"elasticIn",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.4;return-e*Math.pow(2,10*(t-=1))*Math.sin((t-n/(Math.PI/2)*Math.asin(1/e))*(2*Math.PI)/n)}},{key:"elasticOut",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.4;return e*Math.pow(2,-10*t)*Math.sin((t-n/(2*Math.PI)*Math.asin(1/e))*(2*Math.PI)/n)+1}},{key:"elasticInOut",value:function(t){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.4;return t<.5?Math.pow(2,10*(t-=.5))*Math.sin((t-e/4)*(2*Math.PI)/e)*-.5:Math.pow(2,-10*(t-=.5))*Math.sin((t-e/4)*(2*Math.PI)/e)*.5+1}}]),t}(),ua=function(){function t(e){N()(this,t),this._from=e,this.duration=0,this._progress=1,this.easing=la.smoothstep,this.animateCallback=void 0,this.completeCallback=void 0,this.from=e}return F()(t,[{key:"to",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:la.smoothstep;return void 0===this.from&&Se.error("Tween.to without setting from value"),this.from=this.currentValue,this.goal=this.clone(t),this.duration=e,this._progress=0,this.animateCallback=n,this.completeCallback=r,this.easing=i,this}},{key:"fromTo",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:la.smoothstep;return this.from=t,this.to(e,n,r,i,a)}},{key:"stop",value:function(){return this.cancel()}},{key:"cancel",value:function(){return this._progress=1,this.animateCallback=void 0,this.completeCallback=void 0,this}},{key:"update",value:function(t){this._progress<1&&(this._progress=this.duration<=0?1:Fe.clamp01(this._progress+t/this.duration),this.currentValue=this.lerp(this.from,this.goal,Fe.clamp01(this.easing(this._progress))),void 0!==this.animateCallback&&this.animateCallback(this.value),this._progress>=1&&this.completeCallback&&this.completeCallback())}},{key:"from",set:function(t){void 0!==t&&(void 0===this.clone&&(this.clone=function(t){return t.clone()},"number"===typeof t?(this.clone=function(t){return t},this.lerp=Fe.lerp):t instanceof vn?this.lerp=vn.lerp:t instanceof Oe?this.lerp=Oe.lerp:t instanceof un?this.lerp=un.lerp:t instanceof ur&&(this.lerp=ur.slerp)),this._from=this.clone(t),this.currentValue=this.clone(t))},get:function(){return this._from}},{key:"completed",get:function(){return this.progress>=1}},{key:"progress",get:function(){return this._progress}},{key:"value",get:function(){return this.currentValue}}]),t}();function ca(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return fa(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fa(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function fa(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ha(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var da=function(t){U()(n,t);var e=ha(n);function n(t,r,i){var a;N()(this,n),(a=e.call(this)).lane=0,a.floatLane=0,a.paused=!1,a.scene=null,a.path=null,a.score=0,a.transformTrack=null,a.bottleScale=.2,a.bottleScaleTween=new ua(1),a.demoPlay=!1,a.smoothLaneOld=0,a.waitForUp=!1,a.renderer=t,a.eventDispatcher=i,mr.getInstance().addKeyHitEvent(vr.KEY_A,(function(){return a.changeLane(-1)})),mr.getInstance().addKeyHitEvent(vr.KEY_D,(function(){return a.changeLane(1)})),mr.getInstance().addKeyHitEvent(vr.LEFT_ARROW,(function(){return a.changeLane(-1)})),mr.getInstance().addKeyHitEvent(vr.RIGHT_ARROW,(function(){return a.changeLane(1)})),Se.ENABLED&&mr.getInstance().addKeyHitEvent(vr.SPACE,(function(){return a.paused=!a.paused})),a.bottle=new Yr(t,i);var o=br.getStaticDir()+"webgl/Bottle.json";return Ei.load(t,r,o,a.bottle,"",{}),a.camera=new ta(a.renderer),a.gameObjectManager=new sa(t,r,i),a}return F()(n,[{key:"init",value:function(t){t.addGroup("game");this.bottle.handleLoaded(),this.bottleTransform=this.bottle.rootTransform,this.bottleTransform.scaleScalar=this.bottleScale;var e,n=ca(this.bottle.unityRenderer.materials);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.texture&&(r.texture.anisotropy=4)}}catch(i){n.e(i)}finally{n.f()}this.reset(),this.camera.init(t),this.gameObjectManager.init(t)}},{key:"reset",value:function(){this.score=0}},{key:"setScene",value:function(t,e,n){var r=this;this.demoPlay=n,t&&(this.path=t.unity.getTransformByName("Path"),this.eventDispatcher.addEventListener(Re.OBSTACLE_HIT,(function(t){r.adjustScore(-1),r.camera.shake()})),this.eventDispatcher.addEventListener(Re.COLLECTABLE_HIT,(function(t){r.adjustScore(1),r.bottleScaleTween.fromTo(0,1,.5)})),this.gameObjectManager.addObjects(t,e),this.transformTrack=t.unity.unityAnimator.getTransformTrackByName("Path")),this.scene=t,this.reset()}},{key:"adjustScore",value:function(t){this.score+=t}},{key:"detectSwipes",value:function(t){var e=this.renderer.mouseListener;e.getButton(0).downByTouch?this.waitForUp||(e.normalizedVelocity.x>t?(this.changeLane(1),this.waitForUp=!0):e.normalizedVelocity.x<-t&&(this.changeLane(-1),this.waitForUp=!0)):this.waitForUp=!1}},{key:"detectClicks",value:function(){var t=this.renderer.mouseListener;t.mouseDownThisFrame&&(t.normalizedPos.x<.5?this.changeLane(-1):this.changeLane(1))}},{key:"changeLane",value:function(t){this.lane+=t,this.lane=Fe.clamp(this.lane,-1,1),this.eventDispatcher.dispatchEvent(new Re(Re.LANE_CHANGE,{data:this.lane}))}},{key:"update",value:function(t){if(this.bottleScaleTween.update(t),this.scene){this.demoPlay?this.updateDemoPlay():at.a.mobile?this.detectSwipes(t):this.detectClicks();var e=this.bottleTransform.position,n=this.lane-this.floatLane,r=Math.min(3*t,Math.abs(n));this.floatLane+=n>0?r:-r;var i=this.floatLane<0?Fe.smoothStep(-1,0,this.floatLane)-1:Fe.smoothStep(0,1,this.floatLane);if(this.path&&this.transformTrack){var a=this.scene.animationTime;this.transformTrack.update(a);var o=this.path.worldPosition;e.copy(o),this.transformTrack.update(a+.1);var s=this.transformTrack.transform.worldPosition;this.transformTrack.update(a),this.bottleTransform.lookAt(e,s),this.bottleTransform.rotateY(Math.PI),this.bottleTransform.rotateZ(Math.PI),this.bottleTransform.rotateX(.2),e.x+=-i,this.bottleTransform.position=e}this.bottleTransform.rotateY(1.5*(i-this.smoothLaneOld)),this.smoothLaneOld=i,this.camera.update(t,e.clone()),this.gameObjectManager.update(t,this.camera,e)}}},{key:"updateDemoPlay",value:function(){if(this.scene){var t=this.gameObjectManager.getRow(this.scene.normalizedAnimationProgress);if(1!=t[this.lane+1]){for(var e=0;e<3;e++)if(1==t[e]){this.lane=e-1;break}if(0==t[this.lane+1])return;if(1!=t[this.lane+1])for(var n=0;n<3;n++)if(0==t[n]){this.lane=n-1;break}}}}},{key:"getScore",value:function(){return this.score}},{key:"draw",value:function(t,e){if(e>0){var n=this.bottleScaleTween.value,r=1+Fe.smoothStep(0,.33,n)*Fe.smoothStep(1,.33,Math.abs(n))*.2;this.bottleTransform.scaleScalar=this.bottleScale*Math.sqrt(e)*r;var i,a=ca(this.bottle.unityRenderer.materials);try{for(a.s();!(i=a.n()).done;){var o=i.value;o.bottle&&o.setVector3("_CameraPosition",t.worldPosition)}}catch(s){a.e(s)}finally{a.f()}this.bottle.drawOpaque(t),this.gameObjectManager.draw(t,e),this.bottle.drawTransparent(t)}}},{key:"destruct",value:function(){this.gameObjectManager.destruct(),this.bottle.destruct(),we()(H()(n.prototype),"destruct",this).call(this)}}]),n}(xe);function va(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var pa=function(t){U()(n,t);var e=va(n);function n(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return N()(this,n),(r=e.call(this,t)).createPlane(i,a,o,s,l),r}return F()(n,[{key:"createPlane",value:function(t,e,n,r,i){for(var a=(t+1)*(e+1),o=new Float32Array(3*a),s=new Float32Array(2*a),l=new Float32Array(3*a),u=0,c=0,f=0,h=0;h<e+1;h++)for(var d=0;d<t+1;d++)o[u++]=d/t*2-1,n?(o[u++]=0,o[u++]=h/e*2-1):(o[u++]=h/e*2-1,o[u++]=0),s[c++]=d/t,s[c++]=h/e,n?(l[f++]=0,l[f++]=1,l[f++]=0):(l[f++]=0,l[f++]=0,l[f++]=1);this.setPositions(o,r),this.setUV0(s,r),this.setNormals(l,r);var v=new Uint32Array(3*(t*e*2)),p=t+1;u=0;for(var m=0;m<e;m++)for(var y=0;y<t;y++)v[u++]=m*p+y,v[u++]=(m+1)*p+y,v[u++]=m*p+y+1,v[u++]=(m+1)*p+y,v[u++]=(m+1)*p+y+1,v[u++]=m*p+y+1;i?this.setIndices32(v):this.setIndices(Uint16Array.from(v))}}]),n}(Bn);function ma(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var ya=function(t){U()(n,t);var e=ma(n);function n(t,r){var i;return N()(this,n),(i=e.call(this)).position=new Oe(0,-.25,0),i.renderer=t,i.material=new kn(t,r,"lanes"),i.material.setAlphaBlending(),i.material.setCullingDisabled(),i.material.addShaderDefines(["TRACK_DEFORM",1]),i.mesh=new pa(i.renderer,2,4096),i}return F()(n,[{key:"init",value:function(t){var e=t.addGroup("Lanes",this.material);e.addShaderParamFloat("_Length",500),e.addShaderParamFloat("_Width",.05,0,.1),e.addShaderParamFloat("_Opacity",.5)}},{key:"setDeform",value:function(t){this.material.setVector2Array("_Deform",t.deformArray),this.material.setVector2("_MinMaxZ",t.minMaxZ)}},{key:"unsetDeform",value:function(){this.material.setVector2Array("_Deform",new Float32Array(128))}},{key:"draw",value:function(t,e){if(e>0){var n=this.material;n.setFloat("_Time",Un.instance.time),n.setFloat("_Visibility",e),n.setMatrix("_ViewProjection",t.viewProjection),n.setVector3("_CameraPos",t.worldPosition),n.setVector3("_CameraDir",t.view.transform.worldForward);for(var r=0;r<=3;r++)this.position.x=r-1.5,n.setVector3("_Position",this.position),this.renderer.draw(this.mesh,n)}}},{key:"destruct",value:function(){this.material.destruct(),this.mesh.destruct(),we()(H()(n.prototype),"destruct",this).call(this)}}]),n}(xe);function ga(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var _a=function(t){U()(n,t);var e=ga(n);function n(t,r){var i;return N()(this,n),(i=e.call(this))._pingPong=!0,i._timeStep=0,i._needsReset=!0,i._texelSize=new vn,i._blurred=!1,i._renderer=t,i._material=new kn(t,r,"boxBlur"),i._material.depthTest=!1,i._material.depthWrite=!1,i._buffer0=i.createBuffer(t),i._buffer1=i.createBuffer(t),i}return F()(n,[{key:"createBuffer",value:function(t){var e=new rr(t,1,1,qn.RGB_UNSIGNED_BYTE,!1,!0,!0);return e.scaleToCanvas=!0,e}},{key:"init",value:function(t){var e=this,n=t.addGroup("IncrementalBlur",this._material);n.addButton("reset",(function(){return e.reset()})),this._maxIterations=n.addParamInt("maxIterations",32),this._speed=n.addParamFloat("speed",.25)}},{key:"getOutput",value:function(){return this._pingPong?this._buffer0:this._buffer1}},{key:"getFeedback",value:function(){return this._pingPong?this._buffer1:this._buffer0}},{key:"reset",value:function(){this._needsReset=!0}},{key:"draw",value:function(t){this._pingPong=!this._pingPong,this._needsReset&&(this._renderer.blit(t,this.getFeedback()),this._needsReset=!1,this._timeStep=0);var e=this._maxIterations.value,n=this._timeStep/e;if((n=Fe.smoothStep01(n))<1){var r=n*e*this._speed.value;this._texelSize.setValues(r/t.width,r/t.height),this._material.setVector2("uSourceTexelSize",this._texelSize),this._material.setTexture("uSource",t),this._material.setFloat("uSharp",this._blurred?0:1-n),this._renderer.blit(this.getFeedback(),this.getOutput(),this._material,!0)}this._blurred?(this._timeStep++,this._timeStep>e&&(this._timeStep=e)):(this._timeStep--,this._timeStep<0&&(this._timeStep=0))}},{key:"setBlurred",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._blurred=t,e?this._timeStep=this._blurred?this._maxIterations.value:0:t&&this.reset()}},{key:"blurred",get:function(){return this._blurred}},{key:"done",get:function(){return this._blurred?this._timeStep==this._maxIterations.value:0==this._timeStep}}]),n}(xe);function Ea(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Ta,Aa=function(t){U()(n,t);var e=Ea(n);function n(t,r){var i;return N()(this,n),(i=e.call(this))._progress=0,i.duration=1.5,i.renderer=t,i.material=new kn(t,r,"whiteTransition"),i.material.setAlphaBlending(),i.material.depthTest=!1,i.mask=new Ar(t,r,br.getFileName("transitions/frostReveal"),!1,!0,!0,!0,qn.LUMINANCE_UNSIGNED_BYTE),i.progressTween=new ua(0),i}return F()(n,[{key:"init",value:function(t){this.material.setTexture("_Mask",this.mask),this.material.setFloat("_TextureAspectRatio",this.mask.aspectRatio)}},{key:"update",value:function(t){this.progressTween.update(t)}},{key:"draw",value:function(t){var e=Fe.smoothStep(this.duration,0,t.animationTime),n=Fe.smoothStep(this.duration,0,t.secondsRemaining),r=Math.max(this.progressTween.value,Math.max(e,n));this._progress=r,r>0&&(this.material.setFloat("_Progress",.75*r),this.material.setFloat("_AspectRatio",this.renderer.aspectRatio),this.renderer.blit(null,null,this.material))}},{key:"transitionToWhite",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};this.progressTween.to(1,this.duration,void 0,(function(){t.progressTween.to(0,0),e()}))}},{key:"destruct",value:function(){var t;null===(t=this.material)||void 0===t||t.destruct(),we()(H()(n.prototype),"destruct",this).call(this)}},{key:"progress",get:function(){return this._progress}}]),n}(xe);function Ra(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return ba(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ba(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function ba(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function wa(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}!function(t){t.NONE="none",t.TRACK_1="Track1",t.TRACK_2="Track2",t.TRACK_3="Track3"}(Ta||(Ta={}));var Sa=function(t){U()(r,t);var e=wa(r);function r(t,i,a,o){var s;N()(this,r),(s=e.call(this)).paused=!1,s.enabled=!0,s.isInit=!1,s.isUpdating=!1,s.bufferedLoad=null,s.canvasManager=new an(i);var l=!o;return s.renderer=new jn(a,s.canvasManager.canvas,n(776),l),s.renderer.clearColor=new fn(1,1,1,1),s.freeCamera=new Er(s.renderer,1,.2,1e4),s.freeCamera.setTranslateSpeed(2),s.freeCamera.position=new Oe(0,0,1),s.sceneManager=new Bi(s.renderer,a,t),s.sceneRenderer=new Zi(s.renderer,a,t),s.whiteTransition=new Aa(s.renderer,a),s.game=new da(s.renderer,a,t),s.laneRenderer=new ya(s.renderer,a),s.gameVisibility=new ua(1),s.rt=new rr(s.renderer,1,1,qn.RGBA_UNSIGNED_BYTE,!1,!0,!0,!0),s.rt.scaleToCanvas=!0,s.incrementalBlur=new _a(s.renderer,a),o&&(s.datGui=new nn(a)),s}return F()(r,[{key:"init",value:function(){var t,e=this;if(this.isInit)console.warn("webgl has already been init");else{var n=new je;n.init("controls"),Se.ENABLED&&(n.addButton("log scene state",(function(){console.log(e.sceneManager.scene)})),n.addParamFloat("_Cutoff",.6,0,1,(function(t){var n;null===(n=e.sceneManager.scene)||void 0===n||n.model.unityRenderer.setUniform("_Cutoff",t)})),n.addParamFloat("_Softness",1.5,0,4,(function(t){var n;null===(n=e.sceneManager.scene)||void 0===n||n.model.unityRenderer.setUniform("_EdgeSoftness",t)})),n.addParamBool("_ShowPixelDensity",!1,(function(t){var n;null===(n=e.sceneManager.scene)||void 0===n||n.model.unityRenderer.setUniform("_ShowPixelDensity",t?1:0)})),n.addParamBool("_ShowOverdraw",!1,(function(t){var n;null===(n=e.sceneManager.scene)||void 0===n||n.model.unityRenderer.setUniform("_ShowOverdraw",t?1:0)}))),this.useFreeCamera=n.addParamBool("freeCamera",!1),this.sceneRenderer.init(n),this.whiteTransition.init(n),this.game.init(n),this.laneRenderer.init(n),this.incrementalBlur.init(n),this.renderer.init();var r,i=Ra(n.children);try{for(i.s();!(r=i.n()).done;){r.value.collapsed=!0}}catch(a){i.e(a)}finally{i.f()}null===(t=this.datGui)||void 0===t||t.init(n),this.update(),this.isInit=!0}}},{key:"update",value:function(){var t=this;if(!this.isDestructed){this.isUpdating=!0;var e=Un.instance.deltaTime;if(this.canvasManager.update(e),this.gameVisibility.update(e),this.renderer.clear(),1==this.enabled){this.freeCamera.update();var n=this.useFreeCamera.value?this.freeCamera:this.game.camera,r=this.sceneManager.scene;r&&r.isInit&&(this.whiteTransition.update(e),this.incrementalBlur.blurred?(this.incrementalBlur.draw(this.rt),this.renderer.blit(this.incrementalBlur.getOutput())):(this.game.update(e),r.setCameraPosition(n.worldPosition),r.update(e),this.sceneRenderer.update(e,r),this.draw(r,n)),this.whiteTransition.draw(r))}if(Se.ENABLED&&(Se.logToScreen("vertexCount: "+Math.round(.001*Wn.vertexCount)+"k, drawCalls: "+Wn.drawCalls),Wn.vertexCount=0,Wn.drawCalls=0),window.requestAnimationFrame((function(){return t.update()})),this.isUpdating=!1,this.bufferedLoad){var i=this.bufferedLoad;this.loadScene(i.type,i.difficulty,i.onProgress,i.onComplete,i.isDemo),this.bufferedLoad=null}}}},{key:"draw",value:function(t,e){this.sceneRenderer.drawScene(e,t),this.game.draw(e,this.gameVisibility.value),(t instanceof Oi||t instanceof Pi)&&this.laneRenderer.setDeform(t.trackDeform),this.laneRenderer.draw(e,this.gameVisibility.value)}},{key:"loadScene",value:function(t,e,n,r,i){var a,o=this;if(this.sceneManager.scene&&!(null===(a=this.sceneManager.scene)||void 0===a?void 0:a.isInit))return console.warn("loadScene while scene is still loading : aborting",t,e,i),void r();if(this.isUpdating)this.bufferedLoad={type:t,difficulty:e,onProgress:n,onComplete:r,isDemo:i};else{var s=new sn;this.sceneManager.loadScene(t,s),s.load((function(){o.sceneManager.handleSceneLoaded(),o.game.setScene(o.sceneManager.scene,e,i),o.laneRenderer.unsetDeform(),r()}),n)}}},{key:"getScore",value:function(){return this.game.getScore()}},{key:"clear",value:function(){this.renderer.clearWithColor(0,0,0,0)}},{key:"setGameItemsVisible",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;this.gameVisibility.to(t?1:0,e,void 0,n)}},{key:"transitionToWhite",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};this.whiteTransition.transitionToWhite(t)}},{key:"setBlurred",value:function(t){t&&(this.renderer.renderTarget=this.rt,this.renderer.clear(),this.sceneManager.scene&&this.draw(this.sceneManager.scene,this.game.camera),this.renderer.renderTarget=null),this.incrementalBlur.setBlurred(t)}},{key:"destruct",value:function(){this.sceneManager.destruct(),this.sceneRenderer.destruct(),this.whiteTransition.destruct(),this.laneRenderer.destruct(),this.game.destruct(),this.canvasManager.destruct(),this.renderer.destruct(),we()(H()(r.prototype),"destruct",this).call(this)}},{key:"scenePaused",set:function(t){var e=this.sceneManager.scene;e&&e.isInit&&(e.paused=t)}},{key:"sceneHardPaused",set:function(t){var e=this.sceneManager.scene;e&&e.isInit&&(e.hardPaused=t)}},{key:"secondRemaining",get:function(){var t=this.sceneManager.scene;return t&&t.isInit?t.secondsRemaining:0}},{key:"animationTime",get:function(){var t=this.sceneManager.scene;return t&&t.isInit?t.animationTime:0}},{key:"normalizedAnimationProgress",set:function(t){var e=this.sceneManager.scene;e&&e.isInit&&(e.normalizedAnimationProgress=t)},get:function(){var t=this.sceneManager.scene;return t&&t.isInit?t.normalizedAnimationProgress:0}},{key:"canvas",get:function(){return this.canvasManager.canvas}},{key:"whiteTransitionProgress",get:function(){return this.whiteTransition.progress}}]),r}(xe);function xa(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var ka=function(t){U()(n,t);var e=xa(n);function n(){var t;return N()(this,n),(t=e.apply(this,arguments)).pausedGameTimeline=D.default.timeline(),t}return F()(n,[{key:"pauseGame",value:function(t){this.pausedGameTimeline.kill(),this.pausedGameTimeline=D.default.timeline().to(this.parentController.$el,{filter:"blur(".concat(t?"3":"0","px)"),duration:.3})}},{key:"setupTransitionInTimeline",value:function(t,e,n){var r=e.$refs,i=r.endRunButton,a=r.scoreBoardOverlay;t.fromTo(e.$el,{autoAlpha:0},{autoAlpha:1,duration:.5}),t.add(this.getTimeline(i.$el),">-0.3"),t.add(this.getTimeline(a.$el),"<0.05")}},{key:"setupTransitionOutTimeline",value:function(t,e,n){t.to(e.$el,{autoAlpha:0,duration:.5,ease:j.VinnieInOut})}},{key:"setupLoopingAnimationTimeline",value:function(t,e,n){}}]),n}(P.AbstractTransitionController);function Ma(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Ca=function(t){U()(n,t);var e=Ma(n);function n(){return N()(this,n),e.apply(this,arguments)}return F()(n,[{key:"setupTransitionInTimeline",value:function(t,e,n){var r=e.$refs,i=r.button,a=r.label;t.fromTo(i,{autoAlpha:0,scale:0},{autoAlpha:1,scale:1,duration:.5,ease:"elastic.out(2, 1)",clearProps:"all"}).fromTo(a,{autoAlpha:0,scale:0},{autoAlpha:1,scale:1,duration:.5,ease:j.VinnieInOut,clearProps:"all"},"<0.05")}},{key:"setupTransitionOutTimeline",value:function(t,e,n){}},{key:"setupLoopingAnimationTimeline",value:function(t,e,n){}}]),n}(P.AbstractTransitionController),Ia={name:"EndRunButton",extends:Mt,props:{ariaLabel:s.default.string},methods:{handleAllComponentsReady:function(){this.transitionController=new Ca(this),this.isReady()}}},Pa=n(265);var Da=Object(h.a)(Ia,(function(){var t,e=this,n=e.$createElement,r=e._self._c||n;return r("div",{class:e.$style.endRunButtonWrapper},[r("button",{ref:"button",class:[e.$style.endRunButton,"button",(t={},t["is-disabled"]=e.disabled,t)],attrs:{title:e.title||e.label||"","aria-label":e.ariaLabel||e.title||"",type:e.type===e.ButtonType.SUBMIT?"submit":"button"},on:{click:e.handleClick}},[r("div",{class:[e.$style.background]}),e._v(" "),r("div",{class:[e.$style.centerPoint]})]),e._v(" "),r("div",{ref:"label",class:["copy-05",e.$style.label],domProps:{innerHTML:e._s(e.label)}})])}),[],!1,(function(t){this.$style=Pa.default.locals||Pa.default}),null,null).exports;function Oa(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Na=function(t){U()(n,t);var e=Oa(n);function n(){return N()(this,n),e.apply(this,arguments)}return F()(n,[{key:"setupTransitionInTimeline",value:function(t,e,n){t.fromTo(e.$el,{autoAlpha:0,scale:0},{autoAlpha:1,scale:1,ease:"elastic.out(2, 1)"})}},{key:"setupTransitionOutTimeline",value:function(t,e,n){t.to(e.$el,{autoAlpha:0,scale:0,ease:j.VinnieInOut})}},{key:"setupLoopingAnimationTimeline",value:function(t,e,n){}}]),n}(P.AbstractTransitionController),La={name:"MessageOverlay",extends:P.AbstractTransitionComponent,props:{message:s.default.string},methods:{handleAllComponentsReady:function(){this.transitionController=new Na(this),this.isReady()}}},Fa=n(266);var Ba=Object(h.a)(La,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{class:[this.$style.messageOverlay]},[e("span",{class:["copy-05",this.$style.message],domProps:{innerHTML:this._s(this.message)}})])}),[],!1,(function(t){this.$style=Fa.default.locals||Fa.default}),null,null).exports;function Ua(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Va=function(t){U()(n,t);var e=Ua(n);function n(){var t;return N()(this,n),(t=e.apply(this,arguments)).fontColorTimeline=D.default.timeline(),t.scoreToBeatTimeline=D.default.timeline(),t}return F()(n,[{key:"transitionFontColor",value:function(t){var e=this.parentController.$refs.score;this.fontColorTimeline.kill(),this.fontColorTimeline=D.default.timeline().to(e,{color:t?"#d46375":"#505157"})}},{key:"transitionScoreToBeat",value:function(t){var e=this.parentController.$refs,n=e.scoreToBeat,r=e.message;t&&(D.default.set(n,{scale:0}),this.parentController.$props.hasMessage||D.default.set(r,{width:0})),this.scoreToBeatTimeline.kill(),this.scoreToBeatTimeline=D.default.timeline().to(n,{autoAlpha:t?1:0,scale:t?1:0,duration:t?1:.5,ease:t?"elastic.out(2, 1)":j.VinnieInOut})}},{key:"setupTransitionInTimeline",value:function(t,e,n){t.fromTo(e.$el,{autoAlpha:0,scale:0},{autoAlpha:1,scale:1,duration:.5,ease:j.VinnieInOut,clearProps:"all"})}},{key:"setupTransitionOutTimeline",value:function(t,e,n){}},{key:"setupLoopingAnimationTimeline",value:function(t,e,n){}}]),n}(P.AbstractTransitionController),za={name:"ScoreboardOverlay",extends:P.AbstractTransitionComponent,props:{score:s.default.number.isRequired,hasMessage:s.default.any,scoreToBeat:s.default.number,label:s.default.string.isRequired,isNewBestScore:s.default.bool.isRequired},watch:{scoreToBeat:function(t){this.transitionScoreToBeat(t)},isNewBestScore:function(t){t?this.transitionController.transitionFontColor(!0):this.transitionController.transitionFontColor(!1)}},methods:{handleAllComponentsReady:function(){var t=this;this.transitionController=new Va(this),this.transitionController.addEventListener(P.TransitionEvent.types.TRANSITION_IN_START,(function(){setTimeout((function(){t.transitionScoreToBeat(t.scoreToBeat)}),1e3*t.transitionController.transitionInTimeline.duration()*.3)})),this.isNewBestScore&&this.transitionController.transitionFontColor(!0),this.isReady()},transitionScoreToBeat:function(t){var e=this;return M()(x.a.mark((function n(){return x.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t?(e.transitionController.transitionScoreToBeat(!0),setTimeout(M()(x.a.mark((function t(){return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.scoreToBeat&&D.default.to(e.$refs.message,{width:0,duration:.5,ease:j.VinnieInOut});case 1:case"end":return t.stop()}}),t)}))),1e4)):e.$refs.scoreToBeat&&e.transitionController.transitionScoreToBeat(!1);case 1:case"end":return n.stop()}}),n)})))()}}},Ga=n(267);var Ha=Object(h.a)(za,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:[t.$style.scoreboardOverlay]},[n("span",{ref:"label",class:["heading-06-new",t.$style.label],domProps:{innerHTML:t._s(t.label)}}),t._v(" "),t.scoreToBeat?n("div",{ref:"scoreToBeat",class:t.$style.scoreToBeatWrapper},[n("div",{ref:"message",class:t.$style.messageWrapper},[n("span",{class:["copy-05",t.$style.message],domProps:{innerHTML:t._s(t.$t("gameScreen.messageOne"))}})]),t._v(" "),n("span",{class:["copy-01-new",t.$style.scoreToBeat],domProps:{innerHTML:t._s(t.scoreToBeat)}})]):t._e(),t._v(" "),n("span",{ref:"score",class:["heading-03-new",t.$style.score],domProps:{innerHTML:t._s(t.score)}})])}),[],!1,(function(t){this.$style=Ga.default.locals||Ga.default}),null,null).exports;function $a(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Wa=function(t){U()(n,t);var e=$a(n);function n(){return N()(this,n),e.apply(this,arguments)}return F()(n,[{key:"setupTransitionInTimeline",value:function(t,e,n){t.fromTo(e.$el,{y:20,autoAlpha:0},{y:0,autoAlpha:1,ease:j.VinnieInOut,duration:.3})}},{key:"setupTransitionOutTimeline",value:function(t,e,n){t.to(e.$el,{autoAlpha:0,ease:j.VinnieInOut,duration:.3})}},{key:"setupLoopingAnimationTimeline",value:function(t,e,n){}}]),n}(P.AbstractTransitionController),Xa={name:"ScoreAlert",extends:P.AbstractTransitionComponent,props:{scoredPoints:s.default.any},data:function(){return{updateCounter:0}},watch:{scoredPoints:function(t){var e=this;return M()(x.a.mark((function n(){var r;return x.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null!==t){n.next=2;break}return n.abrupt("return");case 2:if(e.transitionController.isHidden){n.next=5;break}return n.next=5,e.transitionOut();case 5:e.$el.innerHTML="+".concat(t),e.transitionController.setupTimeline(P.TimelineType.IN,!0),e.transitionIn(),e.updateCounter+=1,r=e.updateCounter,e.transitionOutRef=setTimeout((function(){r===e.updateCounter&&e.transitionController.transitionOut()}),500);case 11:case"end":return n.stop()}}),n)})))()}},methods:{handleAllComponentsReady:function(){this.transitionController=new Wa(this),this.isReady()}}},ja=n(268);var Ya={name:"GameScreen",components:{EndRunButton:Da,MessageOverlay:Ba,ScoreboardOverlay:Ha,ScoreAlert:Object(h.a)(Xa,(function(){var t=this.$createElement;return(this._self._c||t)("div",{class:["copy-01",this.$style.scoreAlert]})}),[],!1,(function(t){this.$style=ja.default.locals||ja.default}),null,null).exports},extends:P.AbstractTransitionComponent,props:{score:s.default.number.isRequired,scoreToBeat:s.default.number,isFirstLevel:s.default.bool.isRequired,scoredPoints:s.default.any,isGamePaused:s.default.bool.isRequired},data:function(){return{hasNewBestScoreReached:!1,isNewBestScore:!1,message:null}},watch:{score:function(t){var e=this;return M()(x.a.mark((function n(){return x.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.hasNewBestScoreReached&&e.isNewBestScore&&(e.isNewBestScore=!1),e.scoreToBeat&&!e.hasNewBestScoreReached&&t>e.scoreToBeat&&(e.hasNewBestScoreReached=!0,e.isNewBestScore=!0,e.message=e.$t("gameScreen.messageTwo"));case 2:case"end":return n.stop()}}),n)})))()},isGamePaused:function(t){this.transitionController.pauseGame(t)}},created:function(){this.hasNewBestScoreReached=this.score>this.scoreToBeat},methods:{handleAllComponentsReady:function(){this.transitionController=new ka(this),this.isReady()},transitionMessageIn:function(){var t=this;return M()(x.a.mark((function e(){var n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$refs.messageOverlay.transitionController.transitionIn();case 2:n=t.message,setTimeout(M()(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.$refs.messageOverlay||n!==t.message){e.next=4;break}return e.next=3,t.$refs.messageOverlay.transitionController.transitionOut();case 3:t.message=null;case 4:case"end":return e.stop()}}),e)}))),1e4);case 4:case"end":return e.stop()}}),e)})))()},onMessageIsReady:function(){var t=this;return M()(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.transitionMessageIn();case 1:case"end":return e.stop()}}),e)})))()}}},Ka=n(269);var qa=Object(h.a)(Ya,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:["grid-row",t.$style.gameScreen]},[n("div",{class:t.$style.overlayGradient}),t._v(" "),n("div",{class:t.$style.overlayRadialGradient}),t._v(" "),n("div",{class:["grid-col-8 grid-col-md-12",t.$style.overlaysWrapper]},[n("EndRunButton",{ref:"endRunButton",class:t.$style.endRunCta,attrs:{type:t.ButtonType.ACTION,label:t.$t("gameScreen.endRunCta.label"),"aria-label":t.$t("gameScreen.endRunCta.ariaLabel")},on:{click:function(e){return t.$emit("onEndRun")}}}),t._v(" "),n("div",{class:t.$style.messageOverlayWrapper},[t.message?n("MessageOverlay",{ref:"messageOverlay",attrs:{message:t.message},on:{isReady:t.onMessageIsReady}}):t._e()],1),t._v(" "),n("ScoreboardOverlay",{ref:"scoreBoardOverlay",class:t.$style.scoreboardOverlay,attrs:{score:t.score,"has-message":t.scoreToBeat&&!t.hasNewBestScoreReached&&t.isFirstLevel,"score-to-beat":t.scoreToBeat&&!t.hasNewBestScoreReached?t.scoreToBeat:void 0,"is-new-best-score":t.isNewBestScore,label:t.$t("gameScreen.scoreboard.label")}})],1),t._v(" "),n("ScoreAlert",{class:t.$style.scoreAlert,attrs:{"scored-points":t.scoredPoints}})],1)}),[],!1,(function(t){this.$style=Ka.default.locals||Ka.default}),null,null).exports;function Za(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Qa=function(t){U()(n,t);var e=Za(n);function n(){return N()(this,n),e.apply(this,arguments)}return F()(n,[{key:"setupTransitionInTimeline",value:function(t,e,n){var r=e.$refs,i=r.evianLogo,a=r.title,o=r.scoreTitle,s=r.score,l=r.copy,u=r.ctaOne,c=r.ctaTwo,f=r.shareCta,h=r.playAgainCta,d=[];i&&d.push(i.$el),a&&d.push(a),o&&d.push(o),s&&d.push(s),l&&d.push(l),u&&d.push(u.$el),c&&d.push(c.$el),t.fromTo(e.$el,{scale:0,autoAlpha:0},{scale:1,autoAlpha:1,duration:.5,ease:j.VinnieInOut}).fromTo(d,{scale:0,autoAlpha:0},{scale:1,autoAlpha:1,duration:.5,ease:j.VinnieInOut},.05),f&&t.fromTo([f.$el,h.$el],{scale:0,autoAlpha:0},{scale:1,autoAlpha:1,duration:.5,ease:j.VinnieInOut},">-0.3")}},{key:"setupTransitionOutTimeline",value:function(t,e,n){t.to(e.$el,{autoAlpha:0,duration:.5,ease:j.VinnieInOut})}},{key:"setupLoopingAnimationTimeline",value:function(t,e,n){}}]),n}(P.AbstractTransitionController),Ja=n(188);function to(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}D.default.registerPlugin(Ja.a);var eo=function(t){U()(n,t);var e=to(n);function n(){return N()(this,n),e.apply(this,arguments)}return F()(n,[{key:"onHover",value:function(){var t=M()(x.a.mark((function t(){var e,n;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.parentController.$refs.icon,n=e.$el.querySelectorAll("path")[1],!this.hoverTimeline){t.next=6;break}return t.next=5,this.hoverTimeline;case 5:this.hoverTimeline.kill();case 6:this.hoverTimeline=D.default.timeline().set(e.$el,{rotate:0}).set(n,{clearProps:"all"}).fromTo(n,{drawSVG:"0% 100%"},{drawSVG:"100% 100%",duration:.2,ease:j.VinnieInOut}).to(e.$el,{rotate:-360,duration:.3,ease:j.VinnieInOut,clearProps:"all"}).to(n,{drawSVG:"0% 100%",duration:.3,ease:j.VinnieInOut},"<");case 7:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"setupTransitionInTimeline",value:function(t,e,n){}},{key:"setupTransitionOutTimeline",value:function(t,e,n){}},{key:"setupLoopingAnimationTimeline",value:function(t,e,n){}}]),n}(P.AbstractTransitionController),no={name:"PlayAgainButton",extends:Mt,props:{ariaLabel:s.default.string.isRequired},methods:{handleAllComponentsReady:function(){this.transitionController=new eo(this),this.isReady()},onHover:function(){this.transitionController.onHover()}}},ro=n(270);var io=Object(h.a)(no,(function(){var t,e=this,n=e.$createElement,r=e._self._c||n;return r("button",{ref:"button",class:[e.$style.playAgainButton,"button",(t={},t["is-disabled"]=e.disabled,t)],attrs:{title:e.title||e.label||"","aria-label":e.ariaLabel||e.title||"",type:e.type===e.ButtonType.SUBMIT?"submit":"button"},on:{mouseenter:e.onHover,click:e.handleClick}},[r("Icon",{ref:"icon",class:e.$style.icon,attrs:{name:"round-arrow"}}),e._v(" "),r("span",{class:["copy-04-new",e.$style.label],domProps:{innerHTML:e._s(e.label)}})],1)}),[],!1,(function(t){this.$style=ro.default.locals||ro.default}),null,null).exports,ao=n(8);function oo(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var so=function(t){U()(n,t);var e=oo(n);function n(){return N()(this,n),e.apply(this,arguments)}return F()(n,[{key:"setupTransitionInTimeline",value:function(t,e,n){}},{key:"setupTransitionOutTimeline",value:function(t,e,n){}},{key:"setupLoopingAnimationTimeline",value:function(t,e,n){}}]),n}(P.AbstractTransitionController),lo={name:"CopyToClipboardButton",extends:Mt,props:{codeToCopy:s.default.string.isRequired,ariaLabel:s.default.string.isRequired,confirmationLabel:s.default.string.isRequired,confirmationAriaLabel:s.default.string.isRequired},methods:{handleAllComponentsReady:function(){this.transitionController=new so(this),this.isReady()},onClick:function(){var t=this;return M()(x.a.mark((function e(){var n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=document.createElement("textarea")).value=t.codeToCopy,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n),e.next=8,D.default.timeline().fromTo(t.$refs.primaryLabelWrapper,{autoAlpha:1},{autoAlpha:0,duration:.3,ease:ao.l.easeOut}).fromTo(t.$refs.confirmationLabel,{autoAlpha:0},{autoAlpha:1,duration:.3,ease:ao.l.easeOut},">0.2");case 8:D.default.timeline().to(t.$refs.confirmationLabel,{autoAlpha:0,duration:.3,delay:1,ease:ao.l.easeOut}).to(t.$refs.primaryLabelWrapper,{autoAlpha:1,duration:.3,ease:ao.l.easeOut},"<-0.2");case 9:case"end":return e.stop()}}),e)})))()}}},uo=n(271);var co,fo=Object(h.a)(lo,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("button",{ref:"button",class:[t.$style.copyToClipboardButton,"button"],attrs:{title:t.title||t.label||"","aria-label":t.ariaLabel||t.title||""},on:{click:t.onClick}},[n("div",{ref:"background",class:[t.$style.background]}),t._v(" "),n("div",{ref:"primaryLabelWrapper",class:t.$style.primaryLabelWrapper},[n("span",{class:t.$style.spacer}),t._v(" "),n("span",{class:["copy-05",t.$style.label],domProps:{innerHTML:t._s(t.label)}}),t._v(" "),n("span",{class:t.$style.spacer},[n("Icon",{class:t.$style.icon,attrs:{name:"link"}})],1)]),t._v(" "),n("div",{ref:"confirmationLabel",class:["copy-05",t.$style.confirmationLabel],domProps:{innerHTML:t._s(t.confirmationLabel)}})])}),[],!1,(function(t){this.$style=uo.default.locals||uo.default}),null,null).exports;!function(t){t.FACEBOOK="facebook",t.TWITTER="twitter"}(co||(co={}));var ho=co,vo={name:"ResultsScreen",components:{ResponsiveImage:dt,PrimaryButton:Nt,PlayAgainButton:io,CopyToClipboardButton:fo,StartScreenLogo:mt},extends:P.AbstractTransitionComponent,props:{score:s.default.number.isRequired},computed:{isExternal:function(){return"en-gb"===this.$store.getters.currentLanguage.code},shareUrl:function(){var t=window.location,e=t.origin,n=t.pathname;return"".concat(e).concat(n)}},methods:{handleAllComponentsReady:function(){this.transitionController=new Qa(this),this.isReady()},onShareButtonClick:function(){var t=this;return M()(x.a.mark((function e(){var n,r,i,a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.$tracker.push(t.Event.SHARE,t.EventCategory.SHARE),n=ho.FACEBOOK,r=t.score>999?1e3:t.score,i="function"===typeof navigator.share?"".concat(t.shareUrl,"share/score").concat(r).replace("index.html",""):encodeURIComponent("".concat(t.shareUrl,"share/score").concat(r).replace("index.html","")),a={url:i},"function"!==typeof navigator.share){e.next=15;break}return e.prev=6,e.next=9,navigator.share(a);case 9:return e.abrupt("return");case 12:e.prev=12,e.t0=e.catch(6),console.error(e.t0);case 15:e.t1=n,e.next=e.t1===ho.TWITTER?18:e.t1===ho.FACEBOOK?20:18;break;case 18:return t.openShare("https://twitter.com/intent/tweet?url=".concat(i)),e.abrupt("break",22);case 20:return t.openShare("https://www.facebook.com/sharer/sharer.php?u=".concat(i)),e.abrupt("break",22);case 22:case"end":return e.stop()}}),e,null,[[6,12]])})))()},openShare:function(t){window.open(t,"shared","status=no,resizable=no,width=640,height=480,toolbar=no,menubar=no,scrollbars=no,location=no,directories=no")}}},po=n(272);var mo=Object(h.a)(vo,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:["grid-row",t.$style.resultsScreen]},[n("StartScreenLogo",{ref:"evianLogo",class:[t.$style.logo]}),t._v(" "),n("div",{class:["grid-col-8 grid-col-md-12",t.$style.spacer]}),t._v(" "),n("div",{class:["grid-col-6 grid-col-md-12",t.$style.resultBoardContainer]},[n("div",{class:t.$style.resultBoardWrapper},[n("div",{class:t.$style.resultBoard},[n("div",{class:t.$style.background},[n("ResponsiveImage",{attrs:{"is-contained":!0,source:t.$staticRoot+"image/results/scoreboard-background-02.png"}})],1),t._v(" "),n("div",{class:t.$style.backgroundCover},[n("ResponsiveImage",{attrs:{"is-contained":!0,source:t.$staticRoot+"image/results/bottle.png"}})],1),t._v(" "),n("div",{class:t.$style.content},[n("h1",{ref:"title",class:["heading-02-new",t.$style.title],domProps:{innerHTML:t._s(t.$t("resultsScreen.title"))}}),t._v(" "),n("h2",{ref:"scoreTitle",class:["copy-05",t.$style.scoreTitle],domProps:{innerHTML:t._s(t.$t("resultsScreen.scoreTitle"))}}),t._v(" "),n("span",{ref:"score",class:["heading-01-new"],domProps:{innerHTML:t._s(t.score)}}),t._v(" "),"resultsScreen.copy"!==t.$t("resultsScreen.copy")?n("span",{ref:"copy",class:["copy-05",t.$style.copy],domProps:{innerHTML:t._s(t.$t("resultsScreen.copy"))}}):t._e(),t._v(" "),"resultsScreen.ctaOne.label"!==t.$t("resultsScreen.ctaOne.label")?n("CopyToClipboardButton",{ref:"ctaOne",class:t.$style.ctaOne,attrs:{type:t.ButtonType.ACTION,label:t.$t("resultsScreen.ctaOne.label"),"aria-label":t.$t("resultsScreen.ctaOne.ariaLabel"),"confirmation-label":t.$t("resultsScreen.ctaOne.confirmationLabel"),"confirmation-aria-label":t.$t("resultsScreen.ctaOne.confirmationAriaLabel"),"code-to-copy":t.$t("resultsScreen.ctaOne.codeToCopy")}}):t._e(),t._v(" "),"resultsScreen.ctaTwo.label"!==t.$t("resultsScreen.ctaTwo.label")?n("PrimaryButton",{ref:"ctaTwo",class:t.$style.ctaTwo,attrs:{type:t.ButtonType.LINK,link:{type:t.isExternal?t.LinkType.EXTERNAL_BLANK:t.LinkType.INTERNAL,target:t.isExternal?t.$t("resultsScreen.ctaTwo.url"):{name:t.RouteNames.CONTEST}},label:t.$t("resultsScreen.ctaTwo.label"),"aria-label":t.$t("resultsScreen.ctaTwo.ariaLabel")}}):t._e()],1)]),t._v(" "),n("PrimaryButton",{ref:"shareCta",class:t.$style.shareCta,attrs:{type:t.ButtonType.ACTION,theme:t.Theme.SECONDARY,label:t.$t("resultsScreen.shareCta.label"),"aria-label":t.$t("resultsScreen.shareCta.ariaLabel")},on:{click:t.onShareButtonClick}})],1)]),t._v(" "),n("div",{class:["grid-col-6 grid-col-md-12",t.$style.ctaWrapper]},[n("PlayAgainButton",{ref:"playAgainCta",class:t.$style.playAgainCta,attrs:{type:t.ButtonType.ACTION,label:t.$t("resultsScreen.playAgainCta.label"),"aria-label":t.$t("resultsScreen.playAgainCta.ariaLabel")},on:{click:function(e){return t.$emit("onPlayAgain")}}})],1)],1)}),[],!1,(function(t){this.$style=po.default.locals||po.default}),null,null).exports;function yo(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}D.default.registerPlugin(Ja.a);var go,_o=function(t){U()(n,t);var e=yo(n);function n(){return N()(this,n),e.apply(this,arguments)}return F()(n,[{key:"counterTransition",value:function(){var t=this,e=this.parentController.$refs.countNumber,n=this.parentController.$refs.circle.$el.querySelector("circle"),r=this.parentController.count,i=D.default.timeline().fromTo([n,e],{scale:0,autoAlpha:0},{scale:1,autoAlpha:.6,duration:.3}).fromTo(n,{drawSVG:"-25 -25"},{duration:r,drawSVG:"-25 76",ease:"none",onUpdate:function(){t.parentController.count=r-Math.floor(i.progress()/(1/r))}},"<");return i}},{key:"setupTransitionInTimeline",value:function(t,e,n){var r=e.$refs,i=r.title,a=r.subTitle,o=r.copy,s=[];i&&s.push(i),a&&s.push(a),o&&s.push(o),t.fromTo(e.$el,{scale:0,autoAlpha:0},{scale:1,autoAlpha:1,duration:.5,ease:j.VinnieInOut}).fromTo(s,{scale:0,autoAlpha:0},{scale:1,autoAlpha:1,duration:.5,ease:j.VinnieInOut},.05)}},{key:"setupTransitionOutTimeline",value:function(t,e,n){t.to(e.$el,{autoAlpha:0,duration:.5,ease:j.VinnieInOut})}},{key:"setupLoopingAnimationTimeline",value:function(t,e,n){}}]),n}(P.AbstractTransitionController);!function(t){t.FIRST="first",t.SECOND="second",t.THIRD="third",t.FOURTH="fourth"}(go||(go={}));var Eo=go,To={name:"MilestoneScreen",components:{ResponsiveImage:dt},extends:P.AbstractTransitionComponent,props:{indexString:s.default.oneOf(Object.values(Eo)).isRequired},data:function(){return{count:7}},methods:{handleAllComponentsReady:function(){var t=this;this.transitionController=new _o(this),this.transitionController.addEventListener(P.TransitionEvent.types.TRANSITION_IN_COMPLETE,M()(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.transitionController.counterTransition();case 2:t.$emit("onCounterEnded");case 3:case"end":return e.stop()}}),e)})))),this.isReady()}}},Ao=n(273);var Ro=Object(h.a)(To,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:["grid-row",t.$style.milestoneScreen]},[n("div",{class:["grid-col-6 grid-col-md-12",t.$style.milestoneBoardContainer]},[n("div",{class:t.$style.spacer}),t._v(" "),n("div",{class:[t.$style.milestoneBoard,t.indexString===t.Milestone.FOURTH&&t.$style.hasNoImage]},[t.indexString!==t.Milestone.FOURTH?n("div",{class:t.$style.backgroundWrapper},[n("ResponsiveImage",{attrs:{"is-contained":!0,source:t.$staticRoot+"image/milestone/"+t.indexString+".png"}})],1):t._e(),t._v(" "),n("div",{class:t.$style.content},[n("div",{class:[t.$style.counterWrapper]},[n("Icon",{ref:"circle",class:t.$style.icon,attrs:{name:"counter-circle"}}),t._v(" "),n("span",{ref:"countNumber",class:["copy-03",t.$style.countNumber],domProps:{innerHTML:t._s(t.count)}})],1),t._v(" "),n("h1",{ref:"title",class:["heading-07-new",t.$style.title],domProps:{innerHTML:t._s(t.$t("milestoneScreen."+t.indexString+".title"))}}),t._v(" "),t.$t("milestoneScreen."+t.indexString+".subTitle")!=="milestoneScreen."+t.indexString+".subTitle"?n("span",{ref:"subTitle",class:["copy-05-new",t.$style.subTitle],domProps:{innerHTML:t._s(t.$t("milestoneScreen."+t.indexString+".subTitle"))}}):t._e(),t._v(" "),n("span",{ref:"copy",class:["copy-03-new",t.$style.copy,t.$t("milestoneScreen."+t.indexString+".subTitle")==="milestoneScreen."+t.indexString+".subTitle"&&t.$style.hasExtraTopMargin],domProps:{innerHTML:t._s(t.$t("milestoneScreen."+t.indexString+".copy"))}})])]),t._v(" "),n("div",{class:t.$style.spacer})])])}),[],!1,(function(t){this.$style=Ao.default.locals||Ao.default}),null,null).exports;function bo(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var wo=function(t){U()(n,t);var e=bo(n);function n(){return N()(this,n),e.apply(this,arguments)}return F()(n,[{key:"setupTransitionInTimeline",value:function(t,e,n){var r=e.$refs,i=r.evianLogo,a=r.title,o=r.subTitle,s=r.introCta,l=r.soundCta,u=[];i&&u.push(i.$el),a&&u.push(a.$el),o&&u.push(o),s&&u.push(s.$el),l&&u.push(l.$el),t.fromTo(e.$el,{autoAlpha:0},{autoAlpha:1,duration:.5}),t.fromTo(u,{scale:0,autoAlpha:0},{scale:1,autoAlpha:1,duration:.5,stagger:.05,ease:j.VinnieInOut},">-0.3")}},{key:"setupTransitionOutTimeline",value:function(t,e,n){t.to(e.$el,{autoAlpha:0,duration:.5,ease:j.VinnieInOut})}},{key:"setupLoopingAnimationTimeline",value:function(t,e,n){}}]),n}(P.AbstractTransitionController);function So(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var xo=function(t){U()(n,t);var e=So(n);function n(){return N()(this,n),e.apply(this,arguments)}return F()(n,[{key:"waveAnimation",value:function(){var t=this.parentController.$refs,e=t.firstWave,n=t.secondWave;D.default.timeline({repeat:-1}).to([e,n],{autoAlpha:1,duration:.4,stagger:.2}).to([e,n],{autoAlpha:0,duration:.4,stagger:.2},1.2)}},{key:"setupTransitionInTimeline",value:function(t,e,n){}},{key:"setupTransitionOutTimeline",value:function(t,e,n){}},{key:"setupLoopingAnimationTimeline",value:function(t,e,n){}}]),n}(P.AbstractTransitionController),ko={name:"SoundCta",extends:P.AbstractTransitionComponent,methods:{handleAllComponentsReady:function(){this.transitionController=new xo(this),this.isReady()}}},Mo=n(274);var Co={name:"IntroScreen",components:{StartScreenLogo:mt,StartScreenTitle:At,PrimaryButton:Nt,SoundCta:Object(h.a)(ko,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:[t.$style.soundCta]},[n("div",{class:t.$style.iconWrapper},[n("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 22 16.14"}},[n("path",{staticStyle:{fill:"none",stroke:"#505157","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2px"},attrs:{d:"M10,1.07l-5,4H1v6H5l5,4Z"}}),t._v(" "),n("path",{ref:"secondWave",staticStyle:{visibility:"hidden",fill:"none",stroke:"#505157","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2px"},attrs:{d:"M18.07,1a10,10,0,0,1,0,14.14"}}),t._v(" "),n("path",{ref:"firstWave",staticStyle:{visibility:"hidden",fill:"none",stroke:"#505157","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2px"},attrs:{d:"M14.54,4.53a5,5,0,0,1,0,7.07"}})])]),t._v(" "),n("div",{class:["copy-02",t.$style.label],attrs:{"aria-label":t.$t("introScreen.soundCta.ariaLabel")},domProps:{innerHTML:t._s(t.$t("introScreen.soundCta.label"))}})])}),[],!1,(function(t){this.$style=Mo.default.locals||Mo.default}),null,null).exports},extends:P.AbstractTransitionComponent,mounted:function(){this.$tracker.push(this.Event.PAGE_VIEW,this.EventCategory.PAGE_VIEW)},methods:{handleAllComponentsReady:function(){var t=this;this.transitionController=new wo(this),this.isReady(),this.transitionController.addEventListener(P.TransitionEvent.types.TRANSITION_IN_COMPLETE,(function(){t.$refs.soundCta.transitionController.waveAnimation()}))},onIntroCtaClick:function(){this.$emit("onIntroButtonClick")}}},Io=n(275);var Po={name:"HomePage",components:{StartScreen:zt,OnboardingScreen:Ee,GameScreen:qa,MilestoneScreen:Ro,ResultsScreen:mo,IntroScreen:Object(h.a)(Co,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:["grid-row",t.$style.introScreen]},[n("StartScreenLogo",{ref:"evianLogo",class:["grid-col-8 grid-col-md-12",t.$style.logo]}),t._v(" "),n("StartScreenTitle",{ref:"title",class:["grid-col-8 grid-col-md-12",t.$style.title]}),t._v(" "),n("div",{ref:"subTitle",class:["grid-col-8 grid-col-md-12 copy-01",t.$style.subTitle]},[n("span",{domProps:{innerHTML:t._s(t.$t("startScreen.subTitle"))}})]),t._v(" "),n("div",{class:["grid-col-8 grid-col-md-12",t.$style.ctaWrapper]},[n("PrimaryButton",{ref:"introCta",class:t.$style.cta,attrs:{type:t.ButtonType.ACTION,label:t.$t("introScreen.cta.label"),"aria-label":t.$t("introScreen.cta.ariaLabel")},on:{click:t.onIntroCtaClick}})],1),t._v(" "),n("div",{class:["grid-col-8 grid-col-md-12",t.$style.soundCtaWrapper]},[n("SoundCta",{ref:"soundCta",class:t.$style.soundCta})],1)],1)}),[],!1,(function(t){this.$style=Io.default.locals||Io.default}),null,null).exports},extends:P.AbstractPageTransitionComponent,data:function(){var t,e;return{SceneId:Ta,isIntroScreenVisible:!0,isStartScreenVisible:!1,isOnboardingScreenVisible:!1,isGameScreenVisible:!1,isResultsScreenVisible:!1,isMilestoneScreenVisible:!1,isStartScreenTransitionStarted:!1,isGameScreenTransitionStarted:!1,isResultsScreenTransitionStarted:!1,isMilestoneScreenTransitionStarted:!1,milestoneIndexString:null,whiteTransitionProgress:0,currentDifficulty:.1,difficultyStep:.1,isAutoPlaying:!0,currentScore:0,scoreToBeat:void 0,sceneId:Ta.TRACK_3,hasScoreMilestoneReached:!1,scoredPoints:null,isGamePaused:!1,hasKeyPPressed:!1,hasKeySpacePressed:!1,hasFreezeTransitionSoundStarted:!1,isGamePlayStarting:!1,isGamePlayEnding:!1,isPlayedAgain:!1,ambient:(t={},I()(t,Ta.TRACK_1,Lt.AMBIENT_SECOND_LEVEL),I()(t,Ta.TRACK_2,Lt.AMBIENT_THIRD_LEVEL),I()(t,Ta.TRACK_3,Lt.AMBIENT_FIRST_LEVEL),t),music:(e={},I()(e,Ta.TRACK_1,Lt.MUSIC_SECOND_LEVEL),I()(e,Ta.TRACK_2,Lt.MUSIC_THIRD_LEVEL),I()(e,Ta.TRACK_3,Lt.MUSIC_FIRST_LEVEL),e)}},watch:{whiteTransitionProgress:function(t){var e=this;return M()(x.a.mark((function n(){return x.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(e.isStartScreenVisible&&!e.isStartScreenTransitionStarted&&t<=.5)){n.next=5;break}e.isStartScreenTransitionStarted=!0,e.$refs.startScreen.transitionController.transitionIn(),n.next=17;break;case 5:if(!(e.isGameScreenVisible&&!e.isGameScreenTransitionStarted&&t<=.05)){n.next=11;break}e.isGameScreenTransitionStarted=!0,e.$refs.gameScreen.transitionController.transitionIn(),e.isPlayedAgain||e.$tracker.push(e.Event.START_GAME,e.EventCategory.START_GAME),n.next=17;break;case 11:if(!(e.isGameScreenVisible&&e.isGameScreenTransitionStarted&&t>=.2)){n.next=17;break}return e.isGameScreenTransitionStarted=!1,n.next=15,e.$refs.gameScreen.transitionController.transitionOut();case 15:e.isGameScreenVisible=!1,e.currentDifficulty===e.difficultyStep?e.isMilestoneScreenVisible=!0:e.currentScore>=1e3&&!e.hasScoreMilestoneReached&&(e.hasScoreMilestoneReached=!0,e.isMilestoneScreenVisible=!0);case 17:case"end":return n.stop()}}),n)})))()},sceneId:function(t){if(this.isMilestoneScreenVisible)if(this.currentDifficulty===this.difficultyStep)switch(t){case Ta.TRACK_1:this.milestoneIndexString=this.Milestone.FIRST;break;case Ta.TRACK_2:this.milestoneIndexString=this.Milestone.SECOND;break;case Ta.TRACK_3:this.milestoneIndexString=this.Milestone.THIRD}else this.milestoneIndexString=this.Milestone.FOURTH}},created:function(){this.$route.query.score&&(this.scoreToBeat=+this.$route.query.score)},mounted:function(){this.addEventListeners(),D.default.ticker.add(this.tick)},beforeDestroy:function(){this.removeEventListeners()},methods:{handleAllComponentsReady:function(){this.transitionController=new W(this),this.isReady()},onIntroScreenReady:function(){this.$refs.introScreen.transitionController.transitionIn()},addEventListeners:function(){this.$webgl.addEventListener(Re.ANIMATION_END,this.onLevelEnd),this.$webgl.addEventListener(Re.OBSTACLE_HIT,this.onEndRun),this.$webgl.addEventListener(Re.COLLECTABLE_HIT,this.onCollectableHit),this.$webgl.addEventListener(Re.LANE_CHANGE,this.onLaneChange),window.addEventListener("keydown",this.keyboardKeyDownListener,!0),window.addEventListener("keyup",this.keyboardKeyUpListener,!0),document.addEventListener("visibilitychange",this.handleVisibilityChange,!1)},removeEventListeners:function(){this.$webgl.removeEventListener(Re.ANIMATION_END,this.onLevelEnd),this.$webgl.removeEventListener(Re.OBSTACLE_HIT,this.onEndRun),this.$webgl.removeEventListener(Re.COLLECTABLE_HIT,this.onCollectableHit),this.$webgl.removeEventListener(Re.LANE_CHANGE,this.onLaneChange),window.removeEventListener("keydown",this.keyboardKeyDownListener,!0),window.removeEventListener("keyup",this.keyboardKeyUpListener,!0),document.removeEventListener("visibilitychange",this.handleVisibilityChange,!1),D.default.ticker.remove(this.tick)},keyboardKeyDownListener:function(t){"KeyP"!==t.code||this.hasKeyPPressed?"Space"!==t.code||this.hasKeySpacePressed||(this.hasKeySpacePressed=!0,this.onPauseGame()):(this.hasKeyPPressed=!0,this.onPauseGame())},keyboardKeyUpListener:function(t){"KeyP"===t.code?this.hasKeyPPressed=!1:"Space"===t.code&&(this.hasKeySpacePressed=!1)},handleVisibilityChange:function(){document.hidden&&this.$sound?this.$sound.muteAllChannels(!0):!document.hidden&&this.$sound&&this.$sound.muteAllChannels(!1)},onLaneChange:function(){this.isGameScreenTransitionStarted&&!this.isGamePaused&&this.$sound.play(D.default.utils.random([Lt.SFX_SWITCHING_LINES_01,Lt.SFX_SWITCHING_LINES_02,Lt.SFX_SWITCHING_LINES_03]),Bt.SFX,1,1e-4)},onPauseGame:function(){this.isGameScreenTransitionStarted&&(this.isGamePaused=!this.isGamePaused,this.$webgl.setBlurred(this.isGamePaused))},onCollectableHit:function(){var t=this;return M()(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isAutoPlaying){e.next=2;break}return e.abrupt("return");case 2:return t.$sound.play(D.default.utils.random([Lt.SFX_BLUE_ITEM_01,Lt.SFX_BLUE_ITEM_02,Lt.SFX_BLUE_ITEM_03]),Bt.SFX,1,1e-4),t.scoredPoints=Math.floor(20*t.currentDifficulty),t.currentScore+=t.scoredPoints,e.next=7,t.$nextTick();case 7:t.scoredPoints=null;case 8:case"end":return e.stop()}}),e)})))()},moveToNewLevel:function(){switch(this.isAutoPlaying||(this.isGameScreenVisible=!0),this.sceneId){case Ta.TRACK_1:this.$webgl.loadAndPlayScene(Ta.TRACK_2,this.isAutoPlaying?.4:this.currentDifficulty,(function(){}),(function(){}),this.isAutoPlaying);break;case Ta.TRACK_2:this.$webgl.loadAndPlayScene(Ta.TRACK_3,this.isAutoPlaying?.4:this.currentDifficulty,(function(){}),(function(){}),this.isAutoPlaying);break;case Ta.TRACK_3:1===this.currentDifficulty||this.isAutoPlaying||(this.currentDifficulty+=this.difficultyStep),this.$webgl.loadAndPlayScene(Ta.TRACK_1,this.isAutoPlaying?.4:this.currentDifficulty,(function(){}),(function(){}),this.isAutoPlaying)}},intro:function(){var t=this;return M()(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$refs.introScreen.transitionController.transitionOut();case 2:t.isIntroScreenVisible=!1,t.isStartScreenVisible=!0,t.$webgl.loadAndPlayScene(Ta.TRACK_1,.4,(function(){}),(function(){}),!0);case 5:case"end":return e.stop()}}),e)})))()},start:function(){var t=this;return M()(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.$sound.play(Lt.AMBIENT_INTRO,Bt.AMBIENT,1,1e-4,!0),t.$webgl.setGameItemsVisible(!1,.5,(function(){t.$webgl.setBlurred(!0)})),e.next=4,t.$refs.startScreen.transitionController.transitionOut();case 4:t.isStartScreenVisible=!1,t.isOnboardingScreenVisible=!0;case 6:case"end":return e.stop()}}),e)})))()},startGame:function(){var t=this;return M()(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.$webgl.transitionToWhite((function(){t.$webgl.setBlurred(!1),t.$webgl.setGameItemsVisible(!0,.5),t.$webgl.loadAndPlayScene(Ta.TRACK_1,t.currentDifficulty,(function(){}),(function(){}))})),e.next=3,t.$refs.onboardingScreen.transitionController.transitionOut();case 3:t.isOnboardingScreenVisible=!1,t.isAutoPlaying=!1,t.currentScore=0,t.isGameScreenVisible=!0;case 7:case"end":return e.stop()}}),e)})))()},onEndRun:function(){var t=this;return M()(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.$webgl.setBlurred(!0),!t.isAutoPlaying){e.next=3;break}return e.abrupt("return");case 3:if(t.$sound.play(Lt.SFX_RED_ITEM,Bt.SFX,1,1e-4),!t.$refs.gameScreen){e.next=7;break}return e.next=7,t.$refs.gameScreen.transitionController.transitionOut();case 7:t.isGameScreenVisible=!1,t.isGameScreenTransitionStarted=!1,t.isResultsScreenVisible=!0;case 10:case"end":return e.stop()}}),e)})))()},onLevelEnd:function(t){var e=t.data.data;this.sceneId=e,this.isMilestoneScreenVisible||this.moveToNewLevel()},onPlayAgain:function(){var t=this;return M()(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.$tracker.push(t.Event.PLAY_AGAIN,t.EventCategory.PLAY_AGAIN),t.$webgl.transitionToWhite((function(){t.$webgl.setBlurred(!1),t.$webgl.loadAndPlayScene(Ta.TRACK_1,t.currentDifficulty,(function(){}),(function(){}))})),e.next=4,t.$refs.resultsScreen.transitionController.transitionOut();case 4:t.isResultsScreenVisible=!1,t.currentDifficulty=t.difficultyStep,t.scoreToBeat=void 0!==t.scoreToBeat?Math.max(t.currentScore,t.scoreToBeat):t.currentScore,t.currentScore=0,t.isGameScreenVisible=!0,t.isGameScreenTransitionStarted=!1,t.milestoneIndexString=null,t.hasScoreMilestoneReached=!1,t.isMilestoneScreenVisible=!1,t.sceneId=Ta.TRACK_3,t.isPlayedAgain||(t.isPlayedAgain=!0);case 15:case"end":return e.stop()}}),e)})))()},onStartScreenReady:function(){this.$refs.startScreen.transitionController.transitionIn()},onOnboardingScreenReady:function(){this.$refs.onboardingScreen.transitionController.transitionIn()},onResultsScreenReady:function(){this.$refs.resultsScreen.transitionController.transitionIn(),this.$tracker.push(this.Event.END_GAME,this.EventCategory.END_GAME,{score:this.currentScore})},onMilestoneCounterEnded:function(){var t=this;return M()(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$refs.milestoneScreen.transitionController.transitionOut();case 2:t.moveToNewLevel(),t.isMilestoneScreenVisible=!1,t.milestoneIndexString=null;case 5:case"end":return e.stop()}}),e)})))()},onMilestoneScreenReady:function(){this.$refs.milestoneScreen.transitionController.transitionIn()},tick:function(){var t=this.$webgl.getWhiteTransitionProgress();t!==this.whiteTransitionProgress?(this.isAutoPlaying||this.hasFreezeTransitionSoundStarted?this.isAutoPlaying&&(!this.isGamePlayStarting&&t<this.whiteTransitionProgress&&(this.isGamePlayStarting=!0,this.$sound.play(this.ambient[this.sceneId],Bt.AMBIENT,1,3,!0)),!this.isGamePlayEnding&&t>this.whiteTransitionProgress&&(this.isGamePlayEnding=!0,this.$sound.stopAllOnChannel(Bt.AMBIENT,2))):(this.hasFreezeTransitionSoundStarted=!0,t<this.whiteTransitionProgress?(this.$sound.play(Lt.SFX_TRANSITION_UNFREEZE,Bt.SFX,1,1e-4),this.$sound.play(this.music[this.sceneId],Bt.MUSIC,1,3,!0),this.$sound.play(this.ambient[this.sceneId],Bt.AMBIENT,1,3,!0)):(this.$sound.play(Lt.SFX_TRANSITION_FREEZE,Bt.SFX,1,1e-4),this.$sound.stopAllOnChannel(Bt.MUSIC,2),this.$sound.stopAllOnChannel(Bt.AMBIENT,2))),this.whiteTransitionProgress=t):t===this.whiteTransitionProgress&&(this.hasFreezeTransitionSoundStarted&&(this.hasFreezeTransitionSoundStarted=!1),this.isGamePlayStarting&&(this.isGamePlayStarting=!1),this.isGamePlayEnding&&(this.isGamePlayEnding=!1))}}},Do=n(276);var Oo=Object(h.a)(Po,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:[t.$style.homePage]},[t.isIntroScreenVisible?n("IntroScreen",{ref:"introScreen",staticClass:"abs-fill",on:{onIntroButtonClick:t.intro,isReady:t.onIntroScreenReady}}):t._e(),t._v(" "),t.isStartScreenVisible?n("StartScreen",{ref:"startScreen",staticClass:"abs-fill",on:{onStartButtonClick:t.start}}):t._e(),t._v(" "),t.isOnboardingScreenVisible?n("OnboardingScreen",{ref:"onboardingScreen",staticClass:"abs-fill",on:{onStartButtonClick:t.startGame,isReady:t.onOnboardingScreenReady}}):t._e(),t._v(" "),t.isGameScreenVisible?n("GameScreen",{ref:"gameScreen",attrs:{score:t.currentScore,"score-to-beat":t.scoreToBeat,"is-first-level":t.sceneId===t.SceneId.TRACK_3&&t.currentDifficulty===t.difficultyStep,"scored-points":t.scoredPoints,"is-game-paused":t.isGamePaused},on:{onEndRun:t.onEndRun}}):t._e(),t._v(" "),t.isResultsScreenVisible?n("ResultsScreen",{ref:"resultsScreen",staticClass:"abs-fill",attrs:{score:t.currentScore},on:{onPlayAgain:t.onPlayAgain,isReady:t.onResultsScreenReady}}):t._e(),t._v(" "),t.milestoneIndexString?n("MilestoneScreen",{ref:"milestoneScreen",staticClass:"abs-fill",attrs:{"index-string":t.milestoneIndexString},on:{onCounterEnded:t.onMilestoneCounterEnded,isReady:t.onMilestoneScreenReady}}):t._e()],1)}),[],!1,(function(t){this.$style=Do.default.locals||Do.default}),null,null).exports;function No(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Lo=function(t){U()(n,t);var e=No(n);function n(){return N()(this,n),e.apply(this,arguments)}return F()(n,[{key:"setupTransitionInTimeline",value:function(t,e,n){}},{key:"setupTransitionOutTimeline",value:function(t,e,n){}},{key:"setupLoopingAnimationTimeline",value:function(t,e,n){}}]),n}(P.AbstractTransitionController),Fo={name:"WebglPage",extends:P.AbstractPageTransitionComponent,methods:{handleAllComponentsReady:function(){this.transitionController=new Lo(this),this.isReady()}}},Bo=n(277);var Uo=Object(h.a)(Fo,(function(){var t=this.$createElement;return(this._self._c||t)("div",{class:[this.$style.webglPage]})}),[],!1,(function(t){this.$style=Bo.default.locals||Bo.default}),null,null).exports;function Vo(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var zo=function(t){U()(n,t);var e=Vo(n);function n(){return N()(this,n),e.apply(this,arguments)}return F()(n,[{key:"setupTransitionInTimeline",value:function(t,e,n){t.add((function(){}),.01)}},{key:"setupTransitionOutTimeline",value:function(t,e,n){}},{key:"setupLoopingAnimationTimeline",value:function(t,e,n){}}]),n}(P.AbstractTransitionController);function Go(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Ho=function(t){U()(n,t);var e=Go(n);function n(){return N()(this,n),e.apply(this,arguments)}return F()(n,[{key:"setupTransitionInTimeline",value:function(t,e,n){}},{key:"setupTransitionOutTimeline",value:function(t,e,n){}},{key:"setupLoopingAnimationTimeline",value:function(t,e,n){}}]),n}(P.AbstractTransitionController);function $o(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Wo=function(t){U()(n,t);var e=$o(n);function n(){return N()(this,n),e.apply(this,arguments)}return F()(n,[{key:"setupTransitionInTimeline",value:function(t,e,n){}},{key:"setupTransitionOutTimeline",value:function(t,e,n){}},{key:"setupLoopingAnimationTimeline",value:function(t,e,n){}}]),n}(P.AbstractTransitionController),Xo={name:"BackButton",extends:Mt,props:{ariaLabel:s.default.string},methods:{handleAllComponentsReady:function(){this.transitionController=new Wo(this),this.isReady()}}},jo=n(278);var Yo={name:"MainIntro",components:{StartScreenLogo:mt,BackButton:Object(h.a)(Xo,(function(){var t,e=this,n=e.$createElement,r=e._self._c||n;return e.type===e.ButtonType.LINK?r("a",{ref:"button",class:[e.$style.backButton,"button",e.$style[e.theme],(t={},t["is-disabled"]=e.disabled,t)],attrs:{href:e.target,disabled:"",title:e.title||e.label||"","aria-label":e.ariaLabel||e.title||""},on:{click:e.handleClick}},[r("Icon",{ref:"icon",class:e.$style.icon,attrs:{name:"arrow-left"}}),e._v(" "),r("span",{class:["copy-04-new",e.$style.label],domProps:{innerHTML:e._s(e.label)}})],1):e._e()}),[],!1,(function(t){this.$style=jo.default.locals||jo.default}),null,null).exports,ResponsiveImage:dt},extends:P.AbstractTransitionComponent,methods:{handleAllComponentsReady:function(){this.transitionController=new Ho(this),this.isReady()}}},Ko=n(279);var qo=Object(h.a)(Yo,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:[t.$style.mainIntro]},[n("div",{class:"grid-row"},[n("div",{class:["grid-col-8 grid-col-md-12",t.$style.navigation]},["contest.ctaBack.label"!==t.$t("contest.ctaBack.label")?n("BackButton",{ref:"ctaBack",class:t.$style.ctaBack,attrs:{type:t.ButtonType.LINK,link:{type:t.LinkType.EXTERNAL,target:t.$t("contest.ctaBack.url")},label:t.$t("contest.ctaBack.label"),"aria-label":t.$t("contest.ctaBack.ariaLabel")}}):t._e(),t._v(" "),n("StartScreenLogo",{ref:"evianLogo",class:[t.$style.logo]})],1)])])}),[],!1,(function(t){this.$style=Ko.default.locals||Ko.default}),null,null).exports,Zo=n(118),Qo=n(100);function Jo(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}D.default.registerPlugin(Qo.a);var ts=function(t){U()(n,t);var e=Jo(n);function n(){return N()(this,n),e.apply(this,arguments)}return F()(n,[{key:"setupTransitionInTimeline",value:function(t,e,n){t.fromTo(e.$el,{autoAlpha:0,y:20},{autoAlpha:1,y:0,ease:ao.a.easeInOut,duration:1})}},{key:"setupTransitionOutTimeline",value:function(t,e,n){}},{key:"setupLoopingAnimationTimeline",value:function(t,e,n){}}]),n}(P.AbstractTransitionController),es=n(88),ns=n.n(es);es.defaults.headers.common["Content-type"]="application/json";var rs=function(t,e,n,r,i){return es({url:"".concat(b("configManager").getURL(_.API),"submission"),method:"post",responseType:"json",data:{fullName:t,email:e,phone:n,receipt:r,agreement:i}})},is={name:"ContestForm",components:{ValidationProvider:Zo.a,PrimaryButton:Ot},extends:P.AbstractTransitionComponent,data:function(){return{fullName:"",email:"",phone:"",receipt:"",agreement:""}},methods:{handleAllComponentsReady:function(){this.transitionController=new ts(this),this.setupScrollTrigger(),this.isReady()},setupScrollTrigger:function(){var t=this;this.scrollTrigger=Qo.a.create({trigger:this.$el,start:"top 80%",scroller:"#contest-page",onEnter:function(){t.transitionIn()}})},onSubmit:function(){var t=this;return M()(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isSubmitting){e.next=2;break}return e.abrupt("return");case 2:return t.isSubmitting=!0,e.next=5,Promise.all([t.$refs.fullNameValidation.validate(),t.$refs.emailValidation.validate(),t.$refs.phoneValidation.validate(),t.$refs.receiptValidation.validate(),t.$refs.agreementValidation.validate()]).then(function(){var e=M()(x.a.mark((function e(n){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.find((function(t){return!1===t.valid})))try{rs(t.fullName,t.email,t.phone,t.receipt,t.agreement),t.$tracker.push(t.Event.CONTEST_FORM_SUBMITTED,t.EventCategory.CONTEST_FORM_SUBMITTED,{eventAction:t.EventAction.CONTEST_FORM_SUBMITTED}),t.$router.push({name:bs.CONTEST_THANKS})}catch(r){t.isSubmitting=!1}else t.isSubmitting=!1;case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:case"end":return e.stop()}}),e)})))()}}},as=n(280);var os=Object(h.a)(is,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("form",{class:[t.$style.contestForm],on:{submit:function(e){return e.preventDefault(),t.onSubmit(e)}}},[n("ValidationProvider",{ref:"fullNameValidation",class:t.$style.labelWrapper,attrs:{rules:"required","custom-messages":{required:t.$t("contest.contestForm.error.required.fullName")}},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.errors;return[n("label",{class:[t.$style.label],attrs:{for:"fullName"}},[n("span",{class:["copy-04",t.$style.labelText],domProps:{innerHTML:t._s(t.$t("contest.contestForm.fullName.label"))}}),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.fullName,expression:"fullName"}],class:["copy-04",t.$style.inputField],attrs:{id:"fullName",type:"text",placeholder:t.$t("contest.contestForm.fullName.label")},domProps:{value:t.fullName},on:{input:function(e){e.target.composing||(t.fullName=e.target.value)}}}),t._v(" "),n("span",{class:["copy-04-new",t.$style.inputError]},[t._v(t._s(r[0]))])])]}}])}),t._v(" "),n("ValidationProvider",{ref:"emailValidation",class:t.$style.labelWrapper,attrs:{rules:"required","custom-messages":{required:t.$t("contest.contestForm.error.required.email")}},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.errors;return[n("label",{class:[t.$style.label],attrs:{for:"email"}},[n("span",{class:["copy-04",t.$style.labelText],domProps:{innerHTML:t._s(t.$t("contest.contestForm.email.label"))}}),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],class:["copy-04",t.$style.inputField],attrs:{id:"email",type:"email",placeholder:t.$t("contest.contestForm.email.label")},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}}),t._v(" "),n("span",{class:["copy-04-new",t.$style.inputError]},[t._v(t._s(r[0]))])])]}}])}),t._v(" "),n("ValidationProvider",{ref:"phoneValidation",class:t.$style.labelWrapper,scopedSlots:t._u([{key:"default",fn:function(e){var r=e.errors;return[n("label",{class:[t.$style.label],attrs:{for:"phone"}},[n("span",{class:["copy-04",t.$style.labelText],domProps:{innerHTML:t._s(t.$t("contest.contestForm.phone.label"))}}),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.phone,expression:"phone"}],class:["copy-04",t.$style.inputField],attrs:{id:"phone",type:"tel",placeholder:t.$t("contest.contestForm.phone.label")},domProps:{value:t.phone},on:{input:function(e){e.target.composing||(t.phone=e.target.value)}}}),t._v(" "),n("span",{class:["copy-04-new",t.$style.inputError]},[t._v(t._s(r[0]))]),t._v(" "),n("span",{class:["copy-06",t.$style.subLabelText],domProps:{innerHTML:t._s(t.$t("contest.contestForm.phone.subLabel"))}})])]}}])}),t._v(" "),n("ValidationProvider",{ref:"receiptValidation",class:t.$style.labelWrapper,attrs:{rules:"required","custom-messages":{required:t.$t("contest.contestForm.error.required.receipt")}},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.errors;return[n("label",{class:[t.$style.label],attrs:{for:"receipt"}},[n("span",{class:["copy-04",t.$style.labelText],domProps:{innerHTML:t._s(t.$t("contest.contestForm.receipt.label"))}}),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.receipt,expression:"receipt"}],class:["copy-04",t.$style.inputField],attrs:{id:"receipt",type:"text",placeholder:t.$t("contest.contestForm.receipt.label")},domProps:{value:t.receipt},on:{input:function(e){e.target.composing||(t.receipt=e.target.value)}}}),t._v(" "),n("span",{class:["copy-04-new",t.$style.inputError]},[t._v(t._s(r[0]))]),t._v(" "),n("span",{class:["copy-06",t.$style.subLabelText],domProps:{innerHTML:t._s(t.$t("contest.contestForm.receipt.subLabel"))}})])]}}])}),t._v(" "),n("ValidationProvider",{ref:"agreementValidation",class:t.$style.labelWrapper,attrs:{rules:{required:{allowFalse:!1}},"custom-messages":{required:t.$t("contest.contestForm.error.required.agreement")}},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.errors;return[n("label",{class:[t.$style.label,t.$style.labelCheckbox],attrs:{for:"agreement"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.agreement,expression:"agreement"}],class:["copy-04",t.$style.inputField],attrs:{id:"agreement",type:"checkbox"},domProps:{checked:Array.isArray(t.agreement)?t._i(t.agreement,null)>-1:t.agreement},on:{change:function(e){var n=t.agreement,r=e.target,i=!!r.checked;if(Array.isArray(n)){var a=t._i(n,null);r.checked?a<0&&(t.agreement=n.concat([null])):a>-1&&(t.agreement=n.slice(0,a).concat(n.slice(a+1)))}else t.agreement=i}}}),t._v(" "),n("span",{class:["copy-04-new",t.$style.labelCheckboxText],domProps:{innerHTML:t._s(t.$t("contest.contestForm.agreement.label"))}})]),t._v(" "),n("span",{class:["copy-04-new",t.$style.inputError]},[t._v(t._s(r[0]))])]}}])}),t._v(" "),n("PrimaryButton",{ref:"submitButton",class:t.$style.submit,attrs:{type:t.ButtonType.SUBMIT,label:t.$t("contest.contestForm.submit.label"),"aria-label":t.$t("contest.contestForm.submit.ariaLabel")}})],1)}),[],!1,(function(t){this.$style=as.default.locals||as.default}),null,null).exports;function ss(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var ls=function(t){U()(n,t);var e=ss(n);function n(){return N()(this,n),e.apply(this,arguments)}return F()(n,[{key:"setupTransitionInTimeline",value:function(t,e,n){}},{key:"setupTransitionOutTimeline",value:function(t,e,n){}},{key:"setupLoopingAnimationTimeline",value:function(t,e,n){}}]),n}(P.AbstractTransitionController);function us(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var cs=function(t){U()(n,t);var e=us(n);function n(){return N()(this,n),e.apply(this,arguments)}return F()(n,[{key:"setupTransitionInTimeline",value:function(t,e,n){}},{key:"setupTransitionOutTimeline",value:function(t,e,n){}},{key:"setupLoopingAnimationTimeline",value:function(t,e,n){}}]),n}(P.AbstractTransitionController),fs={name:"FooterCtaButton",extends:Mt,props:{ariaLabel:s.default.string},methods:{handleAllComponentsReady:function(){this.transitionController=new cs(this),this.isReady()}}},hs=n(281);var ds={name:"Footer",components:{ResponsiveImage:dt,FooterCtaButton:Object(h.a)(fs,(function(){var t,e=this,n=e.$createElement,r=e._self._c||n;return e.type===e.ButtonType.LINK?r("a",{ref:"button",class:[e.$style.footerCtaButton,"button",e.$style[e.theme],(t={},t["is-disabled"]=e.disabled,t)],attrs:{href:e.target,disabled:"",title:e.title||e.label||"","aria-label":e.ariaLabel||e.title||""},on:{click:e.handleClick}},[r("span",{class:["copy-04-new",e.$style.label],domProps:{innerHTML:e._s(e.label)}})]):e._e()}),[],!1,(function(t){this.$style=hs.default.locals||hs.default}),null,null).exports},extends:P.AbstractTransitionComponent,methods:{handleAllComponentsReady:function(){this.transitionController=new ls(this),this.isReady()}}},vs=n(282);var ps=Object(h.a)(ds,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:[t.$style.footer]},[n("div",{class:t.$style.footerWrapper},[n("div",[n("div",{class:t.$style.logoWrapper},[n("ResponsiveImage",{class:t.$style.evianLogo,attrs:{"is-contained":!0,source:t.$staticRoot+"image/contest/evian-logo.png"}})],1),t._v(" "),n("div",{class:t.$style.logoWrapper},[n("ResponsiveImage",{class:t.$style.danoneLogo,attrs:{"is-contained":!0,source:t.$staticRoot+"image/contest/danone-logo.png"}})],1)]),t._v(" "),n("div",{class:t.$style.footerNavigation},[n("FooterCtaButton",{ref:"experience",class:t.$style.cta,attrs:{type:t.ButtonType.LINK,link:{type:t.LinkType.EXTERNAL,target:t.$t("contest.footer.ctaOne.url")},label:t.$t("contest.footer.ctaOne.label"),"aria-label":t.$t("contest.footer.ctaOne.ariaLabel")}}),t._v(" "),n("FooterCtaButton",{ref:"TermsAndConditions",class:t.$style.cta,attrs:{type:t.ButtonType.LINK,link:{type:t.LinkType.EXTERNAL_BLANK,target:t.$staticRoot+"pdf/"+t.$t("contest.footer.ctaTwo.url")},label:t.$t("contest.footer.ctaTwo.label"),"aria-label":t.$t("contest.footer.ctaTwo.ariaLabel")}})],1)])])}),[],!1,(function(t){this.$style=vs.default.locals||vs.default}),null,null).exports,ms={name:"ContestPage",components:{MainIntro:qo,ResponsiveImage:dt,ContestForm:os,Footer:ps},extends:P.AbstractPageTransitionComponent,mounted:function(){this.$tracker.push(this.Event.CONTEST_PAGE_VIEW,this.EventCategory.CONTEST_PAGE_VIEW,{eventAction:this.EventAction.CONTEST_PAGE_VIEW}),this.$tracker.push(this.Event.ENTER_CONTEST,this.EventCategory.ENTER_CONTEST)},methods:{handleAllComponentsReady:function(){this.transitionController=new zo(this),this.isReady()}}},ys=n(283);var gs=Object(h.a)(ms,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:[t.$style.contestPage],attrs:{id:"contest-page"}},[n("MainIntro",{ref:"mainIntro"}),t._v(" "),n("div",{class:[t.$style.winPrizesWrapper]},[n("div",{class:[t.$style.winPrizes]},[n("div",{class:"grid-row"},[n("div",{class:["grid-col-8 grid-col-md-12",t.$style.prizeContent]},[n("div",{class:t.$style.prizeTitleWrapper},[n("h1",{ref:"title",class:["heading-01",t.$style.title],domProps:{innerHTML:t._s(t.$t("contest.winPrizes.title"))}}),t._v(" "),n("p",{class:["copy-02",t.$style.termsAndConditions],domProps:{innerHTML:t._s(t.$t("contest.winPrizes.thirdDetail.copyOne"))}}),t._v(" "),n("p",{class:["copy-02",t.$style.termsAndConditions],domProps:{innerHTML:t._s(t.$t("contest.winPrizes.thirdDetail.copyTwo"))}})]),t._v(" "),n("div",{class:t.$style.prizeContentWrapper},[n("div",{class:t.$style.prizeDetailsWrapper},[n("div",{class:["copy-01",t.$style.detailsItemWrapper]},[n("div",{class:t.$style.detailsItem},[n("div",{class:t.$style.detailsItemInner},[n("p",{class:t.$style.subTitle,domProps:{innerHTML:t._s(t.$t("contest.winPrizes.firstDetail.subTitle"))}}),t._v(" "),n("p",{domProps:{innerHTML:t._s(t.$t("contest.winPrizes.firstDetail.copy"))}})]),t._v(" "),n("div",{class:t.$style.prizeImageWrapper},[n("div",{class:t.$style.prizeImageItem},[n("ResponsiveImage",{class:t.$style.prizeImage,attrs:{"is-contained":!0,source:t.$staticRoot+"image/contest/"+t.$t("contest.winPrizes.prizeImage.source")}})],1)])]),t._v(" "),n("div",{class:t.$style.detailsItem},[n("p",{class:t.$style.subTitle,domProps:{innerHTML:t._s(t.$t("contest.winPrizes.secondDetail.subTitle"))}}),t._v(" "),n("p",{domProps:{innerHTML:t._s(t.$t("contest.winPrizes.secondDetail.copy"))}})])])]),t._v(" "),n("ContestForm",{ref:"form"})],1)])])]),t._v(" "),n("Footer",{ref:"footer"})],1)],1)}),[],!1,(function(t){this.$style=ys.default.locals||ys.default}),null,null).exports;function _s(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Es=function(t){U()(n,t);var e=_s(n);function n(){return N()(this,n),e.apply(this,arguments)}return F()(n,[{key:"setupTransitionInTimeline",value:function(t,e,n){t.add((function(){}),.01)}},{key:"setupTransitionOutTimeline",value:function(t,e,n){}},{key:"setupLoopingAnimationTimeline",value:function(t,e,n){}}]),n}(P.AbstractTransitionController),Ts={name:"ContestThanksPage",components:{MainIntro:qo,PrimaryButton:Ot,Footer:ps},extends:P.AbstractPageTransitionComponent,methods:{handleAllComponentsReady:function(){this.transitionController=new Es(this),this.isReady()}}},As=n(284);var Rs=Object(h.a)(Ts,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:[t.$style.contestThanksPage],attrs:{id:"contest-page"}},[n("MainIntro",{ref:"mainIntro"}),t._v(" "),n("div",{class:[t.$style.winPrizesWrapper]},[n("div",{class:[t.$style.winPrizes]},[n("div",{class:"grid-row"},[n("div",{class:["grid-col-8 grid-col-md-12",t.$style.thanksContent]},[n("h1",{ref:"title",class:["heading-01",t.$style.title],domProps:{innerHTML:t._s(t.$t("contest.contestThanks.title"))}}),t._v(" "),n("p",{class:["copy-01",t.$style.copy],domProps:{innerHTML:t._s(t.$t("contest.contestThanks.copyOne"))}}),t._v(" "),n("p",{class:["copy-01",t.$style.copy,t.$style.copySmall],domProps:{innerHTML:t._s(t.$t("contest.contestThanks.copyTwo"))}}),t._v(" "),n("div",{class:t.$style.ctaWrapper},["contest.contestThanks.playAgain.label"!==t.$t("contest.contestThanks.playAgain.label")?n("PrimaryButton",{ref:"playAgain",class:["copy-01",t.$style.playAgain,t.$style.cta],attrs:{type:t.ButtonType.LINK,link:{type:t.LinkType.INTERNAL,target:{name:t.RouteNames.HOME}},label:t.$t("contest.contestThanks.playAgain.label"),"aria-label":t.$t("contest.contestThanks.playAgain.ariaLabel")}}):t._e(),t._v(" "),"contest.contestThanks.submitEntry.label"!==t.$t("contest.contestThanks.submitEntry.label")?n("PrimaryButton",{ref:"submitEntry",class:["copy-01",t.$style.submitEntry,t.$style.cta],attrs:{type:t.ButtonType.LINK,link:{type:t.LinkType.INTERNAL,target:{name:t.RouteNames.CONTEST}},label:t.$t("contest.contestThanks.submitEntry.label"),"aria-label":t.$t("contest.contestThanks.submitEntry.ariaLabel")}}):t._e()],1)])])]),t._v(" "),n("Footer",{ref:"footer"})],1)],1)}),[],!1,(function(t){this.$style=As.default.locals||As.default}),null,null).exports,bs={HOME:"home",WEBGL:"webgl",CONTEST:"contest",CONTEST_THANKS:"contest-thanks"},ws=[{path:"/",component:Oo,name:bs.HOME},{path:"/webgl",component:Uo,name:bs.WEBGL},{path:"/contest",component:gs,name:bs.CONTEST},{path:"/contest/thanks",component:Rs,name:bs.CONTEST_THANKS}];r.default.use(v.a);var Ss,xs=null,ks=function(){if(!xs){var t=w(),e=b("configManager"),n=t.localeEnabled&&t.localeRoutingEnabled?Object(i.routeParser)(ws,e.getProperty(T.DEFAULT_LOCALE)):ws.concat({path:"*",redirect:"/"});(xs=new v.a({mode:"hash",routes:n,base:e.getVariable(E.PUBLIC_PATH)})).beforeEach((function(t,n,r){var i=e.getProperty(T.PERSIST_QUERY_PARAMS),a=!1,o=Object.assign({},t.query);i&&i.length>0&&i.forEach((function(t){"undefined"!==typeof n.query[t]&&"undefined"===typeof o[t]&&(o[t]=n.query[t],a=!0)})),a?r({path:t.path,query:o}):r()}))}return xs},Ms="".concat("app","/setDeviceState"),Cs="".concat("app","/setImageSupported"),Is={app:{state:{deviceState:null,filesSupported:{webp:!1,avif:!1}},getters:{},mutations:(Ss={},I()(Ss,Ms,(function(t,e){t.deviceState=e})),I()(Ss,Cs,(function(t,e){t.filesSupported=e})),Ss),actions:{}}};r.default.use(Q.a);var Ps=null,Ds=function(){return Ps||(Ps=new Q.a.Store({modules:Is,strict:!1})),Ps},Os=n(189),Ns=n.n(Os),Ls={install:function(t,e){Object.keys(e).forEach((function(n){t.prototype[n]?console.error("Skipping ".concat(n,". ").concat(n," already exists on the Vue prototype")):Object.defineProperty(t.prototype,n,{get:function(){return e[n]}})}))}};function Fs(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Bs(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Fs(Object(n),!0).forEach((function(e){I()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Fs(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Us,Vs,zs,Gs,Hs,$s=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Bs(Bs({},n),e);return t.replace(/:(\w+)/g,(function(t,e){return"undefined"!==typeof r[e]?r[e]||"":t})).replace(/\/:(\w+\?+)/g,(function(){return""})).replace(/\?/g,(function(){return""})).replace(/:(\w+)/g,(function(t,e){throw new Error('Param "'.concat(e,'" is missing in params'),r)}))},Ws=[],Xs={isLoaded:function(t){return Ws.includes(t)},setLoadCallback:function(t){Us=t},getTranslation:function(t){var e=t.translationKey,r=t.code;return n(830)("./".concat(e,".json")).then((function(t){return Ws.push(r),Us&&setTimeout((function(){Us(r)})),t}))}},js=["AD","AL","AT","BY","BE","BA","BG","HR","CZ","DK","EE","FI","FR","DE","GR","VA","HU","IS","IE","IT","LV","LI","LT","LU","MT","MD","MC","ME","NL","MK","NO","PL","PT","RO","RU","SM","RS","SK","SI","ES","SE","CH","UA","GB"].map((function(t){return t.toLowerCase()})),Ys={PAGE_VIEW:"page_view",CONTEST_PAGE_VIEW:"contest_form_view",START_GAME:"start_game",END_GAME:"end_game",SHARE:"share",PLAY_AGAIN:"play_again",ENTER_CONTEST:"enter_contest",CONTEST_FORM_SUBMITTED:"contest_form_submit"},Ks={PAGE_VIEW:"Page View",CONTEST_PAGE_VIEW:"Contest Form",START_GAME:"Start Game",END_GAME:"End Game",SHARE:"Share",PLAY_AGAIN:"Play Again",ENTER_CONTEST:"Enter Contest",CONTEST_FORM_SUBMITTED:"Contest Form"},qs={CONTEST_PAGE_VIEW:"Page View",CONTEST_FORM_SUBMITTED:"Form Submitted"},Zs=["en-gb","en-us","en-sg","en-hk","ko-kr","zh-tw"],Qs=(Vs={},I()(Vs,"en-gb","English"),I()(Vs,"en-us","English"),I()(Vs,"en-sg","English"),I()(Vs,"en-hk","English"),I()(Vs,"ko-kr","Korean"),I()(Vs,"zh-tw","Chinese"),Vs),Js={push:function(t,e,n){if(!js.includes(window.COUNTRY)&&window.dataLayer){var r={event:t,event_category:e,language:Qs[Ds().getters.currentLanguage.code.toString()],country:window.COUNTRY_NAME};n&&n.eventAction&&(r.event_action=n.eventAction.toString()),n&&void 0!==n.score&&(r.score=n.score.toString()),window.dataLayer.push(r)}},setupTracker:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"script",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"dataLayer",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"GTM-WK7K3WN";t[r]=t[r]||[],t[r].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var a=e.getElementsByTagName(n)[0],o=e.createElement(n),s="dataLayer"!=r?"&l="+r:"";o.async=!0,o.src="https://www.googletagmanager.com/gtm.js?id="+i+s,a.parentNode.insertBefore(o,a)}},tl=n(286),el=function(){D.default.registerPlugin(Qo.a),D.default.registerPlugin(Kt.a,Yt.a),Object(Zo.b)("required",tl.b),Object(Zo.b)("email",tl.a);var t=b("configManager"),e=Object.keys(ot.b).reduce((function(t,e){return t[e]=ot.b[e].replace(/'/g,""),t}),{});r.default.use(Ls,{$config:t,$gateway:b("gateway"),$preloader:b("preloader"),$webgl:b("webglManager"),$sound:b("soundManager"),$http:ns.a,$versionRoot:t.getVariable(E.VERSIONED_STATIC_ROOT),$staticRoot:t.getVariable(E.STATIC_ROOT),$tracker:Js,URLNames:_,PropertyNames:T,VariableNames:E,RouteNames:bs,Params:xt,LinkType:Rt,Size:wt,ButtonType:St,Glow:me,Theme:kt,Milestone:Eo,Event:Ys,EventCategory:Ks,EventAction:qs,createPath:$s,formatPath:st,$deviceStateTracker:new Ns.a({mediaQueries:e,deviceState:ot.a,showStateIndicator:!1}),DeviceState:ot.a})},nl=function(t){return new Promise((function(e){Xs.isLoaded(t.getters.currentLanguage.code)?e():Xs.setLoadCallback((function(n){n===t.getters.currentLanguage.code&&e()}))}))},rl=function(t){el();var e=b("configManager");return Promise.all([br.checkWebpSupported(),br.checkAvifSupported(),e.getVariable(E.LOCALE_ENABLED)?nl(t):Promise.resolve(),Promise.resolve()]).then((function(e){var n=Wt()(e,2),r=n[0],i=n[1];t.commit(Cs,{webp:r,avif:i})}))},il=n(408),al=n.n(il),ol={environments:(zs={},I()(zs,p,{variables:{},urls:{}}),I()(zs,y,{extends:p,variables:{},urls:{}}),I()(zs,m,{extends:y,variables:{},urls:{}}),I()(zs,g,{extends:m,variables:{},urls:{}}),zs),variables:(Gs={},I()(Gs,E.LOCALE_ENABLED,!0),I()(Gs,E.LOCALE_ROUTING_ENABLED,!1),I()(Gs,E.VERSIONED_STATIC_ROOT,(window.webpackPublicPath||"/")+"version/1647510944607/static/"),I()(Gs,E.STATIC_ROOT,(window.webpackPublicPath||"/")+""),I()(Gs,E.PUBLIC_PATH,window.webpackPublicPath||"/"),Gs),urls:I()({},_.API,"".concat("/","api/")),properties:(Hs={},I()(Hs,T.DEFAULT_LOCALE,"en-gb"),I()(Hs,T.AVAILABLE_LOCALES,Zs),I()(Hs,T.PERSIST_QUERY_PARAMS,[]),Hs)},sl=p;switch(document.location.host.split(":").shift()){case"localhost":sl=g;break;default:sl=p}var ll={config:ol,environment:sl};function ul(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function cl(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ul(Object(n),!0).forEach((function(e){I()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ul(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var fl=n(52),hl=n.n(fl),dl=n(254),vl=n.n(dl),pl=n(98),ml=n.n(pl);function yl(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var gl=function(t){U()(n,t);var e=yl(n);function n(){var t;return N()(this,n),(t=e.call(this)).taskLoaderOptions=null,t.versionRoot=b("configManager").getVariable(E.VERSIONED_STATIC_ROOT),t.tasks=[],t.taskLoader=new vl.a,t.taskLoader.addEventListener(ml.a.UPDATE,t.onUpdate.bind(Ke()(t))),t.taskLoader.addEventListener(ml.a.COMPLETE,t.onComplete.bind(Ke()(t))),t}return F()(n,[{key:"addTask",value:function(t){this.tasks.push(t)}},{key:"start",value:function(t){return this.loadTasks(this.tasks,t)}},{key:"onUpdate",value:function(t){this.taskLoaderOptions&&this.taskLoaderOptions.onUpdate&&this.taskLoaderOptions.onUpdate(t.data.progress)}},{key:"onComplete",value:function(t){this.taskLoaderOptions&&this.taskLoaderOptions.onComplete&&this.taskLoaderOptions.onComplete()}},{key:"loadTasks",value:function(t,e){return this.taskLoaderOptions=e||null,this.taskLoader.loadTasks(t)}}]),n}(hl.a),_l=function(){function t(e){var n=this;N()(this,t),this.webglApplication=e,this.datGui=new nn;var r=new je;r.init("external");for(var i=Object.values(Ta),a=function(){var t=s[o];r.addButton(t,(function(){e.loadAndPlayScene(t,n.difficulty.value,(function(){}),(function(){}))}))},o=0,s=i;o<s.length;o++)a();this.webglApplication.addEventListener(Re.ANIMATION_END,(function(t){console.log("ANIMATION_END",t),console.log("score",n.webglApplication.getScore())})),this.webglApplication.addEventListener(Re.ANIMATION_EVENT,(function(t){console.log("ANIMATION_EVENT",t)})),this.webglApplication.addEventListener(Re.OBSTACLE_HIT,(function(t){console.log("OBSTACLE_HIT",t)})),this.webglApplication.addEventListener(Re.COLLECTABLE_HIT,(function(t){console.log("COLLECTABLE_HIT",t)})),this.webglApplication.addEventListener(Re.LANE_CHANGE,(function(t){console.log("LANE_CHANGE",t)})),this.difficulty=r.addParamFloat("difficulty",.4),this.animationTime=r.addParamFloat("time",0,0,1,(function(t){e.setNormalizedTime(t)})),this.pausedParam=r.addParamBool("paused",!1,(function(t){e.paused=t})),r.addParamBool("enabled",!0,(function(t){e.enabled=t})),mr.getInstance().addKeyHitEvent(vr.SPACE,(function(){n.pausedParam.setValue(!n.pausedParam.value)})),r.addParamBool("game visible",!0,(function(t){e.setGameItemsVisible(t)})),r.addParamBool("blurred",!1,(function(t){e.setBlurred(t)})),r.addButton("transitionToWhite",(function(){e.transitionToWhite((function(){}))})),this.datGui.init(r),this.update()}return F()(t,[{key:"init",value:function(){this.webglApplication.loadAndPlayScene(Ta.TRACK_1,this.difficulty.value,(function(){}),(function(){}),!0)}},{key:"update",value:function(){var t=this;this.animationTime.setValue(this.webglApplication.getNormalizedTime(),!1,!1),window.requestAnimationFrame((function(){return t.update()}))}},{key:"destruct",value:function(){this.datGui.destruct()}}]),t}();function El(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Tl=function(t){U()(n,t);var e=El(n);function n(){return N()(this,n),e.apply(this,arguments)}return F()(n,[{key:"init",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];n.webglApp||(Se.ENABLED=e,br.useWebp=r,br.useAvif=i,n.preloader=new sn,n.webglApp=new Sa(this,t,n.preloader,e),e&&(this.addStats(),n.externalControl=new _l(this)))}},{key:"load",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};n.preloader.load((function(){var e;n.webglApp.init(),null===(e=n.externalControl)||void 0===e||e.init(),t()}),e)}},{key:"clear",value:function(){n.webglApp.clear()}},{key:"loadAndPlayScene",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];n.webglApp.loadScene(t,e,r,i,a)}},{key:"setNormalizedTime",value:function(t){n.webglApp.normalizedAnimationProgress=t}},{key:"getNormalizedTime",value:function(){return n.webglApp.normalizedAnimationProgress}},{key:"getSecondRemaining",value:function(){return n.webglApp.secondRemaining}},{key:"getAnimationTime",value:function(){return n.webglApp.animationTime}},{key:"getScore",value:function(){return n.webglApp.getScore()}},{key:"setGameItemsVisible",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};n.webglApp.setGameItemsVisible(t,e,r)}},{key:"transitionToWhite",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};n.webglApp.transitionToWhite(t)}},{key:"getWhiteTransitionProgress",value:function(){return n.webglApp.whiteTransitionProgress}},{key:"setBlurred",value:function(t){n.webglApp.setBlurred(t)}},{key:"destruct",value:function(){var t;n.webglApp.destruct(),null===(t=n.externalControl)||void 0===t||t.destruct()}},{key:"addStats",value:function(){var t=document.createElement("script");t.onload=function(){var t=new Stats;t.dom.style.position="absolute",t.dom.style.bottom="0px",t.dom.style.top="",document.body.appendChild(t.dom),requestAnimationFrame((function e(){t.update(),requestAnimationFrame(e)}))},t.src="//mrdoob.github.io/stats.js/build/stats.min.js",document.head.appendChild(t)}},{key:"paused",set:function(t){n.webglApp.scenePaused=t}},{key:"hardPaused",set:function(t){n.webglApp.sceneHardPaused=t}},{key:"enabled",set:function(t){n.webglApp.enabled=t}}]),n}(hl.a);Tl.externalControl=null;var Al=n(409),Rl=n.n(Al),bl=n(410),wl=n.n(bl),Sl=n(411),xl=n.n(Sl);var kl=function(t,e,n,r,i,a,o){if(!e.audioBuffer)throw new Error("Sample '".concat(e.name,"' is not loaded"));var s=t.createBufferSource(),l=t.createGain(),u=n?n.gain:t.destination;s.connect(l),s.buffer=e.audioBuffer,s.loop=a;var c={context:t,sample:e,bufferSource:s,gain:l,channel:n||void 0};if(o){var f=t.createPanner();f.panningModel="HRTF",f.distanceModel="linear",function(t,e){t.positionX?(t.positionX.value=e[0],t.positionY.value=e[1],t.positionZ.value=e[2]):t.setPosition(e[0],e[1],e[2])}(f,o),l.connect(f),f.connect(u),c.panner=f}else l.connect(u);if(i){l.gain.setValueAtTime(0,0);var h={value:0},d=ao.w.to(h,i,{value:1,ease:ao.h.easeNone,onUpdate:function(){l.gain.setValueAtTime(h.value,d.time())}})}else l.gain.setValueAtTime(r,0);return s.start(0),c},Ml=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t.playingSamples.forEach((function(t){return Cl(t,e)}))},Cl=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0===e)t.bufferSource.stop(0);else{var n=t.context.currentTime+e;t.gain.gain.linearRampToValueAtTime(0,n),t.bufferSource.stop(n)}Il(t)},Il=function(t){if(t.channel){var e=t.channel.playingSamples.indexOf(t);e>-1&&t.channel.playingSamples.splice(e,1)}},Pl=window.AudioContext||window.webkitAudioContext,Dl=function(){function t(e,n){var r=this;N()(this,t),this.channels={},t.WEBAUDIO_ENABLED&&(this.context=new Pl,this.sampleManager=new Rl.a(this.context,e,n),window.addEventListener("click",(function(){r.initAudioContext()}),{once:!0}))}return F()(t,[{key:"setGeneralChannelVolume",value:function(t,e){this.channels[t].gain.gain.value=e}},{key:"initAudioContext",value:function(){t.WEBAUDIO_ENABLED&&"suspended"===this.context.state&&this.context.resume()}},{key:"on3DSoundOrienationChange",value:function(e){t.WEBAUDIO_ENABLED&&function(t,e){if(e){var n=t.listener;if(n.forwardX){var r=t.currentTime+.1;n.forwardX.linearRampToValueAtTime(e.forward[0],r),n.forwardY.linearRampToValueAtTime(e.forward[1],r),n.forwardZ.linearRampToValueAtTime(e.forward[2],r),e.position&&(n.positionX.linearRampToValueAtTime(e.position[0],r),n.positionY.linearRampToValueAtTime(e.position[1],r),n.positionZ.linearRampToValueAtTime(e.position[2],r)),n.upX.linearRampToValueAtTime(e.up[0],r),n.upY.linearRampToValueAtTime(e.up[1],r),n.upZ.linearRampToValueAtTime(e.up[2],r)}else e.position&&n.setPosition(e.position[0],e.position[1],e.position[2]),n.setOrientation(e.forward[0],e.forward[1],e.forward[2],e.up[0],e.up[1],e.up[2])}}(this.context,e)}},{key:"stop",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(t.WEBAUDIO_ENABLED){var i=this.getChannelByName(n),a=i.playingSamples.find((function(t){return t.sample.name===e}));a&&Cl(a,r)}}},{key:"playRandomQueue",value:function(t){var e,n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=arguments.length>6?arguments[6]:void 0,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;if((e=l&&0!==l.length?l:rt()(t)).length>0){var f=wl()(e),h=e.indexOf(f);e.splice(h,1);var d=this.play(f,r,i,a,!1,s,c);d&&(d.bufferSource.onended=function(){var l=function(){o&&0===e.length&&(e=rt()(t)),e.length>0&&n.playRandomQueue(t,r,i,a,o,s,e,u,c)};u?setTimeout((function(){l()}),1e3*xl()(u[0],u[1])):l()})}}},{key:"play",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if(t.WEBAUDIO_ENABLED){var l=this.sampleManager.getSampleByName(e);if(!l)throw new Error("Cannot find sample '".concat(e));var u=this.getChannelByName(n);if(u&&u.playingSamples.length>0){var c=u.playingSamples.find((function(t){return t.sample.name===e}));if(c&&(u.isMonophonic&&c.bufferSource.loop&&a||o))return c}var f=kl(this.context,l,u,r,i,a,s);return u&&(u.isMonophonic&&u.playingSamples.forEach((function(t){return Cl(t,u.monophonicFadeOutTime)})),u.playingSamples.push(f),f.bufferSource.onended=function(){Il(f)}),f}return null}},{key:"getChannelByName",value:function(t){var e=t?this.channels[t]:null;if(!e)throw new Error("Channel with name '".concat(t,"' does not exist"));return e}},{key:"stopAllOnChannel",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Ml(this.getChannelByName(t),e)}},{key:"muteChannel",value:function(e,n){if(t.WEBAUDIO_ENABLED){var r=this.getChannelByName(e);if(r){var i=n?0:r.initialVolume;r.gain.gain.setValueAtTime(i,0)}}}},{key:"muteAllChannels",value:function(e){var n=this;t.WEBAUDIO_ENABLED&&Object.keys(this.channels).forEach((function(t){n.muteChannel(t,e)}))}},{key:"createChannel",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(t.WEBAUDIO_ENABLED){if(""===e)throw new Error("Channel name cannot be blank");if(this.channels[e])throw new Error("Channel '".concat(e,"' already exists"));if(i<0)throw new Error("monophonicFadeOutTime can not be negative");var a=this.context.createGain();a.gain.setValueAtTime(n,0),a.connect(this.context.destination),a.connect(this.context.destination),this.channels[e]={initialVolume:n,isMonophonic:r,monophonicFadeOutTime:i,name:e,gain:a,playingSamples:[]}}}}]),t}();Dl.WEBAUDIO_ENABLED=void 0!==(window.AudioContext||window.webkitAudioContext);var Ol=function(){var t=new al.a;t.init(ll.config,ll.environment);var e=es.create({baseURL:t.getURL(_.API),headers:{Accept:"application/json"},responseType:"json"});e.interceptors.response.use((function(t){return function(t){return t&&t.data&&"undefined"!==typeof t.data.data?cl(cl({},t),t.data):t}(t)}),(function(t){throw function(t){if(t&&t.response&&t.response.data&&t.response.data.error){var e=cl(cl({config:t.config},t.response),t.response.data);return delete e.data,e}return t}(t)})),R("configManager",t),R("preloader",new gl),R("webglManager",new Tl),R("gateway",e),R("soundManager",new Dl("".concat(t.getVariable(E.VERSIONED_STATIC_ROOT),"audio/"),at.a.safari||at.a.ios?"mp3":"ogg"))};var Nl=n(412),Ll=n.n(Nl);function Fl(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Bl=function(t){U()(n,t);var e=Fl(n);function n(){return N()(this,n),e.apply(this,arguments)}return F()(n,[{key:"setupTransitionInTimeline",value:function(t,e,n){var r=e.$refs.water,i=e.$refs,a=i.dropWrapper,o=i.label,s=i.firstDot,l=i.secondDot,u=i.thirdDot;t.set(r,{yPercent:100}),t.fromTo(a,{scale:.9,autoAlpha:0,yPercent:-15},{scale:1,yPercent:0,autoAlpha:1,ease:ao.l.easeOut,duration:.7},0),t.fromTo(o,{xPercent:125},{xPercent:0,duration:.4,ease:j.VinnieInOut,clearProps:"all",onComplete:function(){D.default.timeline({repeat:-1}).to([s,l,u],{autoAlpha:1,duration:.4,stagger:.2}).to([s,l,u],{autoAlpha:0,duration:.4,stagger:.2},2)}},.3)}},{key:"setupTransitionOutTimeline",value:function(t,e,n){var r=e.$refs.dropWrapper;t.to(r,{scale:.9,autoAlpha:0,ease:ao.l.easeOut,duration:.6}),t.add(function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01,r=D.default.timeline();return e?r.to(t,{duration:n,autoAlpha:0,ease:ao.l.easeOut}):r.fromTo(t,{autoAlpha:0},{duration:n,autoAlpha:1,ease:ao.l.easeOut}),r}(e.$el,!0,.3),"-=0.3")}},{key:"setupLoopingAnimationTimeline",value:function(t,e,n){var r=e.$refs.water;t.fromTo(r,{xPercent:-34},{xPercent:0,ease:ao.h.easeNone,duration:1.5})}}]),n}(P.AbstractTransitionController),Ul=n(78);function Vl(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var zl=function(t){U()(n,t);var e=Vl(n);function n(t){return N()(this,n),e.call(this,Object.assign(t,{batchSize:1,cached:!1}))}return F()(n,[{key:"loadAsset",value:function(t){return Promise.resolve()}},{key:"load",value:function(t){var e=this;return new Promise((function(n){e.options.loadMethod((function(){return n()}),(function(e){t(e)}))}))}},{key:"dispose",value:function(){we()(H()(n.prototype),"dispose",this).call(this)}}]),n}(n.n(Ul).a);function Gl(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var Hl=function(t){U()(n,t);var e=Gl(n);function n(t){return N()(this,n),e.call(this,Object.assign(t,{batchSize:1,cached:!1}))}return F()(n,[{key:"loadAsset",value:function(t){return Promise.resolve()}},{key:"load",value:function(t){return this.options.loadMethod((function(e){t(e)}))}},{key:"dispose",value:function(){we()(H()(n.prototype),"dispose",this).call(this)}}]),n}(n(413).AbstractLoadTask),$l=function(){var t=M()(x.a.mark((function t(){var e,n,r,i,a,o,s,l,u,c,f;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=window.location,r=n.origin,i=n.pathname,t.next=4,fetch("".concat(r).concat(i,".edge/viewer-location"));case 4:if(!(a=t.sent).ok){t.next=12;break}return t.next=8,a.json();case 8:o=t.sent,e=o.country,window.COUNTRY_NAME=o["country-name"],js.includes(e.toLowerCase())||Js.setupTracker();case 12:t.next=15;break;case 14:window.COUNTRY_NAME="Great Britain";case 15:if(s=(e||"en-gb".split("-")[1]).toLowerCase(),l=navigator.language.split("-")[0].toLowerCase(),u="".concat(l,"-").concat(s),c=-1!==Zs.indexOf(u),window.COUNTRY=s,!c){t.next=22;break}return t.abrupt("return",u);case 22:if(-1===(f=Zs.map((function(t){return t.split("-")[1]})).indexOf(s))){t.next=25;break}return t.abrupt("return",Zs[f]);case 25:return t.abrupt("return","en-gb");case 26:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Wl=function(t,e,n){return new Promise((function(r){D.gsap.to(t,{duration:e,onUpdate:n,manualProgress:1,ease:ao.h.easeNone,onComplete:function(){return r()}})}))},Xl={name:"SitePreloader",components:{StartScreenLogo:mt},extends:P.AbstractTransitionComponent,data:function(){return{progress:0,manualProgress:0,currentYPosition:0,targetYPosition:0}},computed:{totalProgress:function(){return(this.manualProgress+this.progress)/2}},watch:{totalProgress:function(t){this.targetYPosition=t}},created:function(){var t=this;return M()(x.a.mark((function e(){var n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$l();case 2:n=e.sent,t.$setLanguage(n),t.locale=n;case 5:case"end":return e.stop()}}),e)})))()},mounted:function(){this.disposables=new qt.DisposableManager},beforeDestroy:function(){D.gsap.ticker.remove(this.tick)},methods:{handleAllComponentsReady:function(){this.transitionController=new Bl(this),this.disposables.add(Object(Zt.addEventListener)(this.transitionController,P.TransitionEvent.types.TRANSITION_IN_START,this.onTransitionInStart)),this.disposables.add(Object(Zt.addEventListener)(this.transitionController,P.TransitionEvent.types.TRANSITION_OUT_COMPLETE,this.onTransitionOutComplete)),D.gsap.ticker.add(this.tick),this.loadApplication(),this.isReady()},loadApplication:function(){var t=this;return M()(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.transitionIn(!0);case 2:return t.$preloader.addTask(new zl({loadMethod:t.$webgl.load.bind(t.$webgl)})),Dl.WEBAUDIO_ENABLED&&(t.$sound.sampleManager.addSamples(Ft),t.$sound.createChannel(Bt.SFX,1),t.$sound.createChannel(Bt.AMBIENT,1,!0,1),t.$sound.createChannel(Bt.MUSIC,1,!0,1),t.$preloader.addTask(new Hl({loadMethod:t.$sound.sampleManager.loadAllSamples.bind(t.$sound.sampleManager)}))),3,e.next=7,Promise.all([t.$preloader.start({onUpdate:t.onPreloaderUpdate}),Wl(t,3,t.onManualUpdate)]);case 7:return t.onPreloaderUpdate(1),t.$emit("preloaded"),e.next=11,t.transitionOut(!0);case 11:t.$emit("complete");case 12:case"end":return e.stop()}}),e)})))()},onPreloaderUpdate:function(t){this.progress=t},onManualUpdate:function(){},onTransitionInStart:function(){this.startLoopingAnimation()},onTransitionOutComplete:function(){this.stopLoopingAnimation()},tick:function(){this.currentYPosition=Ll()(this.currentYPosition,this.targetYPosition,.25),D.gsap.set(this.$refs.water,{yPercent:90-100*this.currentYPosition,ease:ao.l.easeOut})}}},jl=n(287);var Yl=Object(h.a)(Xl,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:[t.$style.sitePreloader]},[n("div",{ref:"dropWrapper",class:t.$style.dropWrapper},[n("div",{class:["abs-fill",t.$style.waterWrapper],style:"clip-path: url(#preloaderWaterMask)"},[n("svg",{class:t.$style.water,attrs:{viewBox:"0 0 226.4 95.2"}},[n("path",{ref:"water",attrs:{fill:"#d50032",d:"M201.4,7.7c-4-1-7.5-2.4-10.7-2.9c-0.6-0.1-1.2-0.2-1.9-0.2\n    c-0.1,0-0.1,0-0.2,0c-0.1,0-0.1,0-0.2,0c-0.6,0-1.2,0.1-1.9,0.2c-3.2,0.5-6.6,2-10.7,2.9c-10.5,2.5-13.6-8.2-25.1-7.7v0\n    c-11.5-0.5-14.6,10.1-25,7.7c-4-1-7.5-2.4-10.7-2.9c-0.6-0.1-1.2-0.2-1.9-0.2c-0.1,0-0.1,0-0.2,0c-0.1,0-0.1,0-0.2,0\n    c-0.6,0-1.2,0.1-1.9,0.2c-3.2,0.5-6.6,2-10.7,2.9C90.1,10.1,87-0.5,75.5,0v0C64-0.5,60.9,10.1,50.5,7.7c-4-1-7.5-2.4-10.7-2.9\n    c-0.6-0.1-1.2-0.2-1.9-0.2c-0.1,0-0.1,0-0.2,0c-0.1,0-0.1,0-0.2,0c-0.6,0-1.2,0.1-1.9,0.2c-3.2,0.5-6.6,2-10.7,2.9\n    C14.6,10.1,11.5-0.5,0,0v14.1v13.6v67.4h75.5h75.5h75.5V27.8V14.1V0C214.9-0.5,211.8,10.1,201.4,7.7z"}})])]),t._v(" "),n("svg",{class:t.$style.dropBorder,attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 42.4 56.8"}},[n("defs",[n("clipPath",{attrs:{id:"preloaderWaterMask"}},[n("path",{staticStyle:{fill:"none",stroke:"none","stroke-miterlimit":"10","stroke-width":"4px"},attrs:{d:"M21.2,54.8A19.43,19.43,0,0,1,2,35.2c0-7.76,5.16-14.48,10.62-21.59l0,0A104.18,104.18,0,0,0,20.42,2.45a1,1,0,0,1,.33-.33.9.9,0,0,1,.9,0,.85.85,0,0,1,.32.33,106.68,106.68,0,0,0,7.87,11.23C35.28,20.75,40.4,27.44,40.4,35.2A19.43,19.43,0,0,1,21.2,54.8Z"}})])]),t._v(" "),n("path",{staticStyle:{fill:"none",stroke:"#d50032","stroke-miterlimit":"10","stroke-width":"4px"},attrs:{d:"M21.2,54.8A19.43,19.43,0,0,1,2,35.2c0-7.76,5.16-14.48,10.62-21.59l0,0A104.18,104.18,0,0,0,20.42,2.45a1,1,0,0,1,.33-.33.9.9,0,0,1,.9,0,.85.85,0,0,1,.32.33,106.68,106.68,0,0,0,7.87,11.23C35.28,20.75,40.4,27.44,40.4,35.2A19.43,19.43,0,0,1,21.2,54.8Z"}}),t._v(" "),n("path",{staticStyle:{fill:"none"},attrs:{d:"M21.2,5.2l-.64,1c-2.08,3.17-4.39,6.14-6.63,9l0,0C8.6,22,3.6,28.43,3.6,35.52a17.6,17.6,0,1,0,35.2,0c0-7.08-5-13.49-10.29-20.26h0l0-.05c-2.24-2.88-4.56-5.85-6.61-9Z"}})]),t._v(" "),n("div",{class:t.$style.labelWrapper},[n("div",{ref:"label",class:["copy-03-new",t.$style.label]},[n("span",{domProps:{innerHTML:t._s(t.$t("general.preloader.label"))}}),t._v(" "),n("span",{ref:"firstDot",class:t.$style.labelDot,domProps:{innerHTML:t._s(".")}}),t._v(" "),n("span",{ref:"secondDot",class:t.$style.labelDot,domProps:{innerHTML:t._s(".")}}),t._v(" "),n("span",{ref:"thirdDot",class:t.$style.labelDot,domProps:{innerHTML:t._s(".")}})]),t._v(" "),n("div",{class:["abs-fill",t.$style.labelOverlay]})])])])}),[],!1,(function(t){this.$style=jl.default.locals||jl.default}),null,null).exports;function Kl(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H()(t);if(e){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z()(this,n)}}var ql=function(t){U()(n,t);var e=Kl(n);function n(){return N()(this,n),e.apply(this,arguments)}return F()(n,[{key:"setupTransitionInTimeline",value:function(t,e,n){}},{key:"setupTransitionOutTimeline",value:function(t,e,n){}},{key:"setupLoopingAnimationTimeline",value:function(t,e,n){}}]),n}(P.AbstractTransitionController);function Zl(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var Ql={name:"CanvasContainer",extends:P.AbstractTransitionComponent,computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Zl(Object(n),!0).forEach((function(e){I()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Zl(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(Q.c)({filesSupported:function(t){return t.app.filesSupported}})),mounted:function(){this.$webgl.init(this.$el,this.$route.name===this.RouteNames.WEBGL,this.filesSupported.webp,this.filesSupported.avif)},methods:{handleAllComponentsReady:function(){this.transitionController=new ql(this),this.isReady()}}},Jl=n(288);function tu(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function eu(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?tu(Object(n),!0).forEach((function(e){I()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):tu(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var nu={name:"App",components:{SitePreloader:Yl,CanvasContainer:Object(h.a)(Ql,(function(){var t=this.$createElement;return(this._self._c||t)("div",{class:["abs-fill",this.$style.canvasContainer]})}),[],!1,(function(t){this.$style=Jl.default.locals||Jl.default}),null,null).exports},extends:P.AbstractRegistrableComponent,data:function(){return{isPreloaded:!1}},computed:eu({},Object(Q.c)({deviceState:function(t){return t.app.deviceState}})),created:function(){this.disposables=new qt.DisposableManager,this.disposables.add(function(){var t=function(){var t=window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(.01*t,"px"))};return t(),Object(Zt.addEventListener)(window,"resize",t)}()),this.disposables.add(Object(Zt.addEventListener)(this.$deviceStateTracker,Os.DeviceStateEvent.STATE_UPDATE,this.handleDeviceStateUpdate)),this.setDeviceState(this.$deviceStateTracker.currentState)},beforeDestroy:function(){this.disposables.dispose()},methods:eu(eu({},Object(Q.b)({setDeviceState:Ms})),{},{handleDeviceStateUpdate:function(t){this.setDeviceState(t.data.state)},onLeave:function(t,e){P.FlowManager.transitionOut.then((function(){return P.FlowManager.done()})).then(e)},onPreloadComplete:function(){this.isPreloaded=!0}})},ru=n(289);var iu=Object(h.a)(nu,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("main",{class:[t.$style.app]},[n("CanvasContainer"),t._v(" "),t.isPreloaded?t._e():n("SitePreloader",{on:{complete:t.onPreloadComplete}}),t._v(" "),n("transition",{on:{leave:t.onLeave}},[t.isPreloaded?n("router-view"):t._e()],1)],1)}),[],!1,(function(t){this.$style=ru.default.locals||ru.default}),null,null).exports,au={};Object.keys(au).forEach((function(t){return r.default.filter(t,au[t])})),Object.keys(l).forEach((function(t){return r.default.directive(t,l[t])})),Object.keys(d).forEach((function(t){return r.default.component(t,d[t])})),Ol(),window.webpackPublicPath&&(n.p=window.webpackPublicPath);var ou=ks(),su=Ds(),lu=w();lu.localeEnabled&&(r.default.use(a.a,{store:su,router:lu.localeRoutingEnabled?ou:null,config:lu.config,proxy:Xs}),r.default.initI18nManager()),Object(o.sync)(su,ou);var uu=new r.default({router:ou,store:su,render:function(t){return t(iu)}});rl(su).then((function(){uu.$mount("#app")}))},89:function(t){t.exports=JSON.parse('{"b":{"XSMALL":"\'(max-width: 479px)\'","SMALL":"\'(min-width: 480px)\'","MEDIUM":"\'(min-width: 768px)\'","LARGE":"\'(min-width: 1024px)\'","XLARGE":"\'(min-width: 1400px)\'"},"a":{"XSMALL":0,"SMALL":1,"MEDIUM":2,"LARGE":3,"XLARGE":4}}')}});